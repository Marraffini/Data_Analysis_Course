<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>161250 Data Analysis - Tidy data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../workshops/ws02.html" rel="next">
<link href="../workshops/ws01.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">161250 Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides.html" rel="" target="">
 <span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../studyguide/index.html" rel="" target="">
 <span class="menu-text">Study Guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../workshops/ws01.html" rel="" target="" aria-current="page">
 <span class="menu-text">Workshops</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-extra-code" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Extra Code</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-extra-code">    
        <li>
    <a class="dropdown-item" href="../exercises/Chap2more.R" rel="" target="">
 <span class="dropdown-text">Ex2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap3more.R" rel="" target="">
 <span class="dropdown-text">Ex3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap4more.R" rel="" target="">
 <span class="dropdown-text">Ex4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap5more.R" rel="" target="">
 <span class="dropdown-text">Ex5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap6more.R" rel="" target="">
 <span class="dropdown-text">Ex6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap7more.R" rel="" target="">
 <span class="dropdown-text">Ex7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap8more.R" rel="" target="">
 <span class="dropdown-text">Ex8</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../workshops/ws01_5.html">Tidy data</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started With R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws01_5.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Tidy data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 2 Workshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 3 Workshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 4 Workshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 5 Workshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 6 Workshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 7 Workshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../workshops/ws08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 8 Workshop</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#tidyr" id="toc-tidyr" class="nav-link active" data-scroll-target="#tidyr"><code>tidyr</code></a></li>
  <li><a href="#introduction-to-the-tidyverse" id="toc-introduction-to-the-tidyverse" class="nav-link" data-scroll-target="#introduction-to-the-tidyverse">Introduction to the tidyverse</a></li>
  <li><a href="#datset" id="toc-datset" class="nav-link" data-scroll-target="#datset">Datset</a></li>
  <li><a href="#exercise-1.1" id="toc-exercise-1.1" class="nav-link" data-scroll-target="#exercise-1.1">Exercise 1.1</a>
  <ul class="collapse">
  <li><a href="#piping" id="toc-piping" class="nav-link" data-scroll-target="#piping">Piping</a></li>
  </ul></li>
  <li><a href="#exercise-1.2" id="toc-exercise-1.2" class="nav-link" data-scroll-target="#exercise-1.2">Exercise 1.2</a></li>
  <li><a href="#exercise-1.3" id="toc-exercise-1.3" class="nav-link" data-scroll-target="#exercise-1.3">Exercise 1.3</a></li>
  <li><a href="#dataset-diamonds" id="toc-dataset-diamonds" class="nav-link" data-scroll-target="#dataset-diamonds">Dataset <em>diamonds</em></a></li>
  <li><a href="#exercise-1.4" id="toc-exercise-1.4" class="nav-link" data-scroll-target="#exercise-1.4">Exercise 1.4</a></li>
  <li><a href="#exercise-1.5" id="toc-exercise-1.5" class="nav-link" data-scroll-target="#exercise-1.5">Exercise 1.5</a></li>
  <li><a href="#exercise-1.6" id="toc-exercise-1.6" class="nav-link" data-scroll-target="#exercise-1.6">Exercise 1.6</a></li>
  <li><a href="#exercise-1.7" id="toc-exercise-1.7" class="nav-link" data-scroll-target="#exercise-1.7">Exercise 1.7</a></li>
  <li><a href="#tidying-data" id="toc-tidying-data" class="nav-link" data-scroll-target="#tidying-data">Tidying data</a></li>
  <li><a href="#exercise-1.8" id="toc-exercise-1.8" class="nav-link" data-scroll-target="#exercise-1.8">Exercise 1.8</a>
  <ul class="collapse">
  <li><a href="#combining-datasets" id="toc-combining-datasets" class="nav-link" data-scroll-target="#combining-datasets">Combining datasets</a></li>
  </ul></li>
  <li><a href="#specifying-join-keys" id="toc-specifying-join-keys" class="nav-link" data-scroll-target="#specifying-join-keys">Specifying join keys</a></li>
  <li><a href="#exercise-1.9" id="toc-exercise-1.9" class="nav-link" data-scroll-target="#exercise-1.9">Exercise 1.9</a></li>
  <li><a href="#exercise-1.10" id="toc-exercise-1.10" class="nav-link" data-scroll-target="#exercise-1.10">Exercise 1.10</a></li>
  <li><a href="#case_when" id="toc-case_when" class="nav-link" data-scroll-target="#case_when">case_when()</a></li>
  <li><a href="#exercise-1.11" id="toc-exercise-1.11" class="nav-link" data-scroll-target="#exercise-1.11">Exercise 1.11</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="ws01_5.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Tidy data</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="tidyr" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="tidyr"><code>tidyr</code></h2>
<p>By the phrase <code>tidy data</code>, it is meant the preferred way of arranging data that is easy to analyse. The principles of tidy data are:</p>
<ul>
<li>Each variable forms a column.</li>
<li>Each observation forms a row.</li>
<li>Each type of observational unit forms a table.</li>
</ul>
<p><em>Simple Manipulations</em></p>
<p>There is always more than one-way of manipulating the data, producing summaries and tables from raw data.</p>
<p>One of the simplest manipulations on a batch of data we may do is to change the data type say numeric to character. For example, the television viewing time data in the text file <code>tv.csv</code> is read into a dataframe by the command line</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/tv.csv"</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span><span class="cn">TRUE</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can improve the <code>read.csv</code> command to recognise the data type while reading the table as follows, using the <code>read_csv</code> command from the <code>readr</code> package:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/tv.csv"</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="st">"nfcc"</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The argument <code>col_types = "nfcc"</code> stands for {<code>numeric</code>, <code>factor</code>, <code>character</code>, <code>character</code>}, to match the order of the columns.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>my.data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 46 × 4
   TELETIME SEX   SCHOOL STANDARD
      &lt;dbl&gt; &lt;fct&gt; &lt;chr&gt;  &lt;chr&gt;   
 1     1482 1     1      4       
 2     2018 1     1      4       
 3     1849 1     1      4       
 4      857 1     1      4       
 5     2027 2     1      4       
 6     2368 2     1      4       
 7     1783 2     1      4       
 8     1769 2     1      4       
 9     2534 1     1      3       
10     2366 1     1      3       
# ℹ 36 more rows</code></pre>
</div>
</div>
<p>We often do a summary of a numerical variable for a given categorical variable. For example, we like to see obtain the summary statistics of TV viewing times for various schools. The commands</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(my.data<span class="sc">$</span>TELETIME, my.data<span class="sc">$</span>SCHOOL, summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We employed the <code>by()</code> command above and instead, we may also use <code>tapply()</code> <code>aggregate()</code> functions:</p>
<p><code>tapply(my.data$TELETIME, my.data$SCHOOL, summary)</code></p>
<p><code>aggregate(my.data$TELETIME, list(my.data$SCHOOL), summary)</code></p>
<p>A tabulated summary of categorical data is obtained using the <code>table()</code> command.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>wind <span class="ot">&lt;-</span> my.data <span class="sc">|&gt;</span> <span class="fu">pull</span>(wind)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>river <span class="ot">&lt;-</span> my.data <span class="sc">|&gt;</span> <span class="fu">pull</span>(river)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wind, river)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>It is sometimes convenient to work with matrices for some R functions such as <code>apply()</code>. For example, the number of admissions data in <code>hospital.txt</code> data can be formed as a matrix. Note that this is possible because we have the same number of observations for each hospital location.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/hospital.txt"</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep=</span><span class="st">","</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(NORTH1, NORTH2, NORTH3, </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>         SOUTH1, SOUTH2, SOUTH3) <span class="sc">|&gt;</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>()</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">apply</span>(M, <span class="dv">1</span>, mean)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>sds <span class="ot">&lt;-</span> <span class="fu">apply</span>(M, <span class="dv">1</span>, sd)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(means, sds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="introduction-to-the-tidyverse" class="level1">
<h1>Introduction to the tidyverse</h1>
<p>We will be largely using the <code>tidyverse</code> suite of packages for data organisation, summarizing, and plotting; see <a href="https://www.tidyverse.org/" class="uri">https://www.tidyverse.org/</a>.</p>
<p>Let’s load that package now: Remember if you have not installed it you will need to use <code>install.packages()</code> first.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="datset" class="level1">
<h1>Datset</h1>
<p>For this workshop we will use some tidyverse built in datasets. Each dataset below shows the same values of four variables: country, year, population, and number of documented cases of TB (tuberculosis), but each dataset organizes the values in a different way. Take a look at these datasets by typing their names into a code chunk or directly into the console. You can also try your hand at the functions <code>head()</code> and <code>summary()</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases population
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>table2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country      year type            count
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>table3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
</div>
</section>
<section id="exercise-1.1" class="level1 unnumbered">
<h1 class="unnumbered">Exercise 1.1</h1>
<p>For each of the sample tables, describe what each observation and each column represents. Which is the most <code>tidy</code>?</p>
<div id="answer">

</div>
<section id="piping" class="level2">
<h2 class="anchored" data-anchor-id="piping">Piping</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>The piping operation is a fundamental aspect of computer programming. The semantics of pipes is taking the output from the left-hand side and passing it as input to the right-hand side.</strong></p>
</div>
</div>
<p>The <code>R</code> package <code>magrittr</code> introduced the pipe operator <code>%&gt;%</code> and can be pronounced as “then”. In RStudio windows/Linux versions, press <code>Ctrl+Shift+M</code> to insert the pipe operator. On a Mac, use <code>Cmd+Shift+M</code>.</p>
<p><code>R</code> also has its own pipe, <code>|&gt;</code>, which is an alternative to <code>%&gt;%</code>. You will see both used in this course. If you want to change the pipe inserted automatically with <code>Ctrl+Shift+M</code>, find on the menu <strong>Tools &gt; Global Options</strong>, then click on <strong>Code</strong> and check the box that says “<strong>Use Native Pipe Operator</strong>”.</p>
<p>Consider the study guide dataset <code>rangitikei.txt</code> (Recreational Use of the Rangitikei river). The first 10 rows of this dataset are shown below:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   id loc time w.e cl wind temp river people vehicle
1   1   1    2   1  1    2    2     1     37      15
2   2   1    1   1  1    2    1     2     23       6
3   3   1    2   1  1    2    2     3     87      31
4   4   2    2   1  1    2    1     1     86      27
5   5   2    1   1  1    2    2     2     19       2
6   6   2    2   1  2    1    3     3    136      23
7   7   1    2   2  2    2    2     3     14       8
8   8   1    2   1  2    2    2     3     67      26
9   9   1    1   2  1    3    1     2      4       3
10 10   2    2   1  2    2    2     3    127      45</code></pre>
</div>
</div>
<p>Try the following examples after loading the <code>rangitikei</code> dataset.</p>
<p><code>select()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>new.data <span class="ot">&lt;-</span> my.data <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, vehicle)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(new.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "people"  "vehicle"</code></pre>
</div>
</div>
<p>What does <code>select()</code> do?</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, vehicle) <span class="sc">|&gt;</span> <span class="co"># select columns</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="co"># make a plot using those columns</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>people, <span class="at">y=</span>vehicle) <span class="sc">+</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_5_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We select two columns and create a scatter plot with the above commands.</p>
<p>Now try another function:</p>
<p><code>filter()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wind<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, vehicle) <span class="sc">|&gt;</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>people, <span class="at">y=</span>vehicle) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_5_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What does <code>filter()</code> do?</p>
<p>The above commands filter the data for the low wind days and plots vehicle against people. <code>filter()</code> subsets the data for all observations matching a specified criteria.</p>
<p><code>arrange()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wind<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(w.e) <span class="sc">|&gt;</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(w.e, people, vehicle)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  w.e people vehicle
1   1    136      23
2   1     50      22
3   1    100      31
4   1    470     122
5   2     22      11</code></pre>
</div>
</div>
<p><code>mutate()</code></p>
<p>Assume that a $10 levy is collected for each vehicle. We can create this new <code>levy</code> column as follows.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">levy =</span> vehicle<span class="sc">*</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, levy) <span class="sc">|&gt;</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> people, <span class="at">y=</span>levy) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_5_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note that the pipe operation was used to create a scatter plot using the newly created column.</p>
<p><code>summarise()</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">n</span>(), </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg =</span> <span class="fu">mean</span>(people)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  total      avg
1    33 71.72727</code></pre>
</div>
</div>
<p>We obtain the selected summary measures namely the total and the mean number of people. Try-</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wind <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">n</span>(), </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg =</span> <span class="fu">mean</span>(people)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  total   avg
1     5 155.6</code></pre>
</div>
</div>
<p><code>group_by()</code></p>
<p>We obtain the wind group-wise summaries below:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total=</span><span class="fu">n</span>(), </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg=</span><span class="fu">mean</span>(people))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
   wind total   avg
  &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
1     1     5 156. 
2     2    26  59.7
3     3     2  19  </code></pre>
</div>
</div>
<p>There are many more commands such as the <code>transmute</code> function which conserves the only the needed columns. Try</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind, w.e) <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">total=</span><span class="fu">n</span>(), </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg=</span><span class="fu">mean</span>(people))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 4
# Groups:   wind, w.e [6]
    wind   w.e total   avg
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
 1     2     1    18  72.1
 2     2     1    18  72.1
 3     2     1    18  72.1
 4     2     1    18  72.1
 5     2     1    18  72.1
 6     1     1     4 189  
 7     2     2     8  31.8
 8     2     1    18  72.1
 9     3     2     1   4  
10     2     1    18  72.1
# ℹ 23 more rows</code></pre>
</div>
</div>
<p>A simple frequency table is found using <code>count()</code>. Try-</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind, w.e) <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
# Groups:   wind, w.e [6]
    wind   w.e  temp     n
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1     1     1     1     1
 2     1     1     3     3
 3     1     2     3     1
 4     2     1     1     4
 5     2     1     2    12
 6     2     1     3     2
 7     2     2     2     6
 8     2     2     3     2
 9     3     1     2     1
10     3     2     1     1</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind, w.e) <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(temp, river)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 5
# Groups:   wind, w.e [6]
    wind   w.e  temp river     n
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1     1     1     1     1     1
 2     1     1     3     3     3
 3     1     2     3     3     1
 4     2     1     1     1     1
 5     2     1     1     2     1
 6     2     1     1     3     2
 7     2     1     2     1     3
 8     2     1     2     2     2
 9     2     1     2     3     7
10     2     1     3     3     2
11     2     2     2     1     2
12     2     2     2     3     4
13     2     2     3     2     1
14     2     2     3     3     1
15     3     1     2     2     1
16     3     2     1     2     1</code></pre>
</div>
</div>
<p>The <code>count()</code> is useful to check the balanced nature of the data when many subgroups are involved.</p>
<p>Now let’s practice using these functions.</p>
</section>
</section>
<section id="exercise-1.2" class="level1 unnumbered">
<h1 class="unnumbered">Exercise 1.2</h1>
<p>Using <code>table1</code>, compute rate of TB cases per 10,000 and the total cases per year</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>table1 <span class="sc">|&gt;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate =</span> cases <span class="sc">/</span> population <span class="sc">*</span> <span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  country      year  cases population  rate
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
1 Afghanistan  1999    745   19987071 0.373
2 Afghanistan  2000   2666   20595360 1.29 
3 Brazil       1999  37737  172006362 2.19 
4 Brazil       2000  80488  174504898 4.61 
5 China        1999 212258 1272915272 1.67 
6 China        2000 213766 1280428583 1.67 </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>table1 <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_cases =</span> <span class="fu">sum</span>(cases))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
   year total_cases
  &lt;dbl&gt;       &lt;dbl&gt;
1  1999      250740
2  2000      296920</code></pre>
</div>
</div>
</section>
<section id="exercise-1.3" class="level1 unnumbered">
<h1 class="unnumbered">Exercise 1.3</h1>
<p>For <code>table2</code>, write pseudo-code for how you would perform the following actions. Sketch/describe how you would do these.</p>
<ol type="a">
<li><p>Extract the number of TB cases per country per year.</p></li>
<li><p>Extract the matching population per country per year.</p></li>
<li><p>Divide cases by population, and multiply by 10000.</p></li>
<li><p>Store back in the appropriate place.</p></li>
</ol>
</section>
<section id="dataset-diamonds" class="level1">
<h1>Dataset <em>diamonds</em></h1>
<p>We will now use the built in dataset on diamond price and measurements for some more exercises. See<code>?diamonds</code> more information.</p>
</section>
<section id="exercise-1.4" class="level1 unnumbered">
<h1 class="unnumbered">Exercise 1.4</h1>
<p>Outliers are observations that are unusual; data points that don’t seem to fit the pattern. Sometimes outliers are data entry errors, sometimes they are simply values at the extremes that happened to be observed in this data collection, and other times they suggest important new discoveries.</p>
<p>Describe the distribution of the <code>y</code> variable from the diamonds dataset.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> y) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_5_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The only evidence of outliers is the unusually wide limits on the x-axis.</p>
<p>There are so many observations in the common bins that the rare bins are very short, making it very difficult to see them (although maybe if you stare intently at 0 you’ll spot something). We can change the <code>binwidth=</code> to help with this. We can also zoom in on the y axis using <code>coord_cartesian()</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> y) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>)) <span class="co"># also has an xlim() option</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ws01_5_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="exercise-1.5" class="level1 unnumbered">
<h1 class="unnumbered">Exercise 1.5</h1>
<p>Make a new dataset that includes these unusual values using dplyr.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>unusual <span class="ot">&lt;-</span> diamonds <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&lt;</span> <span class="dv">3</span> <span class="sc">|</span> y <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(price, x, y, z) <span class="sc">|&gt;</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(y)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>unusual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
  price     x     y     z
  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  5139  0      0    0   
2  6381  0      0    0   
3 12800  0      0    0   
4 15686  0      0    0   
5 18034  0      0    0   
6  2130  0      0    0   
7  2130  0      0    0   
8  2075  5.15  31.8  5.12
9 12210  8.09  58.9  8.06</code></pre>
</div>
</div>
</section>
<section id="exercise-1.6" class="level1 unnumbered">
<h1 class="unnumbered">Exercise 1.6</h1>
<p>How many diamonds are 0.99 carat? How many are 1 carat? What do you think is the cause of the difference?</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code goes here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exercise-1.7" class="level1 unnumbered">
<h1 class="unnumbered">Exercise 1.7</h1>
<p>What does <code>na.rm = TRUE</code> do in mean() and sum()?</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code goes here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tidying-data" class="level1">
<h1>Tidying data</h1>
<p>Most real analyses will require at least a little tidying. You’ll begin by figuring out what the underlying variables and observations are. Sometimes this is easy; other times you’ll need to consult with the people who originally generated the data. Next, you’ll pivot your data into a tidy form, with variables in the columns and observations in the rows.</p>
<p>The <code>billboard</code> dataset records the billboard rank of songs in the year 2000:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>billboard</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 317 × 79
   artist     track date.entered   wk1   wk2   wk3   wk4   wk5   wk6   wk7   wk8
   &lt;chr&gt;      &lt;chr&gt; &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 2 Pac      Baby… 2000-02-26      87    82    72    77    87    94    99    NA
 2 2Ge+her    The … 2000-09-02      91    87    92    NA    NA    NA    NA    NA
 3 3 Doors D… Kryp… 2000-04-08      81    70    68    67    66    57    54    53
 4 3 Doors D… Loser 2000-10-21      76    76    72    69    67    65    55    59
 5 504 Boyz   Wobb… 2000-04-15      57    34    25    17    17    31    36    49
 6 98^0       Give… 2000-08-19      51    39    34    26    26    19     2     2
 7 A*Teens    Danc… 2000-07-08      97    97    96    95   100    NA    NA    NA
 8 Aaliyah    I Do… 2000-01-29      84    62    51    41    38    35    35    38
 9 Aaliyah    Try … 2000-03-18      59    53    38    28    21    18    16    14
10 Adams, Yo… Open… 2000-08-26      76    76    74    69    68    67    61    58
# ℹ 307 more rows
# ℹ 68 more variables: wk9 &lt;dbl&gt;, wk10 &lt;dbl&gt;, wk11 &lt;dbl&gt;, wk12 &lt;dbl&gt;,
#   wk13 &lt;dbl&gt;, wk14 &lt;dbl&gt;, wk15 &lt;dbl&gt;, wk16 &lt;dbl&gt;, wk17 &lt;dbl&gt;, wk18 &lt;dbl&gt;,
#   wk19 &lt;dbl&gt;, wk20 &lt;dbl&gt;, wk21 &lt;dbl&gt;, wk22 &lt;dbl&gt;, wk23 &lt;dbl&gt;, wk24 &lt;dbl&gt;,
#   wk25 &lt;dbl&gt;, wk26 &lt;dbl&gt;, wk27 &lt;dbl&gt;, wk28 &lt;dbl&gt;, wk29 &lt;dbl&gt;, wk30 &lt;dbl&gt;,
#   wk31 &lt;dbl&gt;, wk32 &lt;dbl&gt;, wk33 &lt;dbl&gt;, wk34 &lt;dbl&gt;, wk35 &lt;dbl&gt;, wk36 &lt;dbl&gt;,
#   wk37 &lt;dbl&gt;, wk38 &lt;dbl&gt;, wk39 &lt;dbl&gt;, wk40 &lt;dbl&gt;, wk41 &lt;dbl&gt;, wk42 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>In this dataset, each observation is a song. The first three columns (artist, track and date.entered) are variables that describe the song. Then we have 76 columns (wk1-wk76) that describe the rank of the song in each week. Here, the column names are one variable (the week) and the cell values are another (the rank).</p>
</section>
<section id="exercise-1.8" class="level1 unnumbered">
<h1 class="unnumbered">Exercise 1.8</h1>
<p>Use <code>pivot_longer()</code> to tidy this data</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code goes here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="combining-datasets" class="level2">
<h2 class="anchored" data-anchor-id="combining-datasets">Combining datasets</h2>
<p>Two tables can be connected through a pair of keys, within each table.</p>
<p>Every join involves a pair of keys: a primary key and a foreign key. A primary key is a variable or set of variables that uniquely identifies each observation. When more than one variable is needed, the key is called a compound key.</p>
<p>There are four types of joins, we will illustrate them using a simple example:</p>
<p>First lets make some data:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">y =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">a =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now join the two datasets using the different join functions:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(df2) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(x)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
      x     y     a b    
  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;
1     1     2    10 a    </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(x)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
      x     y     a b    
  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;
1     1     2    10 a    
2     2     1    NA &lt;NA&gt; </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">right_join</span>(df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(x)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
      x     y     a b    
  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;
1     1     2    10 a    
2     3    NA    10 a    </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(x)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
      x     a b         y
  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt;
1     3    10 a        NA
2     1    10 a         2</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(x)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
      x     y     a b    
  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;
1     1     2    10 a    
2     2     1    NA &lt;NA&gt; 
3     3    NA    10 a    </code></pre>
</div>
</div>
<p>What are the differences between the join functions?</p>
</section>
</section>
<section id="specifying-join-keys" class="level1">
<h1>Specifying join keys</h1>
<p>By default, left_join() will use all variables that appear in both data frames as the join key, but it doesn’t always work.</p>
<p>For example lets look at some airline data:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13) <span class="co"># data package</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>flights2 <span class="ot">&lt;-</span> flights <span class="sc">|&gt;</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, time_hour, origin, dest, tailnum, carrier)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>flights2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 6
    year time_hour           origin dest  tailnum carrier
   &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  
 1  2013 2013-01-01 05:00:00 EWR    IAH   N14228  UA     
 2  2013 2013-01-01 05:00:00 LGA    IAH   N24211  UA     
 3  2013 2013-01-01 05:00:00 JFK    MIA   N619AA  AA     
 4  2013 2013-01-01 05:00:00 JFK    BQN   N804JB  B6     
 5  2013 2013-01-01 06:00:00 LGA    ATL   N668DN  DL     
 6  2013 2013-01-01 05:00:00 EWR    ORD   N39463  UA     
 7  2013 2013-01-01 06:00:00 EWR    FLL   N516JB  B6     
 8  2013 2013-01-01 06:00:00 LGA    IAD   N829AS  EV     
 9  2013 2013-01-01 06:00:00 JFK    MCO   N593JB  B6     
10  2013 2013-01-01 06:00:00 LGA    ORD   N3ALAA  AA     
# ℹ 336,766 more rows</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>planes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,322 × 9
   tailnum  year type              manufacturer model engines seats speed engine
   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;        &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
 1 N10156   2004 Fixed wing multi… EMBRAER      EMB-…       2    55    NA Turbo…
 2 N102UW   1998 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 3 N103US   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 4 N104UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 5 N10575   2002 Fixed wing multi… EMBRAER      EMB-…       2    55    NA Turbo…
 6 N105UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 7 N107US   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 8 N108UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 9 N109UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
10 N110UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
# ℹ 3,312 more rows</code></pre>
</div>
</div>
<p>We are going to try to going flight data to data about types of planes</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(planes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(year, tailnum)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 13
    year time_hour           origin dest  tailnum carrier type  manufacturer
   &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;       
 1  2013 2013-01-01 05:00:00 EWR    IAH   N14228  UA      &lt;NA&gt;  &lt;NA&gt;        
 2  2013 2013-01-01 05:00:00 LGA    IAH   N24211  UA      &lt;NA&gt;  &lt;NA&gt;        
 3  2013 2013-01-01 05:00:00 JFK    MIA   N619AA  AA      &lt;NA&gt;  &lt;NA&gt;        
 4  2013 2013-01-01 05:00:00 JFK    BQN   N804JB  B6      &lt;NA&gt;  &lt;NA&gt;        
 5  2013 2013-01-01 06:00:00 LGA    ATL   N668DN  DL      &lt;NA&gt;  &lt;NA&gt;        
 6  2013 2013-01-01 05:00:00 EWR    ORD   N39463  UA      &lt;NA&gt;  &lt;NA&gt;        
 7  2013 2013-01-01 06:00:00 EWR    FLL   N516JB  B6      &lt;NA&gt;  &lt;NA&gt;        
 8  2013 2013-01-01 06:00:00 LGA    IAD   N829AS  EV      &lt;NA&gt;  &lt;NA&gt;        
 9  2013 2013-01-01 06:00:00 JFK    MCO   N593JB  B6      &lt;NA&gt;  &lt;NA&gt;        
10  2013 2013-01-01 06:00:00 LGA    ORD   N3ALAA  AA      &lt;NA&gt;  &lt;NA&gt;        
# ℹ 336,766 more rows
# ℹ 5 more variables: model &lt;chr&gt;, engines &lt;int&gt;, seats &lt;int&gt;, speed &lt;int&gt;,
#   engine &lt;chr&gt;</code></pre>
</div>
</div>
<p>We get a lot of missing matches because our join is trying to use tailnum and year as a compound key. Both flights and planes have a year column but they mean different things: <code>flights$year</code> is the year the flight occurred and <code>planes$year</code> is the year the plane was built.</p>
<p>Since these represent different types of data and we might want to keep both, we can be explicit about how to join the two data tables:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">|&gt;</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(planes, <span class="fu">join_by</span>(tailnum))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 14
   year.x time_hour           origin dest  tailnum carrier year.y type          
    &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;         
 1   2013 2013-01-01 05:00:00 EWR    IAH   N14228  UA        1999 Fixed wing mu…
 2   2013 2013-01-01 05:00:00 LGA    IAH   N24211  UA        1998 Fixed wing mu…
 3   2013 2013-01-01 05:00:00 JFK    MIA   N619AA  AA        1990 Fixed wing mu…
 4   2013 2013-01-01 05:00:00 JFK    BQN   N804JB  B6        2012 Fixed wing mu…
 5   2013 2013-01-01 06:00:00 LGA    ATL   N668DN  DL        1991 Fixed wing mu…
 6   2013 2013-01-01 05:00:00 EWR    ORD   N39463  UA        2012 Fixed wing mu…
 7   2013 2013-01-01 06:00:00 EWR    FLL   N516JB  B6        2000 Fixed wing mu…
 8   2013 2013-01-01 06:00:00 LGA    IAD   N829AS  EV        1998 Fixed wing mu…
 9   2013 2013-01-01 06:00:00 JFK    MCO   N593JB  B6        2004 Fixed wing mu…
10   2013 2013-01-01 06:00:00 LGA    ORD   N3ALAA  AA          NA &lt;NA&gt;          
# ℹ 336,766 more rows
# ℹ 6 more variables: manufacturer &lt;chr&gt;, model &lt;chr&gt;, engines &lt;int&gt;,
#   seats &lt;int&gt;, speed &lt;int&gt;, engine &lt;chr&gt;</code></pre>
</div>
</div>
<p>Now by default there is a year.x and year.y coming from the flights and planes data respectively. You can change this using the <code>suffix</code> argument in join or by renaming the columns after the join.</p>
</section>
<section id="exercise-1.9" class="level1 unnumbered">
<h1 class="unnumbered">Exercise 1.9</h1>
<p>Imagine you’ve found the top 10 most popular destinations using this code:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>top_dest <span class="ot">&lt;-</span> flights2 <span class="sc">|&gt;</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(dest, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>How can you find all flights to those destinations?</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code goes here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exercise-1.10" class="level1 unnumbered">
<h1 class="unnumbered">Exercise 1.10</h1>
<p>What do the tail numbers that don’t have a matching record in planes have in common? (Hint: one variable explains ~90% of the problems.)</p>
</section>
<section id="case_when" class="level1">
<h1>case_when()</h1>
<p>Sometimes you want to add a new variable to your data based on existing variables.</p>
<p>dplyr’s case_when() is inspired by SQL’s CASE statement and provides a flexible way of performing different computations for different conditions. It has a special syntax that unfortunately looks like nothing else you’ll use in the tidyverse. It takes pairs that look like condition ~ output. condition must be a logical vector; when it’s TRUE, output will be used.</p>
<p>This can take the place of if_else() statements.</p>
<p>For example:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">status =</span> <span class="fu">case_when</span>( <span class="co"># make a new variable status based on the flights arrival delay</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(arr_delay)      <span class="sc">~</span> <span class="st">"cancelled"</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>      arr_delay <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">30</span>       <span class="sc">~</span> <span class="st">"very early"</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>      arr_delay <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">15</span>       <span class="sc">~</span> <span class="st">"early"</span>,</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>(arr_delay) <span class="sc">&lt;=</span> <span class="dv">15</span>  <span class="sc">~</span> <span class="st">"on time"</span>,</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>      arr_delay <span class="sc">&lt;</span> <span class="dv">60</span>        <span class="sc">~</span> <span class="st">"late"</span>,</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>      arr_delay <span class="sc">&lt;</span> <span class="cn">Inf</span>       <span class="sc">~</span> <span class="st">"very late"</span>,</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.keep =</span> <span class="st">"used"</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 2
   arr_delay status 
       &lt;dbl&gt; &lt;chr&gt;  
 1        11 on time
 2        20 late   
 3        33 late   
 4       -18 early  
 5       -25 early  
 6        12 on time
 7        19 late   
 8       -14 on time
 9        -8 on time
10         8 on time
# ℹ 336,766 more rows</code></pre>
</div>
</div>
</section>
<section id="exercise-1.11" class="level1 unnumbered">
<h1 class="unnumbered">Exercise 1.11</h1>
<p>Write a case_when() statement that uses the month and day columns from flights to label a selection of important US holidays (e.g., New Years Day, 4th of July, Thanksgiving, and Christmas). First create a logical column that is either TRUE or FALSE, and then create a character column that either gives the name of the holiday or is NA.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../workshops/ws01.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Getting Started With R</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../workshops/ws02.html" class="pagination-link">
        <span class="nav-page-text">Chapter 2 Workshop</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb79" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Tidy data"</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="fu">## `tidyr` {.unnumbered}</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>By the phrase <span class="in">`tidy data`</span>, it is meant the preferred way of arranging</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>data that is easy to analyse. The principles of tidy data are:</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Each variable forms a column.</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Each observation forms a row.</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Each type of observational unit forms a table.</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>*Simple Manipulations*</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>There is always more than one-way of manipulating the data, producing summaries and tables from raw data.</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>One of the simplest manipulations on a batch of data we may do is to</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>change the data type say numeric to character. For example, the</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>television viewing time data in the text file <span class="in">`tv.csv`</span> is read into a dataframe by the command line</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/tv.csv"</span>, </span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span><span class="cn">TRUE</span></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>We can improve the <span class="in">`read.csv`</span> command to recognise the data type while reading the table as follows, using the <span class="in">`read_csv`</span> command from the <span class="in">`readr`</span> package:</span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/tv.csv"</span>, </span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="st">"nfcc"</span></span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a>The argument <span class="in">`col_types = "nfcc"`</span> stands for <span class="sc">\{</span><span class="in">`numeric`</span>, <span class="in">`factor`</span>, <span class="in">`character`</span>, <span class="in">`character`</span><span class="sc">\}</span>, to match the order of the columns.</span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-47"><a href="#cb79-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-48"><a href="#cb79-48" aria-hidden="true" tabindex="-1"></a>my.data</span>
<span id="cb79-49"><a href="#cb79-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-50"><a href="#cb79-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-51"><a href="#cb79-51" aria-hidden="true" tabindex="-1"></a>We often do a summary of a numerical variable for a given categorical variable. For example, we like to see obtain the summary statistics of TV viewing times for various schools. The commands</span>
<span id="cb79-52"><a href="#cb79-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-53"><a href="#cb79-53" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb79-54"><a href="#cb79-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-55"><a href="#cb79-55" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(my.data<span class="sc">$</span>TELETIME, my.data<span class="sc">$</span>SCHOOL, summary)</span>
<span id="cb79-56"><a href="#cb79-56" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-57"><a href="#cb79-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-58"><a href="#cb79-58" aria-hidden="true" tabindex="-1"></a>We employed the <span class="in">`by()`</span> command above and instead, we may also use</span>
<span id="cb79-59"><a href="#cb79-59" aria-hidden="true" tabindex="-1"></a><span class="in">`tapply()`</span> <span class="in">`aggregate()`</span> functions:</span>
<span id="cb79-60"><a href="#cb79-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-61"><a href="#cb79-61" aria-hidden="true" tabindex="-1"></a><span class="in">`tapply(my.data$TELETIME, my.data$SCHOOL, summary)`</span></span>
<span id="cb79-62"><a href="#cb79-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-63"><a href="#cb79-63" aria-hidden="true" tabindex="-1"></a><span class="in">`aggregate(my.data$TELETIME, list(my.data$SCHOOL), summary)`</span></span>
<span id="cb79-64"><a href="#cb79-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-65"><a href="#cb79-65" aria-hidden="true" tabindex="-1"></a>A tabulated summary of categorical data is obtained using the <span class="in">`table()`</span></span>
<span id="cb79-66"><a href="#cb79-66" aria-hidden="true" tabindex="-1"></a>command.</span>
<span id="cb79-67"><a href="#cb79-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-68"><a href="#cb79-68" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb79-69"><a href="#cb79-69" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb79-70"><a href="#cb79-70" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>,</span>
<span id="cb79-71"><a href="#cb79-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span></span>
<span id="cb79-72"><a href="#cb79-72" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-73"><a href="#cb79-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-74"><a href="#cb79-74" aria-hidden="true" tabindex="-1"></a>wind <span class="ot">&lt;-</span> my.data <span class="sc">|&gt;</span> <span class="fu">pull</span>(wind)</span>
<span id="cb79-75"><a href="#cb79-75" aria-hidden="true" tabindex="-1"></a>river <span class="ot">&lt;-</span> my.data <span class="sc">|&gt;</span> <span class="fu">pull</span>(river)</span>
<span id="cb79-76"><a href="#cb79-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-77"><a href="#cb79-77" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wind, river)</span>
<span id="cb79-78"><a href="#cb79-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-79"><a href="#cb79-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-80"><a href="#cb79-80" aria-hidden="true" tabindex="-1"></a>It is sometimes convenient to work with matrices for some R functions</span>
<span id="cb79-81"><a href="#cb79-81" aria-hidden="true" tabindex="-1"></a>such as <span class="in">`apply()`</span>. For example, the number of admissions data in</span>
<span id="cb79-82"><a href="#cb79-82" aria-hidden="true" tabindex="-1"></a><span class="in">`hospital.txt`</span> data can be formed as a matrix. Note that this is</span>
<span id="cb79-83"><a href="#cb79-83" aria-hidden="true" tabindex="-1"></a>possible because we have the same number of observations for each</span>
<span id="cb79-84"><a href="#cb79-84" aria-hidden="true" tabindex="-1"></a>hospital location.</span>
<span id="cb79-85"><a href="#cb79-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-86"><a href="#cb79-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.show="hide", results='hide'}</span></span>
<span id="cb79-87"><a href="#cb79-87" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb79-88"><a href="#cb79-88" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/hospital.txt"</span>,</span>
<span id="cb79-89"><a href="#cb79-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span>, </span>
<span id="cb79-90"><a href="#cb79-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep=</span><span class="st">","</span>)</span>
<span id="cb79-91"><a href="#cb79-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-92"><a href="#cb79-92" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb79-93"><a href="#cb79-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(NORTH1, NORTH2, NORTH3, </span>
<span id="cb79-94"><a href="#cb79-94" aria-hidden="true" tabindex="-1"></a>         SOUTH1, SOUTH2, SOUTH3) <span class="sc">|&gt;</span> </span>
<span id="cb79-95"><a href="#cb79-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>()</span>
<span id="cb79-96"><a href="#cb79-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-97"><a href="#cb79-97" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">apply</span>(M, <span class="dv">1</span>, mean)</span>
<span id="cb79-98"><a href="#cb79-98" aria-hidden="true" tabindex="-1"></a>sds <span class="ot">&lt;-</span> <span class="fu">apply</span>(M, <span class="dv">1</span>, sd)</span>
<span id="cb79-99"><a href="#cb79-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-100"><a href="#cb79-100" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(means, sds)</span>
<span id="cb79-101"><a href="#cb79-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-102"><a href="#cb79-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-103"><a href="#cb79-103" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction to the tidyverse</span></span>
<span id="cb79-104"><a href="#cb79-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-105"><a href="#cb79-105" aria-hidden="true" tabindex="-1"></a>We will be largely using the <span class="in">`tidyverse`</span> suite of packages for data organisation, summarizing, and plotting; see <span class="ot">&lt;https://www.tidyverse.org/&gt;</span>.</span>
<span id="cb79-106"><a href="#cb79-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-107"><a href="#cb79-107" aria-hidden="true" tabindex="-1"></a>Let's load that package now:</span>
<span id="cb79-108"><a href="#cb79-108" aria-hidden="true" tabindex="-1"></a>Remember if you have not installed it you will need to use <span class="in">`install.packages()`</span> first.</span>
<span id="cb79-109"><a href="#cb79-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-112"><a href="#cb79-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-113"><a href="#cb79-113" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb79-114"><a href="#cb79-114" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb79-115"><a href="#cb79-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-116"><a href="#cb79-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-117"><a href="#cb79-117" aria-hidden="true" tabindex="-1"></a><span class="fu"># Datset</span></span>
<span id="cb79-118"><a href="#cb79-118" aria-hidden="true" tabindex="-1"></a>For this workshop we will use some tidyverse built in datasets. Each dataset below shows the same values of four variables: country, year, population, and number of documented cases of TB (tuberculosis), but each dataset organizes the values in a different way. Take a look at these datasets by typing their names into a code chunk or directly into the console. You can also try your hand at the functions <span class="in">`head()`</span> and <span class="in">`summary()`</span>. </span>
<span id="cb79-119"><a href="#cb79-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-122"><a href="#cb79-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-123"><a href="#cb79-123" aria-hidden="true" tabindex="-1"></a>table1</span>
<span id="cb79-124"><a href="#cb79-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-125"><a href="#cb79-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-126"><a href="#cb79-126" aria-hidden="true" tabindex="-1"></a>table2</span>
<span id="cb79-127"><a href="#cb79-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-128"><a href="#cb79-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-129"><a href="#cb79-129" aria-hidden="true" tabindex="-1"></a>table3</span>
<span id="cb79-130"><a href="#cb79-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-131"><a href="#cb79-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-132"><a href="#cb79-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-133"><a href="#cb79-133" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exercise 1.1 {-}</span></span>
<span id="cb79-134"><a href="#cb79-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-135"><a href="#cb79-135" aria-hidden="true" tabindex="-1"></a>For each of the sample tables, describe what each observation and each column represents. Which is the most <span class="in">`tidy`</span>?</span>
<span id="cb79-136"><a href="#cb79-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-137"><a href="#cb79-137" aria-hidden="true" tabindex="-1"></a>::: {#answer}</span>
<span id="cb79-138"><a href="#cb79-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-139"><a href="#cb79-139" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-140"><a href="#cb79-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-141"><a href="#cb79-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-142"><a href="#cb79-142" aria-hidden="true" tabindex="-1"></a><span class="fu">## Piping</span></span>
<span id="cb79-143"><a href="#cb79-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-144"><a href="#cb79-144" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb79-145"><a href="#cb79-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-146"><a href="#cb79-146" aria-hidden="true" tabindex="-1"></a>**The piping operation is a fundamental aspect of computer programming. The semantics of pipes is taking the output from the left-hand side and passing it as input to the right-hand side.**</span>
<span id="cb79-147"><a href="#cb79-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-148"><a href="#cb79-148" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-149"><a href="#cb79-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-150"><a href="#cb79-150" aria-hidden="true" tabindex="-1"></a>The <span class="in">`R`</span> package <span class="in">`magrittr`</span> introduced the pipe operator <span class="in">`%&gt;%`</span> and can be pronounced as "then". In RStudio windows/Linux versions, press <span class="in">`Ctrl+Shift+M`</span> to insert the pipe operator. On a Mac, use <span class="in">`Cmd+Shift+M`</span>. </span>
<span id="cb79-151"><a href="#cb79-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-152"><a href="#cb79-152" aria-hidden="true" tabindex="-1"></a><span class="in">`R`</span> also has its own pipe, <span class="in">`|&gt;`</span>, which is an alternative to <span class="in">`%&gt;%`</span>. You will see both used in this course. If you want to change the pipe inserted automatically with <span class="in">`Ctrl+Shift+M`</span>, find on the menu **Tools &gt; Global Options**, then click on **Code** and check the box that says "**Use Native Pipe Operator**". </span>
<span id="cb79-153"><a href="#cb79-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-154"><a href="#cb79-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-155"><a href="#cb79-155" aria-hidden="true" tabindex="-1"></a>Consider the study guide dataset <span class="in">`rangitikei.txt`</span> (Recreational Use of</span>
<span id="cb79-156"><a href="#cb79-156" aria-hidden="true" tabindex="-1"></a>the Rangitikei river). The first 10 rows of this dataset are shown</span>
<span id="cb79-157"><a href="#cb79-157" aria-hidden="true" tabindex="-1"></a>below:</span>
<span id="cb79-158"><a href="#cb79-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-159"><a href="#cb79-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb79-160"><a href="#cb79-160" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb79-161"><a href="#cb79-161" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>, </span>
<span id="cb79-162"><a href="#cb79-162" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span></span>
<span id="cb79-163"><a href="#cb79-163" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-164"><a href="#cb79-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-165"><a href="#cb79-165" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my.data, <span class="dv">10</span>) <span class="co"># shows the first ten rows</span></span>
<span id="cb79-166"><a href="#cb79-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-167"><a href="#cb79-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-168"><a href="#cb79-168" aria-hidden="true" tabindex="-1"></a>Try the following examples after loading the <span class="in">`rangitikei`</span> dataset.</span>
<span id="cb79-169"><a href="#cb79-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-170"><a href="#cb79-170" aria-hidden="true" tabindex="-1"></a><span class="in">`select()`</span></span>
<span id="cb79-171"><a href="#cb79-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-174"><a href="#cb79-174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-175"><a href="#cb79-175" aria-hidden="true" tabindex="-1"></a>new.data <span class="ot">&lt;-</span> my.data <span class="sc">|&gt;</span> </span>
<span id="cb79-176"><a href="#cb79-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, vehicle)</span>
<span id="cb79-177"><a href="#cb79-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-178"><a href="#cb79-178" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(new.data)</span>
<span id="cb79-179"><a href="#cb79-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-180"><a href="#cb79-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-181"><a href="#cb79-181" aria-hidden="true" tabindex="-1"></a>What does <span class="in">`select()`</span> do?</span>
<span id="cb79-182"><a href="#cb79-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-185"><a href="#cb79-185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-186"><a href="#cb79-186" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb79-187"><a href="#cb79-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, vehicle) <span class="sc">|&gt;</span> <span class="co"># select columns</span></span>
<span id="cb79-188"><a href="#cb79-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="co"># make a plot using those columns</span></span>
<span id="cb79-189"><a href="#cb79-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>people, <span class="at">y=</span>vehicle) <span class="sc">+</span> </span>
<span id="cb79-190"><a href="#cb79-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb79-191"><a href="#cb79-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-192"><a href="#cb79-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-193"><a href="#cb79-193" aria-hidden="true" tabindex="-1"></a>We select two columns and create a scatter plot with the above commands.</span>
<span id="cb79-194"><a href="#cb79-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-195"><a href="#cb79-195" aria-hidden="true" tabindex="-1"></a>Now try another function:</span>
<span id="cb79-196"><a href="#cb79-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-197"><a href="#cb79-197" aria-hidden="true" tabindex="-1"></a><span class="in">`filter()`</span></span>
<span id="cb79-198"><a href="#cb79-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-201"><a href="#cb79-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-202"><a href="#cb79-202" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb79-203"><a href="#cb79-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wind<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb79-204"><a href="#cb79-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, vehicle) <span class="sc">|&gt;</span> </span>
<span id="cb79-205"><a href="#cb79-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb79-206"><a href="#cb79-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>people, <span class="at">y=</span>vehicle) <span class="sc">+</span></span>
<span id="cb79-207"><a href="#cb79-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb79-208"><a href="#cb79-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-209"><a href="#cb79-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-210"><a href="#cb79-210" aria-hidden="true" tabindex="-1"></a>What does <span class="in">`filter()`</span> do? </span>
<span id="cb79-211"><a href="#cb79-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-212"><a href="#cb79-212" aria-hidden="true" tabindex="-1"></a>The above commands filter the data for the low wind days and plots</span>
<span id="cb79-213"><a href="#cb79-213" aria-hidden="true" tabindex="-1"></a>vehicle against people. <span class="in">`filter()`</span> subsets the data for all observations matching a specified criteria.</span>
<span id="cb79-214"><a href="#cb79-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-215"><a href="#cb79-215" aria-hidden="true" tabindex="-1"></a><span class="in">`arrange()`</span></span>
<span id="cb79-216"><a href="#cb79-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-219"><a href="#cb79-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-220"><a href="#cb79-220" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb79-221"><a href="#cb79-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wind<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb79-222"><a href="#cb79-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(w.e) <span class="sc">|&gt;</span> </span>
<span id="cb79-223"><a href="#cb79-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(w.e, people, vehicle)</span>
<span id="cb79-224"><a href="#cb79-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-225"><a href="#cb79-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-226"><a href="#cb79-226" aria-hidden="true" tabindex="-1"></a><span class="in">`mutate()`</span></span>
<span id="cb79-227"><a href="#cb79-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-228"><a href="#cb79-228" aria-hidden="true" tabindex="-1"></a>Assume that a \$10 levy is collected for each vehicle. We can create</span>
<span id="cb79-229"><a href="#cb79-229" aria-hidden="true" tabindex="-1"></a>this new <span class="in">`levy`</span> column as follows.</span>
<span id="cb79-230"><a href="#cb79-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-233"><a href="#cb79-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-234"><a href="#cb79-234" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb79-235"><a href="#cb79-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">levy =</span> vehicle<span class="sc">*</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb79-236"><a href="#cb79-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(people, levy) <span class="sc">|&gt;</span> </span>
<span id="cb79-237"><a href="#cb79-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb79-238"><a href="#cb79-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> people, <span class="at">y=</span>levy) <span class="sc">+</span></span>
<span id="cb79-239"><a href="#cb79-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb79-240"><a href="#cb79-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-241"><a href="#cb79-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-242"><a href="#cb79-242" aria-hidden="true" tabindex="-1"></a>Note that the pipe operation was used to create a scatter plot using the</span>
<span id="cb79-243"><a href="#cb79-243" aria-hidden="true" tabindex="-1"></a>newly created column.</span>
<span id="cb79-244"><a href="#cb79-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-245"><a href="#cb79-245" aria-hidden="true" tabindex="-1"></a><span class="in">`summarise()`</span></span>
<span id="cb79-246"><a href="#cb79-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-249"><a href="#cb79-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-250"><a href="#cb79-250" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb79-251"><a href="#cb79-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">n</span>(), </span>
<span id="cb79-252"><a href="#cb79-252" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg =</span> <span class="fu">mean</span>(people)</span>
<span id="cb79-253"><a href="#cb79-253" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb79-254"><a href="#cb79-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-255"><a href="#cb79-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-256"><a href="#cb79-256" aria-hidden="true" tabindex="-1"></a>We obtain the selected summary measures namely the total and the mean</span>
<span id="cb79-257"><a href="#cb79-257" aria-hidden="true" tabindex="-1"></a>number of people. Try-</span>
<span id="cb79-258"><a href="#cb79-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-261"><a href="#cb79-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-262"><a href="#cb79-262" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb79-263"><a href="#cb79-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wind <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb79-264"><a href="#cb79-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">n</span>(), </span>
<span id="cb79-265"><a href="#cb79-265" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg =</span> <span class="fu">mean</span>(people)</span>
<span id="cb79-266"><a href="#cb79-266" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb79-267"><a href="#cb79-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-268"><a href="#cb79-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-269"><a href="#cb79-269" aria-hidden="true" tabindex="-1"></a><span class="in">`group_by()`</span></span>
<span id="cb79-270"><a href="#cb79-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-271"><a href="#cb79-271" aria-hidden="true" tabindex="-1"></a>We obtain the wind group-wise summaries below:</span>
<span id="cb79-272"><a href="#cb79-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-275"><a href="#cb79-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-276"><a href="#cb79-276" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb79-277"><a href="#cb79-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind) <span class="sc">|&gt;</span> </span>
<span id="cb79-278"><a href="#cb79-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total=</span><span class="fu">n</span>(), </span>
<span id="cb79-279"><a href="#cb79-279" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg=</span><span class="fu">mean</span>(people))</span>
<span id="cb79-280"><a href="#cb79-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-281"><a href="#cb79-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-282"><a href="#cb79-282" aria-hidden="true" tabindex="-1"></a>There are many more commands such as the <span class="in">`transmute`</span> function which</span>
<span id="cb79-283"><a href="#cb79-283" aria-hidden="true" tabindex="-1"></a>conserves the only the needed columns. Try</span>
<span id="cb79-284"><a href="#cb79-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-287"><a href="#cb79-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-288"><a href="#cb79-288" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb79-289"><a href="#cb79-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind, w.e) <span class="sc">|&gt;</span> </span>
<span id="cb79-290"><a href="#cb79-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">total=</span><span class="fu">n</span>(), </span>
<span id="cb79-291"><a href="#cb79-291" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg=</span><span class="fu">mean</span>(people))</span>
<span id="cb79-292"><a href="#cb79-292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-293"><a href="#cb79-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-294"><a href="#cb79-294" aria-hidden="true" tabindex="-1"></a>A simple frequency table is found using <span class="in">`count()`</span>. Try-</span>
<span id="cb79-295"><a href="#cb79-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-298"><a href="#cb79-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-299"><a href="#cb79-299" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb79-300"><a href="#cb79-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind, w.e) <span class="sc">|&gt;</span> </span>
<span id="cb79-301"><a href="#cb79-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(temp)</span>
<span id="cb79-302"><a href="#cb79-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-303"><a href="#cb79-303" aria-hidden="true" tabindex="-1"></a>my.data <span class="sc">|&gt;</span> </span>
<span id="cb79-304"><a href="#cb79-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wind, w.e) <span class="sc">|&gt;</span> </span>
<span id="cb79-305"><a href="#cb79-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(temp, river)</span>
<span id="cb79-306"><a href="#cb79-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-307"><a href="#cb79-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-308"><a href="#cb79-308" aria-hidden="true" tabindex="-1"></a>The <span class="in">`count()`</span> is useful to check the balanced nature of the data when</span>
<span id="cb79-309"><a href="#cb79-309" aria-hidden="true" tabindex="-1"></a>many subgroups are involved.</span>
<span id="cb79-310"><a href="#cb79-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-311"><a href="#cb79-311" aria-hidden="true" tabindex="-1"></a>Now let's practice using these functions.</span>
<span id="cb79-312"><a href="#cb79-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-313"><a href="#cb79-313" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exercise 1.2 {-}</span></span>
<span id="cb79-314"><a href="#cb79-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-315"><a href="#cb79-315" aria-hidden="true" tabindex="-1"></a>Using <span class="in">`table1`</span>, compute rate of TB cases per 10,000 and the total cases per year</span>
<span id="cb79-316"><a href="#cb79-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-319"><a href="#cb79-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-320"><a href="#cb79-320" aria-hidden="true" tabindex="-1"></a>table1 <span class="sc">|&gt;</span></span>
<span id="cb79-321"><a href="#cb79-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate =</span> cases <span class="sc">/</span> population <span class="sc">*</span> <span class="dv">10000</span>)</span>
<span id="cb79-322"><a href="#cb79-322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-323"><a href="#cb79-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-326"><a href="#cb79-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-327"><a href="#cb79-327" aria-hidden="true" tabindex="-1"></a>table1 <span class="sc">|&gt;</span> </span>
<span id="cb79-328"><a href="#cb79-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb79-329"><a href="#cb79-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_cases =</span> <span class="fu">sum</span>(cases))</span>
<span id="cb79-330"><a href="#cb79-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-331"><a href="#cb79-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-332"><a href="#cb79-332" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exercise 1.3 {-}</span></span>
<span id="cb79-333"><a href="#cb79-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-334"><a href="#cb79-334" aria-hidden="true" tabindex="-1"></a>For <span class="in">`table2`</span>, write pseudo-code for how you would perform the following actions. Sketch/describe how you would do these. </span>
<span id="cb79-335"><a href="#cb79-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-336"><a href="#cb79-336" aria-hidden="true" tabindex="-1"></a>a) Extract the number of TB cases per country per year.</span>
<span id="cb79-337"><a href="#cb79-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-338"><a href="#cb79-338" aria-hidden="true" tabindex="-1"></a>b) Extract the matching population per country per year.</span>
<span id="cb79-339"><a href="#cb79-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-340"><a href="#cb79-340" aria-hidden="true" tabindex="-1"></a>c) Divide cases by population, and multiply by 10000.</span>
<span id="cb79-341"><a href="#cb79-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-342"><a href="#cb79-342" aria-hidden="true" tabindex="-1"></a>d) Store back in the appropriate place.</span>
<span id="cb79-343"><a href="#cb79-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-344"><a href="#cb79-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-345"><a href="#cb79-345" aria-hidden="true" tabindex="-1"></a><span class="fu"># Dataset *diamonds*</span></span>
<span id="cb79-346"><a href="#cb79-346" aria-hidden="true" tabindex="-1"></a>We will now use the built in dataset on diamond price and measurements for some more exercises. See<span class="in">`?diamonds`</span> more information.</span>
<span id="cb79-347"><a href="#cb79-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-348"><a href="#cb79-348" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exercise 1.4 {-}</span></span>
<span id="cb79-349"><a href="#cb79-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-350"><a href="#cb79-350" aria-hidden="true" tabindex="-1"></a>Outliers are observations that are unusual; data points that don’t seem to fit the pattern. Sometimes outliers are data entry errors, sometimes they are simply values at the extremes that happened to be observed in this data collection, and other times they suggest important new discoveries. </span>
<span id="cb79-351"><a href="#cb79-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-352"><a href="#cb79-352" aria-hidden="true" tabindex="-1"></a>Describe the distribution of the <span class="in">`y`</span> variable from the diamonds dataset.</span>
<span id="cb79-353"><a href="#cb79-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-356"><a href="#cb79-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-357"><a href="#cb79-357" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span></span>
<span id="cb79-358"><a href="#cb79-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> y) <span class="sc">+</span></span>
<span id="cb79-359"><a href="#cb79-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>)</span>
<span id="cb79-360"><a href="#cb79-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-361"><a href="#cb79-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-362"><a href="#cb79-362" aria-hidden="true" tabindex="-1"></a>The only evidence of outliers is the unusually wide limits on the x-axis.</span>
<span id="cb79-363"><a href="#cb79-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-364"><a href="#cb79-364" aria-hidden="true" tabindex="-1"></a>There are so many observations in the common bins that the rare bins are very short, making it very difficult to see them (although maybe if you stare intently at 0 you’ll spot something). We can change the <span class="in">`binwidth=`</span> to help with this. We can also zoom in on the y axis using <span class="in">`coord_cartesian()`</span>.</span>
<span id="cb79-365"><a href="#cb79-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-368"><a href="#cb79-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-369"><a href="#cb79-369" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> </span>
<span id="cb79-370"><a href="#cb79-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> y) <span class="sc">+</span></span>
<span id="cb79-371"><a href="#cb79-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb79-372"><a href="#cb79-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>)) <span class="co"># also has an xlim() option</span></span>
<span id="cb79-373"><a href="#cb79-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-374"><a href="#cb79-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-375"><a href="#cb79-375" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exercise 1.5 {-}</span></span>
<span id="cb79-376"><a href="#cb79-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-377"><a href="#cb79-377" aria-hidden="true" tabindex="-1"></a>Make a new dataset that includes these unusual values using dplyr.</span>
<span id="cb79-378"><a href="#cb79-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-381"><a href="#cb79-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-382"><a href="#cb79-382" aria-hidden="true" tabindex="-1"></a>unusual <span class="ot">&lt;-</span> diamonds <span class="sc">|&gt;</span> </span>
<span id="cb79-383"><a href="#cb79-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&lt;</span> <span class="dv">3</span> <span class="sc">|</span> y <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb79-384"><a href="#cb79-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(price, x, y, z) <span class="sc">|&gt;</span></span>
<span id="cb79-385"><a href="#cb79-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(y)</span>
<span id="cb79-386"><a href="#cb79-386" aria-hidden="true" tabindex="-1"></a>unusual</span>
<span id="cb79-387"><a href="#cb79-387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-388"><a href="#cb79-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-389"><a href="#cb79-389" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exercise 1.6 {-}</span></span>
<span id="cb79-390"><a href="#cb79-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-391"><a href="#cb79-391" aria-hidden="true" tabindex="-1"></a>How many diamonds are 0.99 carat? How many are 1 carat? What do you think is the cause of the difference?</span>
<span id="cb79-392"><a href="#cb79-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-395"><a href="#cb79-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-396"><a href="#cb79-396" aria-hidden="true" tabindex="-1"></a><span class="co"># your code goes here</span></span>
<span id="cb79-397"><a href="#cb79-397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-398"><a href="#cb79-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-399"><a href="#cb79-399" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exercise 1.7 {-}</span></span>
<span id="cb79-400"><a href="#cb79-400" aria-hidden="true" tabindex="-1"></a>What does <span class="in">`na.rm = TRUE`</span> do in mean() and sum()?</span>
<span id="cb79-401"><a href="#cb79-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-404"><a href="#cb79-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-405"><a href="#cb79-405" aria-hidden="true" tabindex="-1"></a><span class="co"># your code goes here</span></span>
<span id="cb79-406"><a href="#cb79-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-407"><a href="#cb79-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-408"><a href="#cb79-408" aria-hidden="true" tabindex="-1"></a><span class="fu"># Tidying data</span></span>
<span id="cb79-409"><a href="#cb79-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-410"><a href="#cb79-410" aria-hidden="true" tabindex="-1"></a>Most real analyses will require at least a little tidying. You’ll begin by figuring out what the underlying variables and observations are. Sometimes this is easy; other times you’ll need to consult with the people who originally generated the data. Next, you’ll pivot your data into a tidy form, with variables in the columns and observations in the rows.</span>
<span id="cb79-411"><a href="#cb79-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-412"><a href="#cb79-412" aria-hidden="true" tabindex="-1"></a>The <span class="in">`billboard`</span> dataset records the billboard rank of songs in the year 2000:</span>
<span id="cb79-413"><a href="#cb79-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-416"><a href="#cb79-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-417"><a href="#cb79-417" aria-hidden="true" tabindex="-1"></a>billboard</span>
<span id="cb79-418"><a href="#cb79-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-419"><a href="#cb79-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-420"><a href="#cb79-420" aria-hidden="true" tabindex="-1"></a>In this dataset, each observation is a song. The first three columns (artist, track and date.entered) are variables that describe the song. Then we have 76 columns (wk1-wk76) that describe the rank of the song in each week. Here, the column names are one variable (the week) and the cell values are another (the rank).</span>
<span id="cb79-421"><a href="#cb79-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-422"><a href="#cb79-422" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exercise 1.8 {-}</span></span>
<span id="cb79-423"><a href="#cb79-423" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`pivot_longer()`</span> to tidy this data</span>
<span id="cb79-424"><a href="#cb79-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-427"><a href="#cb79-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-428"><a href="#cb79-428" aria-hidden="true" tabindex="-1"></a><span class="co"># your code goes here</span></span>
<span id="cb79-429"><a href="#cb79-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-430"><a href="#cb79-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-431"><a href="#cb79-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-432"><a href="#cb79-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-433"><a href="#cb79-433" aria-hidden="true" tabindex="-1"></a><span class="fu">## Combining datasets</span></span>
<span id="cb79-434"><a href="#cb79-434" aria-hidden="true" tabindex="-1"></a>Two tables can be connected through a pair of keys, within each table.</span>
<span id="cb79-435"><a href="#cb79-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-436"><a href="#cb79-436" aria-hidden="true" tabindex="-1"></a>Every join involves a pair of keys: a primary key and a foreign key. A primary key is a variable or set of variables that uniquely identifies each observation. When more than one variable is needed, the key is called a compound key. </span>
<span id="cb79-437"><a href="#cb79-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-438"><a href="#cb79-438" aria-hidden="true" tabindex="-1"></a>There are four types of joins, we will illustrate them using a simple example:</span>
<span id="cb79-439"><a href="#cb79-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-440"><a href="#cb79-440" aria-hidden="true" tabindex="-1"></a>First lets make some data:</span>
<span id="cb79-443"><a href="#cb79-443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-444"><a href="#cb79-444" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">y =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb79-445"><a href="#cb79-445" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">a =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="st">"a"</span>)</span>
<span id="cb79-446"><a href="#cb79-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-447"><a href="#cb79-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-448"><a href="#cb79-448" aria-hidden="true" tabindex="-1"></a>Now join the two datasets using the different join functions:</span>
<span id="cb79-449"><a href="#cb79-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-452"><a href="#cb79-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-453"><a href="#cb79-453" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(df2) </span>
<span id="cb79-454"><a href="#cb79-454" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-455"><a href="#cb79-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-458"><a href="#cb79-458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-459"><a href="#cb79-459" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(df2)</span>
<span id="cb79-460"><a href="#cb79-460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-461"><a href="#cb79-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-464"><a href="#cb79-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-465"><a href="#cb79-465" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">right_join</span>(df2)</span>
<span id="cb79-466"><a href="#cb79-466" aria-hidden="true" tabindex="-1"></a>df2 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(df1)</span>
<span id="cb79-467"><a href="#cb79-467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-468"><a href="#cb79-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-471"><a href="#cb79-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-472"><a href="#cb79-472" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(df2)</span>
<span id="cb79-473"><a href="#cb79-473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-474"><a href="#cb79-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-475"><a href="#cb79-475" aria-hidden="true" tabindex="-1"></a>What are the differences between the join functions?</span>
<span id="cb79-476"><a href="#cb79-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-477"><a href="#cb79-477" aria-hidden="true" tabindex="-1"></a><span class="fu"># Specifying join keys</span></span>
<span id="cb79-478"><a href="#cb79-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-479"><a href="#cb79-479" aria-hidden="true" tabindex="-1"></a>By default, left_join() will use all variables that appear in both data frames as the join key, but it doesn’t always work.</span>
<span id="cb79-480"><a href="#cb79-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-481"><a href="#cb79-481" aria-hidden="true" tabindex="-1"></a>For example lets look at some airline data:</span>
<span id="cb79-482"><a href="#cb79-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-485"><a href="#cb79-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-486"><a href="#cb79-486" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13) <span class="co"># data package</span></span>
<span id="cb79-487"><a href="#cb79-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-488"><a href="#cb79-488" aria-hidden="true" tabindex="-1"></a>flights2 <span class="ot">&lt;-</span> flights <span class="sc">|&gt;</span> </span>
<span id="cb79-489"><a href="#cb79-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, time_hour, origin, dest, tailnum, carrier)</span>
<span id="cb79-490"><a href="#cb79-490" aria-hidden="true" tabindex="-1"></a>flights2</span>
<span id="cb79-491"><a href="#cb79-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-492"><a href="#cb79-492" aria-hidden="true" tabindex="-1"></a>planes</span>
<span id="cb79-493"><a href="#cb79-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-494"><a href="#cb79-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-495"><a href="#cb79-495" aria-hidden="true" tabindex="-1"></a>We are going to try to going flight data to data about types of planes</span>
<span id="cb79-496"><a href="#cb79-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-499"><a href="#cb79-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-500"><a href="#cb79-500" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">|&gt;</span> </span>
<span id="cb79-501"><a href="#cb79-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(planes)</span>
<span id="cb79-502"><a href="#cb79-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-503"><a href="#cb79-503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-504"><a href="#cb79-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-505"><a href="#cb79-505" aria-hidden="true" tabindex="-1"></a>We get a lot of missing matches because our join is trying to use tailnum and year as a compound key. Both flights and planes have a year column but they mean different things: <span class="in">`flights$year`</span> is the year the flight occurred and <span class="in">`planes$year`</span> is the year the plane was built.</span>
<span id="cb79-506"><a href="#cb79-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-507"><a href="#cb79-507" aria-hidden="true" tabindex="-1"></a>Since these represent different types of data and we might want to keep both, we can be explicit about how to join the two data tables:</span>
<span id="cb79-508"><a href="#cb79-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-511"><a href="#cb79-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-512"><a href="#cb79-512" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">|&gt;</span> </span>
<span id="cb79-513"><a href="#cb79-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(planes, <span class="fu">join_by</span>(tailnum))</span>
<span id="cb79-514"><a href="#cb79-514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-515"><a href="#cb79-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-516"><a href="#cb79-516" aria-hidden="true" tabindex="-1"></a>Now by default there is a year.x and year.y coming from the flights and planes data respectively. You can change this using the <span class="in">`suffix`</span> argument in join or by renaming the columns after the join.</span>
<span id="cb79-517"><a href="#cb79-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-518"><a href="#cb79-518" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exercise 1.9 {-}</span></span>
<span id="cb79-519"><a href="#cb79-519" aria-hidden="true" tabindex="-1"></a>Imagine you’ve found the top 10 most popular destinations using this code:</span>
<span id="cb79-522"><a href="#cb79-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-523"><a href="#cb79-523" aria-hidden="true" tabindex="-1"></a>top_dest <span class="ot">&lt;-</span> flights2 <span class="sc">|&gt;</span></span>
<span id="cb79-524"><a href="#cb79-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(dest, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb79-525"><a href="#cb79-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb79-526"><a href="#cb79-526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-527"><a href="#cb79-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-528"><a href="#cb79-528" aria-hidden="true" tabindex="-1"></a>How can you find all flights to those destinations?</span>
<span id="cb79-529"><a href="#cb79-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-532"><a href="#cb79-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-533"><a href="#cb79-533" aria-hidden="true" tabindex="-1"></a><span class="co"># your code goes here</span></span>
<span id="cb79-534"><a href="#cb79-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-535"><a href="#cb79-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-536"><a href="#cb79-536" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exercise 1.10 {-}</span></span>
<span id="cb79-537"><a href="#cb79-537" aria-hidden="true" tabindex="-1"></a>What do the tail numbers that don’t have a matching record in planes have in common? (Hint: one variable explains ~90% of the problems.)</span>
<span id="cb79-538"><a href="#cb79-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-539"><a href="#cb79-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-540"><a href="#cb79-540" aria-hidden="true" tabindex="-1"></a><span class="fu"># case_when()</span></span>
<span id="cb79-541"><a href="#cb79-541" aria-hidden="true" tabindex="-1"></a>Sometimes you want to add a new variable to your data based on existing variables. </span>
<span id="cb79-542"><a href="#cb79-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-543"><a href="#cb79-543" aria-hidden="true" tabindex="-1"></a>dplyr’s case_when() is inspired by SQL’s CASE statement and provides a flexible way of performing different computations for different conditions. It has a special syntax that unfortunately looks like nothing else you’ll use in the tidyverse. It takes pairs that look like condition ~ output. condition must be a logical vector; when it’s TRUE, output will be used.</span>
<span id="cb79-544"><a href="#cb79-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-545"><a href="#cb79-545" aria-hidden="true" tabindex="-1"></a>This can take the place of if_else() statements.</span>
<span id="cb79-546"><a href="#cb79-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-547"><a href="#cb79-547" aria-hidden="true" tabindex="-1"></a>For example:</span>
<span id="cb79-550"><a href="#cb79-550" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-551"><a href="#cb79-551" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb79-552"><a href="#cb79-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb79-553"><a href="#cb79-553" aria-hidden="true" tabindex="-1"></a>    <span class="at">status =</span> <span class="fu">case_when</span>( <span class="co"># make a new variable status based on the flights arrival delay</span></span>
<span id="cb79-554"><a href="#cb79-554" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(arr_delay)      <span class="sc">~</span> <span class="st">"cancelled"</span>,</span>
<span id="cb79-555"><a href="#cb79-555" aria-hidden="true" tabindex="-1"></a>      arr_delay <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">30</span>       <span class="sc">~</span> <span class="st">"very early"</span>,</span>
<span id="cb79-556"><a href="#cb79-556" aria-hidden="true" tabindex="-1"></a>      arr_delay <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">15</span>       <span class="sc">~</span> <span class="st">"early"</span>,</span>
<span id="cb79-557"><a href="#cb79-557" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>(arr_delay) <span class="sc">&lt;=</span> <span class="dv">15</span>  <span class="sc">~</span> <span class="st">"on time"</span>,</span>
<span id="cb79-558"><a href="#cb79-558" aria-hidden="true" tabindex="-1"></a>      arr_delay <span class="sc">&lt;</span> <span class="dv">60</span>        <span class="sc">~</span> <span class="st">"late"</span>,</span>
<span id="cb79-559"><a href="#cb79-559" aria-hidden="true" tabindex="-1"></a>      arr_delay <span class="sc">&lt;</span> <span class="cn">Inf</span>       <span class="sc">~</span> <span class="st">"very late"</span>,</span>
<span id="cb79-560"><a href="#cb79-560" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb79-561"><a href="#cb79-561" aria-hidden="true" tabindex="-1"></a>    <span class="at">.keep =</span> <span class="st">"used"</span></span>
<span id="cb79-562"><a href="#cb79-562" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-563"><a href="#cb79-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-564"><a href="#cb79-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-565"><a href="#cb79-565" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exercise 1.11 {-}</span></span>
<span id="cb79-566"><a href="#cb79-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-567"><a href="#cb79-567" aria-hidden="true" tabindex="-1"></a>Write a case_when() statement that uses the month and day columns from flights to label a selection of important US holidays (e.g., New Years Day, 4th of July, Thanksgiving, and Christmas). First create a logical column that is either TRUE or FALSE, and then create a character column that either gives the name of the holiday or is NA.</span>
<span id="cb79-568"><a href="#cb79-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-571"><a href="#cb79-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-572"><a href="#cb79-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>