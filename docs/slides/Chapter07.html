<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.353">

  <title>161250 Data Analysis - Chapter 7:Models with Multiple Predictors</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Chapter 7:<br>Models with Multiple Predictors</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="learning-objectives" class="slide level2">
<h2>Learning Objectives:</h2>
<ul>
<li>Understand and describe a multiple linear regression, the difference from a simple linear regression, and when each are appropriate</li>
<li>Fit and display a multiple regression</li>
<li>Understand and interpret different types of Sums of Squares</li>
<li>Understand and test for multicollinearity and other assumptions</li>
</ul>
</section>
<section id="what-is-a-multiple-regression" class="slide level2">
<h2>What is a multiple Regression?</h2>
<ul>
<li>In a simple regression, there is only one predictor.</li>
<li>Multiple regression modelling involves many predictors.</li>
</ul>
</section>
<section id="when-to-use-multiple-predictors" class="slide level2">
<h2>When to use multiple predictors</h2>
<ul>
<li><p><em>Statistical control of a confound</em>: controlling treatment for some unwanted variability</p></li>
<li><p><em>Multiple causation</em>: multiple things are thought to cause changes in the outcome variable</p></li>
<li><p><em>Interactions</em>: we are interested in how two variables may combine to change our outcome (will cover this in the next chapter)</p></li>
</ul>
</section>
<section id="multiple-regression" class="slide level2">
<h2>Multiple Regression</h2>
<p>Where to start:</p>
<ul>
<li><p>Question and hypothesis + domain knowledge</p>
<ul>
<li>What are we interested in testing?</li>
<li>What data is collected? do those variables make sense?</li>
<li>What kind of data are my response and predictor variables?</li>
</ul></li>
<li><p>Perform EDA first</p>
<ul>
<li>A scatter plot matrix can show nonlinear relationships</li>
<li>A correlation matrix will only show the strength of pairwise linear relationships</li>
</ul></li>
<li><p>Look for the predictors having the largest correlation with response</p>
<ul>
<li>Look for inter-correlations between the predictors and choose the one with high correlation with response variable but uncorrelated with the rest.</li>
</ul></li>
</ul>
</section>
<section id="data-example" class="slide level2">
<h2>Data example</h2>
<p>Basketball team summary for 2020 regular season<br>
</p>
<p>We have 2118 data points which equates to 1059 games (2 teams per game), 2020 was a short season</p>
<p>Each team in a standard season plays 82 games. That means in total, an NBA season is comprised of 1,230 games.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>  Team     Game Spread Outcome MIN PTS       P2p       P3p       FTp OREB DREB
1  ATL 21900014     17       W  48 117 0.6000000 0.3548387 0.8571429    8   34
2  ATL 21900028      4       W  48 103 0.6296296 0.3000000 0.5333333    9   43
3  ATL 21900043     -2       L  48 103 0.4736842 0.3333333 0.6875000    8   37
4  ATL 21900052    -15       L  48  97 0.5454545 0.2820513 0.6666667    9   24
5  ATL 21900066     -9       L  48  97 0.5370370 0.2058824 0.6923077   16   34
6  ATL 21900099      8       W  48 108 0.5333333 0.3666667 0.6875000    9   39
  AST TOV STL BLK PF
1  27  13   9   2 15
2  22  18   5   9 26
3  23  21  12   3 25
4  28  20  14   7 29
5  20  16   5   5 15
6  22  18   9   5 20</code></pre>
</div>
</div>
<p><code>Spread</code>: Point difference between winning and losing team<br>
<code>PTS</code>: Total points scored by a team in a game<br>
<code>P2p</code>: Percent of 2-pointers made<br>
<code>P3p</code>: Percent of 3-pointers made<br>
<code>FTp</code>: Percent of free-throws made<br>
<code>OREB</code>: Offensive rebounds<br>
<code>DREB</code>: Defensive rebounds<br>
<code>AST</code>: Assists<br>
<code>STL</code>: Steals<br>
<code>BLK</code>: Blocks<br>
</p>
</section>
<section id="data-example-1" class="slide level2">
<h2>Data example</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">cor</span>(teams[,<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">12</span>, <span class="dv">14</span><span class="sc">:</span><span class="dv">15</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Spread     PTS      P2p      P3p     FTp     OREB     DREB     AST
Spread  1.0000  0.5730  0.36338  0.42719  0.1063 -0.00240  0.46470  0.3477
PTS     0.5730  1.0000  0.48713  0.55094  0.1897 -0.01487  0.14131  0.5103
P2p     0.3634  0.4871  1.00000 -0.00601 -0.0105 -0.28585  0.02484  0.3633
P3p     0.4272  0.5509 -0.00601  1.00000  0.0297 -0.18736  0.00164  0.4054
FTp     0.1063  0.1897 -0.01053  0.02967  1.0000 -0.08960 -0.01724 -0.0297
OREB   -0.0024 -0.0149 -0.28585 -0.18736 -0.0896  1.00000  0.03882 -0.0996
DREB    0.4647  0.1413  0.02484  0.00164 -0.0172  0.03882  1.00000  0.0468
AST     0.3477  0.5103  0.36333  0.40540 -0.0297 -0.09960  0.04681  1.0000
STL     0.1246  0.0352  0.01897 -0.04479  0.0115 -0.00389 -0.18027  0.0518
BLK     0.1837  0.0623  0.03757  0.00540 -0.0185  0.00311  0.20700  0.0411
            STL      BLK
Spread  0.12460  0.18367
PTS     0.03525  0.06234
P2p     0.01897  0.03757
P3p    -0.04479  0.00540
FTp     0.01153 -0.01849
OREB   -0.00389  0.00311
DREB   -0.18027  0.20700
AST     0.05178  0.04112
STL     1.00000  0.03267
BLK     0.03267  1.00000</code></pre>
</div>
</div>
</section>
<section id="inter-relationships" class="slide level2">
<h2>Inter-relationships</h2>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="full-regression-in-r" class="slide level2">
<h2>Full regression in R</h2>
<p>Places all of the predictors in the model</p>
<p>Equivalent of throwing everything in and hoping something sticks</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Spread ~ ., data = teams_forlm)

Residuals:
   Min     1Q Median     3Q    Max 
-32.29  -5.72  -0.15   5.66  30.36 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -142.4223     2.8728  -49.58  &lt; 2e-16 ***
PTS            0.0624     0.0269    2.32     0.02 *  
P2p           74.1170     3.8391   19.31  &lt; 2e-16 ***
P3p           74.0109     3.3449   22.13  &lt; 2e-16 ***
FTp           15.4686     2.0265    7.63  3.4e-14 ***
OREB           0.7191     0.0623   11.54  &lt; 2e-16 ***
DREB           1.2033     0.0367   32.81  &lt; 2e-16 ***
AST           -0.0350     0.0479   -0.73     0.47    
STL            1.0685     0.0677   15.79  &lt; 2e-16 ***
BLK            0.3503     0.0784    4.47  8.2e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.79 on 2108 degrees of freedom
Multiple R-squared:  0.622, Adjusted R-squared:  0.62 
F-statistic:  385 on 9 and 2108 DF,  p-value: &lt;2e-16</code></pre>
</div>
</div>
</section>
<section id="residuals" class="slide level2">
<h2>Residuals</h2>
<p>Just like with a simple regression we examine residuals to look for patterns</p>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch quarto-figure-center"><p>These look great, probably because we have a ton of data in this example.</p>
</section>
<section id="multicollinearity" class="slide level2 increment">
<h2>Multicollinearity</h2>
<ul>
<li><p><em>Multicollinearity</em> is where at least two predictor variables are highly correlated.</p></li>
<li><p>Multicollinearity does <em>not</em> affect the residual SD very much, and doesn’t pose a major problem for prediction.</p></li>
<li><p>The major effects of multicollinearity are:</p>
<ul>
<li>It changes the estimates of the coefficients.</li>
<li>It inflates the variance of the estimates of the coefficients. That is, it increases the uncertainty about what the slope parameters are.</li>
<li>Therefore, it matters when testing hypotheses about the effects of specific predictors.</li>
</ul></li>
</ul>
</section>
<section id="multicollinearity-1" class="slide level2">
<h2>Multicollinearity</h2>
<ul>
<li><p>The impact of multicollinearity on the variance of the estimates can be quantified using the Variance Inflation Factor (VIF &lt; 5 is considered ok).</p></li>
<li><p>There are several ways to deal with multicollinarity, depending on context. We can discard one of highly correlated variable, perform ridge regression, or think more carefully about how the variables relate to each other.</p></li>
</ul>
</section>
<section id="multicollinearity-2" class="slide level2">
<h2>Multicollinearity</h2>
<p>In R we can examine Multicollinearity using the function <code>vif()</code></p>
<p>Remember our basketball regression:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(car)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">vif</span>(full_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> PTS  P2p  P3p  FTp OREB DREB  AST  STL  BLK 
3.07 2.14 2.24 1.14 1.37 1.14 1.50 1.06 1.05 </code></pre>
</div>
</div>
<p>These values are all small (VIF &lt; 5) so we can continue on in interpreting the regression.</p>
</section>
<section id="tidy-summary" class="slide level2">
<h2>Tidy summary</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="lightable-classic" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>t-tests for model parameters</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-142.422</td>
<td style="text-align: right;">2.873</td>
<td style="text-align: right;">-49.575</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PTS</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">2.320</td>
<td style="text-align: right;">0.020</td>
</tr>
<tr class="odd">
<td style="text-align: left;">P2p</td>
<td style="text-align: right;">74.117</td>
<td style="text-align: right;">3.839</td>
<td style="text-align: right;">19.306</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">P3p</td>
<td style="text-align: right;">74.011</td>
<td style="text-align: right;">3.345</td>
<td style="text-align: right;">22.126</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FTp</td>
<td style="text-align: right;">15.469</td>
<td style="text-align: right;">2.027</td>
<td style="text-align: right;">7.633</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">OREB</td>
<td style="text-align: right;">0.719</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">11.538</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DREB</td>
<td style="text-align: right;">1.203</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">32.809</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">AST</td>
<td style="text-align: right;">-0.035</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">-0.729</td>
<td style="text-align: right;">0.466</td>
</tr>
<tr class="odd">
<td style="text-align: left;">STL</td>
<td style="text-align: right;">1.069</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">15.785</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">BLK</td>
<td style="text-align: right;">0.350</td>
<td style="text-align: right;">0.078</td>
<td style="text-align: right;">4.470</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="variance-explained-review-from-chapter-6" class="slide level2">
<h2>Variance Explained (Review from Chapter 6)</h2>
<p><span class="math inline">\(R^2\)</span> is the proportion of variance in <span class="math inline">\(y\)</span> explained by <span class="math inline">\(x\)</span> .</p>
<p><span class="math inline">\(R^2=\frac{SS~regression}{SS~Total}\)</span></p>
<ul>
<li><p><span class="math inline">\(R^2_{adj}\)</span> is adjusted to remove the variation that is explained by chance alone</p></li>
<li><p><span class="math inline">\(R^2_{adj}=1-\frac{MS~Error}{MS~Total}\)</span><br>
<span class="math inline">\(R^2_{adj}\)</span> can also be written as: <span class="math inline">\(R^2_{adj}=1-\frac{(1-R^2)*(n-1)}{(n-k-1)}\)</span></p></li>
<li><p>Now we have more sums of square to add in to our regression</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>SS <span class="ot">&lt;-</span> <span class="fu">anova</span>(full_reg) <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>   <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">select</span>(term<span class="sc">:</span>sumsq) <span class="sc">|&gt;</span> </span>
<span id="cb7-4"><a href="#cb7-4"></a>  janitor<span class="sc">::</span><span class="fu">adorn_totals</span>()</span>
<span id="cb7-5"><a href="#cb7-5"></a>SS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      term   df    sumsq
       PTS    1 141194.6
       P2p    1   4001.7
       P3p    1  14465.4
       FTp    1    583.8
      OREB    1   7082.2
      DREB    1  78359.3
       AST    1     10.1
       STL    1  20082.0
       BLK    1   1542.2
 Residuals 2108 162702.8
     Total 2117 430024.0</code></pre>
</div>
</div>
</section>
<section id="additional-variation-explained" class="slide level2">
<h2>Additional variation explained</h2>
<ul>
<li><p>Variation in <span class="math inline">\(Y\)</span> is separated into two parts SSR and SSE.</p>
<ul>
<li>The shaded overlap of two circles represent the variation in <span class="math inline">\(Y\)</span> explained by the <span class="math inline">\(X\)</span> variables.</li>
</ul></li>
<li><p>The total overlap of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>, and <span class="math inline">\(Y\)</span> depends on</p>
<ul>
<li>relationship of <span class="math inline">\(Y\)</span> with <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span></li>
<li>correlation between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span></li>
</ul>
<p><img data-src="img/5_5.png"></p></li>
</ul>
</section>
<section id="sequential-addition-of-predictors" class="slide level2">
<h2>Sequential addition of predictors</h2>
<ul>
<li>Addition of variables decreases SSE and increases SSR and <span class="math inline">\(R^2\)</span>.</li>
<li><span class="math inline">\(s^2\)</span> = MSE = SSE/df decreases to a minimum and then increases since addition of variable decreases SSE but adds to df.</li>
</ul>

<img data-src="img/5_7.png" class="r-stretch"></section>
<section id="significance-of-type-i-or-seq.ss" class="slide level2">
<h2>Significance of Type I or Seq.SS</h2>
<ul>
<li><p>The Type I SS is the SS of a predictor after adjusting for the effects of the <em>preceding</em> predictors in the model.</p>
<ul>
<li>Sometimes order matters, particularly with unequal sample sizes</li>
</ul></li>
<li><p>For unbalanced data, this approach tests for a difference in the weighted marginal means. In practical terms, this means that the results are dependent on the realized sample sizes. In other words, it is testing the first factor without controlling for the other factor, which may not be the hypothesis of interest.</p></li>
<li><p>F test for the significance of the additional variation explained</p></li>
<li><p>R function <code>anova()</code> calculates sequential or Type-I SS</p></li>
</ul>

<img data-src="img/type1.png" class="r-stretch"></section>
<section id="type-ii" class="slide level2">
<h2>Type II</h2>
<ul>
<li><p>Type II SS is based on the principle of marginality.</p>
<ul>
<li>Each variable effect is adjusted for all other appropriate effects.
<ul>
<li>equivalent to the Type I SS when the variable is the last predictor entered the model.</li>
</ul></li>
<li>Order matters for Type I SS but not for Type II SS</li>
</ul></li>
</ul>

<img data-src="img/type2.png" class="r-stretch"></section>
<section id="type-iii-ss" class="slide level2">
<h2>Type III SS</h2>
<ul>
<li><p>Type III SS is the SS added to the regression SS after <em>ALL</em> other predictors including an interaction term.</p></li>
<li><p>This type tests for the presence of a main effect after other main effects and interaction. This approach is therefore valid in the presence of significant interactions.</p></li>
<li><p>If the interaction is significant SS for main effects should not be interpreted</p></li>
</ul>
</section>
<section id="ss-types-in-action" class="slide level2">
<h2>SS types in action</h2>
<p>Consider a model with terms A and B:</p>
<p>Type 1 SS:<br>
SS(A) for factor A.<br>
SS(B | A) for factor B.</p>
<p>Type 2 SS:<br>
SS(A | B) for factor A.<br>
SS(B | A) for factor B.</p>
<p>Type 3 SS:<br>
SS(A | B, AB) for factor A.<br>
SS(B | A, AB) for factor B.</p>
<ul>
<li><p>When data are balanced and the design is simple, types I, II, and III will give the same results.</p></li>
<li><p>SS explained is not always a good criterion for selection of variables</p></li>
</ul>
</section>
<section id="ss-types-in-action-1" class="slide level2">
<h2>SS types in action</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">anova</span>(full_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Spread
            Df Sum Sq Mean Sq F value  Pr(&gt;F)    
PTS          1 141195  141195 1829.34 &lt; 2e-16 ***
P2p          1   4002    4002   51.85 8.3e-13 ***
P3p          1  14465   14465  187.42 &lt; 2e-16 ***
FTp          1    584     584    7.56   0.006 ** 
OREB         1   7082    7082   91.76 &lt; 2e-16 ***
DREB         1  78359   78359 1015.23 &lt; 2e-16 ***
AST          1     10      10    0.13   0.718    
STL          1  20082   20082  260.18 &lt; 2e-16 ***
BLK          1   1542    1542   19.98 8.2e-06 ***
Residuals 2108 162703      77                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">library</span>(car)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">Anova</span>(full_reg,  <span class="at">type=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: Spread
          Sum Sq   Df F value  Pr(&gt;F)    
PTS          416    1    5.38    0.02 *  
P2p        28767    1  372.71 &lt; 2e-16 ***
P3p        37787    1  489.57 &lt; 2e-16 ***
FTp         4497    1   58.26 3.4e-14 ***
OREB       10276    1  133.13 &lt; 2e-16 ***
DREB       83083    1 1076.43 &lt; 2e-16 ***
AST           41    1    0.53    0.47    
STL        19232    1  249.17 &lt; 2e-16 ***
BLK         1542    1   19.98 8.2e-06 ***
Residuals 162703 2108                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">Anova</span>(full_reg,  <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: Spread
            Sum Sq   Df F value  Pr(&gt;F)    
(Intercept) 189696    1 2457.72 &lt; 2e-16 ***
PTS            416    1    5.38    0.02 *  
P2p          28767    1  372.71 &lt; 2e-16 ***
P3p          37787    1  489.57 &lt; 2e-16 ***
FTp           4497    1   58.26 3.4e-14 ***
OREB         10276    1  133.13 &lt; 2e-16 ***
DREB         83083    1 1076.43 &lt; 2e-16 ***
AST             41    1    0.53    0.47    
STL          19232    1  249.17 &lt; 2e-16 ***
BLK           1542    1   19.98 8.2e-06 ***
Residuals   162703 2108                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="summary-so-far" class="slide level2">
<h2>Summary so far</h2>
<ul>
<li>Defined multiple regression</li>
<li>Why we might run a multiple regression</li>
<li>How to perform a multiple regression, examine residuals, multicollinearity</li>
<li>Variation and R squared</li>
<li>Sums of Squares types</li>
</ul>
</section>
<section id="learning-objectives-1" class="slide level2">
<h2>Learning Objectives:</h2>
<ul>
<li>Cautionary tales: when correlation misleads us</li>
<li>How to make models</li>
<li>Comparing models</li>
<li>Principles of model selection</li>
</ul>
</section>
<section id="does-waffle-houses-cause-divorce" class="slide level2">
<h2>Does Waffle Houses cause divorce??</h2>

<img data-src="img/waffleH2divorce.png" class="r-stretch"></section>
<section id="or-is-it-butter" class="slide level2">
<h2>Or is it butter?</h2>

<img data-src="img/Divorce_margarine.png" class="r-stretch"><p>And if you want more to impress your friends at a BBQ, the source is: http://www.tylervigen.com/spurious-correlations</p>
</section>
<section id="spurious-association" class="slide level2">
<h2>Spurious association</h2>
<ul>
<li>You’ve heard that before: correlation does not imply causation. BUT it doesn’t discard it either</li>
<li>Hope you are seated: causation does not imply correlation.</li>
<li>Causation implies conditional correlation (up to linearity issues).</li>
<li>We need more than just statistical models to answer causal questions.</li>
</ul>
</section>
<section id="how-do-we-deal-with-spurious-associations" class="slide level2">
<h2>How do we deal with spurious associations?</h2>
<ul>
<li><p>Domain knowledge: you know that waffles and butter don’t <em>cause</em> divorce so why might they be correlated?</p>
<ul>
<li>Is there another predictor that would be better?</li>
</ul></li>
<li><p>Multiple regressions can disentangle the association between two predictors and an outcome</p>
<ul>
<li>Statistical control of a confound</li>
</ul></li>
</ul>

<img data-src="img/waffleH2divorce.png" class="r-stretch"></section>
<section id="masked-associations" class="slide level2">
<h2>Masked associations</h2>
<ul>
<li>Association between a predictor variable and an outcome can be masked by another variable.</li>
<li>You need to observe both variables to see the “true” influence of either on the outcome.</li>
<li>How do we account for the masking variable (seen as a nuisance)?</li>
</ul>
</section>
<section id="masking-situations-tend-to-arise-when" class="slide level2">
<h2>Masking situations tend to arise when:</h2>
<ul>
<li>Both predictors are associated with one another.</li>
<li>Have opposite relationships with the outcome.</li>
</ul>

<img data-src="img/venetian-mask.jpg" class="r-stretch"></section>
<section id="headline-higher-ice-cream-sales-increase-shark-attacks" class="slide level2">
<h2>Headline: Higher ice cream sales increase shark attacks!</h2>
<p>We’ll predict ice cream sales from the temperature and the number of shark attacks</p>

<img data-src="img/ice-cream-shark.jpeg" class="r-stretch"></section>
<section id="first-we-will-consider-simple-regressions" class="slide level2">
<h2>First we will consider simple regressions</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-14-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-15-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="single-regression" class="slide level2">
<h2>Single regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="lightable-classic" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Temperature Only</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">temp</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
<div class="cell-output-display">
<table class="lightable-classic" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Shark Only</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.083</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">shark</td>
<td style="text-align: right;">0.557</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: right;">6.64</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="multiple-regression-1" class="slide level2">
<h2>Multiple regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="lightable-classic" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Temperature Only</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">temp</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
<div class="cell-output-display">
<table class="lightable-classic" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Shark Only</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.083</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">shark</td>
<td style="text-align: right;">0.557</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: right;">6.64</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
<div class="cell-output-display">
<table class="lightable-classic" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Temperature and Sharks</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">temp</td>
<td style="text-align: right;">0.776</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">8.217</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">shark</td>
<td style="text-align: right;">-0.008</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">-0.084</td>
<td style="text-align: right;">0.933</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="masking-situation" class="slide level2">
<h2>Masking situation</h2>
<p>Tend to arise when</p>
<ul>
<li>Both predictors are associated with one another.</li>
<li>Have different relationships with the outcome</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter07_files/figure-revealjs/icecream pairs-1.png" style="width:95.0%;height:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="how-do-we-deal-with-this" class="slide level2">
<h2>How do we deal with this?</h2>
<ul>
<li>Statistically there is not really an answer</li>
<li>The answer lies in the causes and the causes are not in the data; Shark attacks dont cause ice cream sales or vice versa</li>
<li>Remember that interpreting the (regression) parameter estimates always depends upon what you believe the causal model</li>
</ul>
</section>
<section id="model-selection" class="slide level2">
<h2>Model Selection</h2>
<ul>
<li>The first step before selection of the best subset of predictors is to study the correlation matrix</li>
<li>We then perform stepwise additions (forward) or subtractions (backward) from the model and compare them</li>
</ul>
<p>BUT…</p>
<ul>
<li>We saw with the illustration of SS how the significance or otherwise of a variable in a multiple regression model depends on the other variables in the model</li>
<li>Therefore, we cannot fully rely on the t-test and discard a variable because its coefficient is insignificant</li>
</ul>
</section>
<section id="selection-of-predictors" class="slide level2">
<h2>Selection of predictors</h2>
<ul>
<li>Heuristic (short-cut) procedures based on criteria such as <span class="math inline">\(F\)</span>, <span class="math inline">\(R^2_{adj}\)</span>, <span class="math inline">\(AIC\)</span>, <span class="math inline">\(C_p\)</span> etc
<ul>
<li><p><code>Forward Selection</code>: Add variables sequentially</p>
<ul>
<li>convenient to obtain the simplest feasible model</li>
</ul></li>
<li><p><code>Backward Elimination</code>: Drop variables sequentially</p>
<ul>
<li><p>If difference between two variables is significant but not the variables themselves, forward regression would obtain the wrong model since both may not enter the model.</p>
<ul>
<li>Known as <em>suppressor</em> variables case (like masking variables discussed earlier)</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p>Example: (try)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1, data = suppressor)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.1691 -0.6791 -0.0033  0.6441  1.1299 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 11.98876    1.26689    9.46  3.4e-07 ***
x1           0.00375    0.41608    0.01     0.99    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.832 on 13 degrees of freedom
Multiple R-squared:  6.24e-06,  Adjusted R-squared:  -0.0769 
F-statistic: 8.11e-05 on 1 and 13 DF,  p-value: 0.993</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x2, data = suppressor)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.0900 -0.6334  0.0002  0.6146  1.0403 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   10.632      0.811   13.11  7.2e-09 ***
x2             0.195      0.113    1.74     0.11    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.75 on 13 degrees of freedom
Multiple R-squared:  0.188, Adjusted R-squared:  0.126 
F-statistic: 3.02 on 1 and 13 DF,  p-value: 0.106</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2, data = suppressor)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.01363 -0.00945 -0.00228  0.00863  0.01632 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -4.51541    0.06114   -73.8   &lt;2e-16 ***
x1           3.09701    0.01227   252.3   &lt;2e-16 ***
x2           1.03186    0.00368   280.1   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.0107 on 12 degrees of freedom
Multiple R-squared:     1,  Adjusted R-squared:     1 
F-statistic: 3.92e+04 on 2 and 12 DF,  p-value: &lt;2e-16</code></pre>
</div>
</div>
</section>
<section id="ockhams-razor" class="slide level2">
<h2>Ockham’s razor</h2>
<p><em>Nunca ponenda est pluralitas sine necesitate</em><br>
(Plurality should never be posited without necessity)</p>
<ul>
<li>Problem: fit to sample always (*multi-level models can be counter-examples) improves as we add parameters.</li>
<li>Dangers of “stargazing”: selecting variables with low p-values (aka ‘lots of stars’). P-values are not designed to cope with over-/under-fitting.</li>
</ul>
</section>
<section id="overfitting" class="slide level2">
<h2>Overfitting</h2>
<ul>
<li>Overfitting learning too much from the data, where you are almost just connecting the points rather than estimating.</li>
<li>Underfitting is the opposite, i.e.&nbsp;being insensitive to the data.</li>
<li>aka Models with fewer assumptions are to be preferred.</li>
<li>In practice, we have to choose between models that differ both in accuracy and simplicity. The razor is not really a useful guidance for this trade off.</li>
</ul>
<p>We need tools</p>
</section>
<section id="all-possible-models" class="slide level2">
<h2>All possible models:</h2>
<p>An exhaustive screening of all possible regression models can also be done using software</p>
<ul>
<li><code>Best Subsets</code>: Stop at each step and check whether predictors, in the model or outside, are the best combination for that step.<br>

<ul>
<li>time consuming to perform when the predictor set is large</li>
</ul></li>
</ul>
<p>Remember permutations</p>
<p>For example:</p>
<p>If we fix the number of predictors as 3, then 20 regression models are possible<br>
</p>
</section>
<section id="what-criteria-do-we-use" class="slide level2">
<h2>What criteria do we use?</h2>
<p>Multiple options<br>
- R squared<br>
- Sums of squared (different types, for testing predictor significance)<br>
- Information criteria (AIC, BIC etc)<br>
- For prediction: MSD/MSE, MAD, MAPE<br>
- <span class="math inline">\(C_p\)</span><br>
</p>
<p>Remember its about balance and what you are looking for (fit vs prediction, complexity vs generality)<br>
</p>
<ul>
<li><p><strong><code>Note</code></strong></p>
<ul>
<li>If a model stands out, it will perform well in terms of all summary measures.</li>
<li>If a model does not stand out, summary measures will contradict.</li>
</ul></li>
</ul>
</section>
<section id="when-r2-becomes-absurd" class="slide level2">
<h2>When <span class="math inline">\(R^2\)</span> becomes absurd</h2>

<img data-src="img/brain_homin_R2ter.png" class="r-stretch"></section>
<section id="model-selection-1" class="slide level2">
<h2>Model selection</h2>
<ul>
<li><p>Residual SD depends on its degrees of freedom</p>
<ul>
<li>So comparison of models based on Residual SD is not fully fair</li>
</ul></li>
<li><p>The following three measures are popular prediction modelling and similar to residual SD</p></li>
<li><p>Mean Squared Deviation (MSD): mean of the squared errors (i.e., deviations) (also called MSE)</p></li>
</ul>
<p><span class="math display">\[\frac{\sum \left({\rm observation-fit}\right)^{{\rm 2}} }{{\rm number~of~ observations}}\]</span></p>
<ul>
<li>Mean Absolute Deviation (MAD)</li>
</ul>
<p><span class="math display">\[\frac{\sum \left|{\rm observation-fit}\right| }{{\rm number~of~observations}}\]</span></p>
<ul>
<li>Mean Absolute Percentage Error (MAPE)</li>
</ul>
<p><span class="math display">\[\frac{\sum \frac{\left|{\rm observation-fit}\right|}{{\rm observation}} }{{\rm number~of~observations}} {\times100}\]</span></p>
</section>
<section id="model-selection-continued" class="slide level2">
<h2>Model selection (continued)</h2>
<ul>
<li><p>Avoid over-fitting.</p></li>
<li><p>So place a penalty for excessive model parameters</p></li>
<li><p>Akaike Information Criterion (AIC; <em>smaller is better</em>)</p></li>
</ul>
<p><span class="math display">\[AIC  =  n\log \left(\frac{SSE}{n} \right) + 2p\]</span> - Bayesian Information Criterion (BIC) places a higher penalty that depends on, the number of observations.</p>
<ul>
<li><p>As a result BIC fares well for selecting a model that explains the relationships well while AIC fares well when selecting a model for prediction purposes.</p></li>
<li><p>Other variations: WAIC, AICc, etc (we will not cover them)</p></li>
</ul>
</section>
<section id="software" class="slide level2">
<h2>Software</h2>
<ul>
<li><p>In <span class="math inline">\(R\)</span>, <code>lm()</code> and <code>step()</code> function will perform the tasks</p>
<ul>
<li><code>leaps()</code> and <code>HH</code> packages contain additional functions</li>
<li><code>dredge()</code> in <code>MuMIn</code> will produce all the subset models given a full model</li>
<li>Also <code>MASS</code>, <code>car</code>, <code>caret</code>, and <code>SignifReg</code> R packages</li>
</ul></li>
<li><p>R base package step-wise selection is based on <span class="math inline">\(AIC\)</span> only.</p></li>
</ul>
</section>
<section id="cross-validation-review-from-chapter-6" class="slide level2">
<h2>Cross validation (review from Chapter 6)</h2>
<p>In sample error vs prediction error</p>
<ul>
<li>For simpler models, increasing the number of parameters improves the fit to the sample.</li>
<li>But it seems to reduce the accuracy of the out-of-sample predictions.</li>
<li>Most accurate models trade off flexibility (complexity) and overfitting</li>
</ul>
<p>General idea: - Leave out some observations. - Train the model on the remaining samples; score on those left out. - Average over many left-out sets to get the out-of-sample (future) accuracy.</p>
</section>
<section id="cross-validated-selection-data-example" class="slide level2">
<h2>Cross validated selection: Data example</h2>
<p>Consider the pinetree data set which contains the circumference measurements of pine trees at four positions (First is bottom)</p>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-19-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="cross-validated-selection" class="slide level2">
<h2>Cross validated selection</h2>
<ul>
<li>Model selection can be done focusing on prediction
<ul>
<li>method = “leapForward” &amp; method = “leapBackward” options</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">library</span>(caret);  <span class="fu">library</span>(leaps)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a>fitControl  <span class="ot">&lt;-</span>  <span class="fu">trainControl</span>(<span class="at">method  =</span>  <span class="st">"repeatedcv"</span>,</span>
<span id="cb18-4"><a href="#cb18-4"></a>                             <span class="at">number  =</span>  <span class="dv">5</span>,  <span class="at">repeats  =</span>  <span class="dv">100</span>)</span>
<span id="cb18-5"><a href="#cb18-5"></a>leapBackwardfit  <span class="ot">&lt;-</span>  <span class="fu">train</span>(Top  <span class="sc">~</span>  .,  <span class="at">data  =</span>  pinetree[, <span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="at">trControl  =</span>  fitControl,  <span class="at">method  =</span>  <span class="st">"leapBackward"</span>)</span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="fu">summary</span>(leapBackwardfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
3 Variables  (and intercept)
       Forced in Forced out
Third      FALSE      FALSE
Second     FALSE      FALSE
First      FALSE      FALSE
1 subsets of each size up to 2
Selection Algorithm: backward
         Third Second First
1  ( 1 ) " "   " "    "*"  
2  ( 1 ) "*"   " "    "*"  </code></pre>
</div>
</div>
</section>
<section id="polynomial-models" class="slide level2">
<h2>Polynomial models</h2>
<ul>
<li>A polynomial model includes the square, cube of predictor variables as additional variables.</li>
<li>High correlation (multicollinearity) between the predictor variables may be a problem in polynomial models, but not always.</li>
</ul>
</section>
<section id="polynomial-models-data-example" class="slide level2">
<h2>Polynomial models: Data example</h2>
<p>We can fit a simple linear regression using the Pine tree data</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>pine1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Top <span class="sc">~</span> First, <span class="at">data =</span> pinetree) </span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="fu">summary</span>(pine1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Top ~ First, data = pinetree)

Residuals:
   Min     1Q Median     3Q    Max 
-2.854 -0.881 -0.195  0.630  3.176 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -6.334      0.765   -8.28  2.1e-11 ***
First          0.763      0.024   31.78  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.29 on 58 degrees of freedom
Multiple R-squared:  0.946, Adjusted R-squared:  0.945 
F-statistic: 1.01e+03 on 1 and 58 DF,  p-value: &lt;2e-16</code></pre>
</div>
</div>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="look-closer" class="slide level2">
<h2>Look closer</h2>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch quarto-figure-center"><p>Looks non-linear</p>
</section>
<section id="polynomial-models-data-example-1" class="slide level2">
<h2>Polynomial models: Data example</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>                                  Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                         44.121      7.039    6.27        0
poly(First, degree = 3, raw = T)1   -3.972      0.695   -5.71        0
poly(First, degree = 3, raw = T)2    0.142      0.022    6.39        0
poly(First, degree = 3, raw = T)3   -0.001      0.000   -5.95        0</code></pre>
</div>
</div>
<pre><code>```         
- For the pinetree example, all the slope coefficients are highly significant for the cubic regression
- Not so for the quadratic regression
```</code></pre>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>                                  Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                           3.85      2.450   1.569    0.122
poly(First, degree = 2, raw = T)1     0.10      0.155   0.646    0.521
poly(First, degree = 2, raw = T)2     0.01      0.002   4.319    0.000</code></pre>
</div>
</div>
<ul>
<li>Raw polynomials do not preserve the coefficient estimates but orthogonal polynomials do.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>                         Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                 17.40      0.146  119.26        0
poly(First, degree = 2)1    41.01      1.130   36.29        0
poly(First, degree = 2)2     4.88      1.130    4.32        0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                 17.40      0.115  151.03        0
poly(First, degree = 3)1    41.01      0.892   45.96        0
poly(First, degree = 3)2     4.88      0.892    5.47        0
poly(First, degree = 3)3    -5.31      0.892   -5.95        0</code></pre>
</div>
</div>
</section>
<section id="residual-diagnostics" class="slide level2">
<h2>Residual diagnostics</h2>
<ul>
<li><p>For multiple regression fits, including polynomial fits, examine the residuals as usual to-</p>
<pre><code>- Validate the model assumptions
- Look for model improvement clues</code></pre></li>
<li><p>Quadratic regression for pinetree data is not satisfactory based on the residual plots shown below:</p></li>
</ul>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-27-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="categorical-predictors" class="slide level2">
<h2>Categorical predictors</h2>
<ul>
<li><p>Models can include categorical predictors such as <strong>Area</strong> in the pinetree dataset</p></li>
<li><p>Make sure that you use the <em>factor()</em> function when numerical codes are assigned to categorical variables.</p></li>
<li><p>Area effect on Top circumference is clear from the following plot</p></li>
</ul>

<img data-src="Chapter07_files/figure-revealjs/unnamed-chunk-28-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="indicator-variables" class="slide level2">
<h2>Indicator variables</h2>
<ul>
<li><p>Factors are employed in a multiple regression using indicator variables which are simply binary variables taking either zero or one</p></li>
<li><p>For for males and females, indicator variables are defined as follows:</p>
<ul>
<li>Indicator variable of males: <span class="math inline">\(~~~~~~~~\begin{array}{cccc} I_{\text {male}} &amp; = &amp; 1 &amp; \text{for males}\\ &amp; &amp; 0&amp; \text{for females} \end{array}\)</span></li>
<li>Indicator variable of females <span class="math inline">\(~~~~~~~~\begin{array}{cccc} I_{\text{female}} &amp; = &amp; 1 &amp; \text{for females}\\ &amp; &amp; 0&amp; \text{for males} \end{array}\)</span></li>
</ul></li>
<li><p>There are three different areas of the forest in the pinetree dataset. So we can define three indicator variables.</p></li>
<li><p>Only two indicator variables are needed because there is only 2 degrees of freedom for the 3 areas.</p></li>
</ul>
</section>
<section id="regression-output" class="slide level2">
<h2>Regression output</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-striped" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Regression of Top Circumference on Area Indicator Variables</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">20.02</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">17.98</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">I2</td>
<td style="text-align: right;">-1.96</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">-1.24</td>
<td style="text-align: right;">0.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I3</td>
<td style="text-align: right;">-5.92</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">-3.76</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody>
</table>


</div>
</div>
<ul>
<li>The y-intercept is the mean of the response for the omitted category
<ul>
<li><code>20.02</code> is the mean Top circumference for the first Area</li>
</ul></li>
<li>slopes are the difference in the mean response
<ul>
<li><code>-1.96</code> is the drop in the mean top circumference in Area 2 when compared to Area 1 (which is not a significant drop)</li>
<li><code>-5.92</code> is the drop in the mean top circumference in Area 3 when compared to Area 1 (which is a highly significant drop)</li>
</ul></li>
</ul>
<p>Analysis of Covariance model employs both numerical and categorical predictors (covered later on).</p>
<ul>
<li>We specifically include the interaction between them</li>
</ul>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li><p>Regression methods aim to fit a model by least squares to explain the variation in the dependent variable <span class="math inline">\(Y\)</span> by fitting explanatory <span class="math inline">\(X\)</span> variables.</p></li>
<li><p>Matrix plots (EDA) and correlation coefficients provide important clues to the interrelationships.</p></li>
<li><p>For building a model, the additional variation explained is important. Summary criterion such as <span class="math inline">\(AIC\)</span> is also useful.</p></li>
<li><p>A model is not judged as the <strong>best</strong> purely on statistical grounds.</p></li>
</ul>
<!-- download.file("http://www.massey.ac.nz/~kgovinda/220exer/Chap5moreexamples.R", destfile="Chap5moreexamples.R") -->
<!-- download.file("https://www.massey.ac.nz/~kgovinda/220exer/chapter-5-exercises.html", destfile="chapter-5-exercises.html") -->
<!-- install.packages("remotes") -->
<!-- remotes::install_github("ricompute/ricomisc") -->
<!-- ricomisc::rstudio_viewer("chapter-4-exercises.html", file_path = NULL) -->


<img src="img/L_Color.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p><a href="https://anhsmith.github.io/161250/slides.html">161250 Data Analysis</a></p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>