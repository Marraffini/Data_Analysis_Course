<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>161250 Data Analysis - Chapter 0: Introduction: R, quarto, tidyverse</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">161250 Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides.html" rel="" target="">
 <span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../studyguide/index.html" rel="" target="">
 <span class="menu-text">Study Guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../workshops/ws01.html" rel="" target="">
 <span class="menu-text">Workshops</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-extra-code" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Extra Code</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-extra-code">    
        <li>
    <a class="dropdown-item" href="../exercises/Chap2more.R" rel="" target="">
 <span class="dropdown-text">Ex2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap3more.R" rel="" target="">
 <span class="dropdown-text">Ex3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap4more.R" rel="" target="">
 <span class="dropdown-text">Ex4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap5more.R" rel="" target="">
 <span class="dropdown-text">Ex5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap6more.R" rel="" target="">
 <span class="dropdown-text">Ex6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap7more.R" rel="" target="">
 <span class="dropdown-text">Ex7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap8more.R" rel="" target="">
 <span class="dropdown-text">Ex8</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#choices-choices-everywhere" id="toc-choices-choices-everywhere" class="nav-link" data-scroll-target="#choices-choices-everywhere">Choices, choices everywhere</a></li>
  <li><a href="#what-is-data-analysis" id="toc-what-is-data-analysis" class="nav-link" data-scroll-target="#what-is-data-analysis">What is data analysis?</a></li>
  <li><a href="#data-analysis" id="toc-data-analysis" class="nav-link" data-scroll-target="#data-analysis">Data Analysis</a></li>
  <li><a href="#types-of-data-analysis" id="toc-types-of-data-analysis" class="nav-link" data-scroll-target="#types-of-data-analysis">Types of data analysis</a></li>
  <li><a href="#getting-started-with-r" id="toc-getting-started-with-r" class="nav-link" data-scroll-target="#getting-started-with-r">Getting started with R</a></li>
  <li><a href="#getting-started-with-r-1" id="toc-getting-started-with-r-1" class="nav-link" data-scroll-target="#getting-started-with-r-1">Getting started with R</a></li>
  <li><a href="#learning-r" id="toc-learning-r" class="nav-link" data-scroll-target="#learning-r">Learning R</a></li>
  <li><a href="#some-r-basics" id="toc-some-r-basics" class="nav-link" data-scroll-target="#some-r-basics">Some <code>R</code> basics</a></li>
  <li><a href="#some-r-basics-1" id="toc-some-r-basics-1" class="nav-link" data-scroll-target="#some-r-basics-1">Some <code>R</code> basics</a></li>
  <li><a href="#r-as-a-calulator" id="toc-r-as-a-calulator" class="nav-link" data-scroll-target="#r-as-a-calulator">R as a calulator</a></li>
  <li><a href="#r-objects-model-syntax-etc." id="toc-r-objects-model-syntax-etc." class="nav-link" data-scroll-target="#r-objects-model-syntax-etc.">R Objects, Model Syntax etc.</a></li>
  <li><a href="#r-objects-model-syntax-etc.-1" id="toc-r-objects-model-syntax-etc.-1" class="nav-link" data-scroll-target="#r-objects-model-syntax-etc.-1">R Objects, Model Syntax etc.</a></li>
  <li><a href="#r-objects-model-syntax-etc.-2" id="toc-r-objects-model-syntax-etc.-2" class="nav-link" data-scroll-target="#r-objects-model-syntax-etc.-2">R Objects, Model Syntax etc.</a></li>
  <li><a href="#r-mathematical-expressions" id="toc-r-mathematical-expressions" class="nav-link" data-scroll-target="#r-mathematical-expressions">R mathematical expressions</a></li>
  <li><a href="#accessing-objects-in-r" id="toc-accessing-objects-in-r" class="nav-link" data-scroll-target="#accessing-objects-in-r">Accessing objects in R</a></li>
  <li><a href="#types-of-data-in-r" id="toc-types-of-data-in-r" class="nav-link" data-scroll-target="#types-of-data-in-r">Types of data in R</a></li>
  <li><a href="#combining-data" id="toc-combining-data" class="nav-link" data-scroll-target="#combining-data">Combining data</a></li>
  <li><a href="#data-frame" id="toc-data-frame" class="nav-link" data-scroll-target="#data-frame">Data frame</a></li>
  <li><a href="#matrices" id="toc-matrices" class="nav-link" data-scroll-target="#matrices">Matrices</a></li>
  <li><a href="#directories" id="toc-directories" class="nav-link" data-scroll-target="#directories">Directories</a></li>
  <li><a href="#directories-1" id="toc-directories-1" class="nav-link" data-scroll-target="#directories-1">Directories</a></li>
  <li><a href="#set-directory-in-r" id="toc-set-directory-in-r" class="nav-link" data-scroll-target="#set-directory-in-r">Set directory in R</a></li>
  <li><a href="#quarto" id="toc-quarto" class="nav-link" data-scroll-target="#quarto">Quarto</a></li>
  <li><a href="#loading-data" id="toc-loading-data" class="nav-link" data-scroll-target="#loading-data">Loading data</a></li>
  <li><a href="#types-of-data-files" id="toc-types-of-data-files" class="nav-link" data-scroll-target="#types-of-data-files">Types of data files</a></li>
  <li><a href="#loading-packages" id="toc-loading-packages" class="nav-link" data-scroll-target="#loading-packages">Loading packages</a></li>
  <li><a href="#welcome-to-the-tidyverse" id="toc-welcome-to-the-tidyverse" class="nav-link" data-scroll-target="#welcome-to-the-tidyverse">Welcome to the tidyverse</a></li>
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data">Tidy data</a></li>
  <li><a href="#why-ensure-that-your-data-is-tidy" id="toc-why-ensure-that-your-data-is-tidy" class="nav-link" data-scroll-target="#why-ensure-that-your-data-is-tidy">Why ensure that your data is tidy?</a></li>
  <li><a href="#summarizing-data" id="toc-summarizing-data" class="nav-link" data-scroll-target="#summarizing-data">Summarizing data</a></li>
  <li><a href="#dplyr" id="toc-dplyr" class="nav-link" data-scroll-target="#dplyr"><code>dplyr</code></a></li>
  <li><a href="#piping" id="toc-piping" class="nav-link" data-scroll-target="#piping">Piping</a></li>
  <li><a href="#graphing-with-ggplot2" id="toc-graphing-with-ggplot2" class="nav-link" data-scroll-target="#graphing-with-ggplot2">Graphing with <code>ggplot2</code></a></li>
  <li><a href="#grammar-of-graphics" id="toc-grammar-of-graphics" class="nav-link" data-scroll-target="#grammar-of-graphics">Grammar of Graphics</a></li>
  <li><a href="#aesthetic-mapping-aes" id="toc-aesthetic-mapping-aes" class="nav-link" data-scroll-target="#aesthetic-mapping-aes">Aesthetic Mapping (<code>aes</code>)</a></li>
  <li><a href="#geometric-objects-geom" id="toc-geometric-objects-geom" class="nav-link" data-scroll-target="#geometric-objects-geom">Geometric Objects (<code>geom</code>)</a></li>
  <li><a href="#tidying-data" id="toc-tidying-data" class="nav-link" data-scroll-target="#tidying-data">Tidying data</a></li>
  <li><a href="#tidying-data-example" id="toc-tidying-data-example" class="nav-link" data-scroll-target="#tidying-data-example">Tidying data example</a></li>
  <li><a href="#tidying-data-example-cont." id="toc-tidying-data-example-cont." class="nav-link" data-scroll-target="#tidying-data-example-cont.">Tidying data example (cont.)</a></li>
  <li><a href="#joining-data" id="toc-joining-data" class="nav-link" data-scroll-target="#joining-data">Joining data</a></li>
  <li><a href="#joining-data-example" id="toc-joining-data-example" class="nav-link" data-scroll-target="#joining-data-example">Joining data: Example</a></li>
  <li><a href="#types-of-join" id="toc-types-of-join" class="nav-link" data-scroll-target="#types-of-join">Types of join</a></li>
  <li><a href="#importance-of-data-quality-control-process" id="toc-importance-of-data-quality-control-process" class="nav-link" data-scroll-target="#importance-of-data-quality-control-process">Importance of Data Quality Control Process</a></li>
  <li><a href="#data-quality" id="toc-data-quality" class="nav-link" data-scroll-target="#data-quality">Data Quality</a></li>
  <li><a href="#data-quality-checks" id="toc-data-quality-checks" class="nav-link" data-scroll-target="#data-quality-checks">Data Quality Checks</a></li>
  <li><a href="#common-data-issues" id="toc-common-data-issues" class="nav-link" data-scroll-target="#common-data-issues">Common data issues</a></li>
  <li><a href="#missing-data" id="toc-missing-data" class="nav-link" data-scroll-target="#missing-data">Missing Data</a></li>
  <li><a href="#data-quality-checks-example" id="toc-data-quality-checks-example" class="nav-link" data-scroll-target="#data-quality-checks-example">Data Quality Checks: Example</a></li>
  <li><a href="#missing-data-1" id="toc-missing-data-1" class="nav-link" data-scroll-target="#missing-data-1">Missing Data</a></li>
  <li><a href="#data-quality-checks-1" id="toc-data-quality-checks-1" class="nav-link" data-scroll-target="#data-quality-checks-1">Data Quality Checks</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Chapter00.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter 0:<br> Introduction: R, quarto, tidyverse</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Why am I in this course?</p>
<p>Why do I need to learn this stuff?</p>
</section>
<section id="choices-choices-everywhere" class="level2">
<h2 class="anchored" data-anchor-id="choices-choices-everywhere">Choices, choices everywhere</h2>
<p>The goal of this course is not to make perfect little replicas of our thinking.</p>
<p>Instead we aim to give you some tools to approach data analysis.</p>
<p>Most of life is not about following instructions; it is about navigating ambiguity.</p>
<p>There is almost always more than one way to do things in this course.</p>
<p>How do I make decisions when things aren’t clear? and is that the way I want to be making them?</p>
</section>
<section id="what-is-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="what-is-data-analysis">What is data analysis?</h2>
<div class="columns">
<div class="column">
<p>Data analysis is the process of inspecting, cleansing, transforming, and modeling data with the goal of discovering useful information, informing conclusions, and supporting decision-making. (wikipedia)</p>
</div><div class="column">
<p><img src="img/data_analysis.jpg" class="img-fluid">{height = 6in}</p>
</div>
</div>
</section>
<section id="data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="data-analysis">Data Analysis</h2>
<ul>
<li>Identify the question you would like to answer</li>
<li>Collect data</li>
<li>Clean data to prepare it for analysis</li>
<li>Analyse data</li>
<li>Interpret and communicate the results</li>
</ul>
<p><img src="img/stock.jpg" class="img-fluid"></p>
</section>
<section id="types-of-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="types-of-data-analysis">Types of data analysis</h2>
<div class="columns">
<div class="column">
<ul>
<li><p>Descriptive:</p>
<pre><code>What happened?</code></pre></li>
<li><p>Diagnostic:</p>
<pre><code>Why did it happen?</code></pre></li>
<li><p>Predictive:</p>
<pre><code>What might happen in the future?</code></pre></li>
<li><p>Prescriptive:</p>
<pre><code>What should we do about it?</code></pre></li>
</ul>
</div><div class="column">
<p><img src="img/infographic_data.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="getting-started-with-r" class="level2">
<h2 class="anchored" data-anchor-id="getting-started-with-r">Getting started with R</h2>
<p>We will be using the programming language R for our data analysis</p>
<p>R is the language</p>
<p>R studio is the graphical user interface (GUI)</p>
<p><img src="img/R_logo.png" class="img-fluid"><br>
If you have not installed R and R studio on your computer please see the resources page on Stream and studyguide material about how to do that.</p>
</section>
<section id="getting-started-with-r-1" class="level2">
<h2 class="anchored" data-anchor-id="getting-started-with-r-1">Getting started with R</h2>
<p>Without R, it would take hours each day to manage data in the best case scenario. In a worst case scenario, it could take the entire day looking at data and fixing mistakes from cutting and pasting. Trying to remember what order you pressed buttons in last time or where the button moved to now that the software has updated. None of this is accounting for the cost of accessing any of the proprietary software.</p>
<p><em>Advantages of R</em></p>
<ul>
<li>Free!</li>
<li>Save your workflow: reuse when data is updated</li>
<li>Explicit and transparent: steps are shown</li>
<li>Serves multiple functions: organise, analyses, communicate</li>
</ul>
</section>
<section id="learning-r" class="level2">
<h2 class="anchored" data-anchor-id="learning-r">Learning R</h2>
<p>Learning any skill from scratch is going to be challenging at first.</p>
<p>R is no exception.</p>
<p>You must consistently practice R in order to retain any information.</p>
<p>Making mistakes is part of learning. We learn a lot from failure.</p>
</section>
<section id="some-r-basics" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="some-r-basics">Some <code>R</code> basics</h2>
<ul>
<li><p><code>R</code> is case sensitive, so <code>data</code> is not the same as <code>DATA</code></p></li>
<li><p>Similarly beware of spaces and punctuation, particularly in column header</p></li>
<li><p><code>&lt;-</code> (read as “gets”) is the assignment operator. That is, you use <code>&lt;-</code> to assign some content to a variable. The operator <code>=</code> has a slightly different meaning but it can be used in the same way as <code>&lt;-</code>.</p></li>
<li><p>Comments are denoted by the # symbol. Anything after a <code>#</code> symbol is ignored by <code>R</code> . This is a great way to write yourself notes.</p></li>
</ul>
</section>
<section id="some-r-basics-1" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="some-r-basics-1">Some <code>R</code> basics</h2>
<ul>
<li><p>R coding can be hard to write from scratch. <span style="color: red;">So do not hesitate to adopt R codes written by others.</span> Search the internet for R code to do what you want to do. The usual <code>copy and paste</code> trick works!</p></li>
<li><p>Warnings vs error messages: R gives warnings typically in <span style="color: orange;">orange</span> and errors in <span style="color: red;">red</span>. A warning means your code likely ran but there is something you should be aware of while an error means your code did not run. We recommend first trying to understand what the error is saying, check for common mistakes (missing failing to close a bracket or quotation, misspelling, capitalization, etc. ), then try to google your error message.</p></li>
</ul>
</section>
<section id="r-as-a-calulator" class="level2">
<h2 class="anchored" data-anchor-id="r-as-a-calulator">R as a calulator</h2>
<p>At the most basic level R is a calculator.</p>
<p>We can type mathematical equations directly into R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">16</span>) <span class="co"># take the square root</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
</section>
<section id="r-objects-model-syntax-etc." class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="r-objects-model-syntax-etc.">R Objects, Model Syntax etc.</h2>
<p>In R, we work with objects. There are different classes of objects including:</p>
<p><code>character</code>, <code>integer</code>, <code>numeric</code>, <code>vector</code>, <code>matrix</code>, <code>array</code>, <code>data.frame</code>, <code>list</code>, <code>lm</code> (linear model).</p>
<p>An object may belong to several classes at once.</p>
<p>Understanding the data type is essential for knowing what you can</p>
</section>
<section id="r-objects-model-syntax-etc.-1" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="r-objects-model-syntax-etc.-1">R Objects, Model Syntax etc.</h2>
<p>Suppose that your data consists of 4 numbers say 1 to 4. We can combine these numbers using the <code>c()</code> function namely <code>c(1,2,3,4)</code> and then assign it to <code>x</code>, an object.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Evidently <code>x</code> is a vector and also belongs to other classes of objects. This can be queried as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The main class it belongs to is queried as</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-objects-model-syntax-etc.-2" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="r-objects-model-syntax-etc.-2">R Objects, Model Syntax etc.</h2>
<p>Our data are actually integers and arranged in a pattern. So we can define <code>x</code> as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The colon (<code>:</code>) operator created the desired pattern. Alternative expressions include</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="at">by=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Try <code>is(x)</code> and <code>class(x)</code> and check whether our data are recognised as integer class.</p>
</section>
<section id="r-mathematical-expressions" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="r-mathematical-expressions">R mathematical expressions</h2>
<p>We can do many mathematical manipulations on <code>x</code>. Try</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(x)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(x)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(x)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(x)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(x, T)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">trunc</span>(x<span class="sc">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="accessing-objects-in-r" class="level2">
<h2 class="anchored" data-anchor-id="accessing-objects-in-r">Accessing objects in R</h2>
<p>Vector elements are accessed by square brackets, <code>[]</code>. Try</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>]<span class="sc">+</span>x[<span class="dv">4</span>]</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>x[<span class="sc">-</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="types-of-data-in-r" class="level2">
<h2 class="anchored" data-anchor-id="types-of-data-in-r">Types of data in R</h2>
<p>Assume that our data are actually categorical codes. Then the correct way of defining the character data is to use single quotes as</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now try Try <code>is(x)</code> and <code>class(x)</code>. For large patterned categorical data, placing quotes is laborious. So we can change the class as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combining-data" class="level2">
<h2 class="anchored" data-anchor-id="combining-data">Combining data</h2>
<p>Assume that you have two batches of data. The first one is</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and the second one is</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These two batches can be combined into a matrix as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x,y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here the matrix <code>m</code> is formed by binding the columns (vectors). The other option is to bind as rows</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Evidently vectors must be of the same length for these commands to work. We can also form a matrix by splitting a vector. Try</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(x, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(x, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To access the first of row of the matrix <code>m</code>, we use <code>m[1,]</code>; to access the first column of <code>m</code>, we use <code>m[,1]</code>.</p>
</section>
<section id="data-frame" class="level2">
<h2 class="anchored" data-anchor-id="data-frame">Data frame</h2>
<p>A <code>data frame</code> is an R object that contains vectors; the vectors are stored vertically in a matrix like structure, and can be referred to by the name of the column. The main advantage of a data frame is that the variables in a data frame do not all need to be the same type; e.g.&nbsp;some variables can be of class numeric, and some variables can be of class character. We can create a data frame object using the <code>data.frame()</code> function. This data frame contains two small vectors, the first of which is named <code>ID</code>, and the second <code>NAME</code>. Try</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">ID=</span>x, <span class="at">NAME=</span>y)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>my.data </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can access the original vector of interest in the following way:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>my.data<span class="sc">$</span>NAME</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="matrices" class="level2">
<h2 class="anchored" data-anchor-id="matrices">Matrices</h2>
<p>There are times when it is useful to convert a data frame into a matrix; we can do this with the <code>as.matrix()</code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(my.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Type <code>class(m)</code> and see the changes.</p>
<p>Two data frames can also be merged into a single data frame using the <code>merge</code> command.</p>
<p>The internal structure of an R object can be viewed using the diagnostic function <code>str()</code>.</p>
</section>
<section id="directories" class="level2">
<h2 class="anchored" data-anchor-id="directories">Directories</h2>
<p>Directories are a location for storing files on your computer. Information (documents) is stored in folders the location of that folder is called a directory. You can think of this as the address of the file.</p>
<p><img src="img/file-cabinet.png" style="height:4in"></p>
</section>
<section id="directories-1" class="level2">
<h2 class="anchored" data-anchor-id="directories-1">Directories</h2>
<p><img src="img/directory.png" class="img-fluid"></p>
<p>This full address of the file is also called a path.</p>
<p>For example on my computer my slides for this class are located in a folder called ‘slides’ inside ‘Data_Analysis_course’. The last part of the path is the most specific folder which is nested inside parent folders.</p>
</section>
<section id="set-directory-in-r" class="level2">
<h2 class="anchored" data-anchor-id="set-directory-in-r">Set directory in R</h2>
<p>In RStudio, set the working directory under the <em>Session</em> menu. It is a good idea to start your analysis as a new project in the File menu so that the entire work and data files can be saved and re-opened easily later on.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>() <span class="co"># check your working directory</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/Users/mmarraff/Documents/Classes/161.250/Data_Analysis_Course/slides"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd() # if you know the directory you want R to look in</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="quarto" class="level2">
<h2 class="anchored" data-anchor-id="quarto">Quarto</h2>
<p>This course will be using <a href="https://quarto.org/">Quarto</a> <code>*.qmd</code> files rather than raw <code>*.R</code> files.</p>
<p>Quarto is the successor to Rmarkdown.</p>
<p>Quarto files contain text and code, and can be ‘Rendered’ to produce a nicely formatted document, usually in HTML or PDF format, containing sections, text, code, plots, and output. Quarto can also be used to make websites; in fact, the website for this course was made using Quarto.</p>
<p>Here’s some information to get you started: <a href="https://quarto.org/docs/get-started/hello/rstudio.html" class="uri">https://quarto.org/docs/get-started/hello/rstudio.html</a>.</p>
<p>And some other useful tips: <a href="https://r4ds.hadley.nz/quarto" class="uri">https://r4ds.hadley.nz/quarto</a>.</p>
</section>
<section id="loading-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-data">Loading data</h2>
<p>Most data sets we shall consider in this course are in a tabular form. This means that each variable is a column, each row is an observation, columns are separated by white space (or comma), and each column or row may have a name.</p>
<p>If the data file is stored locally, you should put the data into the same directory as your Quarto or R markdown script. That way, you can (usually) load it easily without having to type the full pathway (e.g., <code>mydata.csv</code> rather than <code>C:/Users/anhsmith/Work/Project1/data/mydata.csv</code>).</p>
<p>You can also load data from the web using a URL. For example,</p>
<div class="cell" data-layout-align="center">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>rangitikei <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://www.massey.ac.nz/~anhsmith/data/rangitikei.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We usually store the data in an R object, here named <code>rangitikei</code>.</p>
</section>
<section id="types-of-data-files" class="level2">
<h2 class="anchored" data-anchor-id="types-of-data-files">Types of data files</h2>
<p>The letters after the <code>.</code> at the end of a files name are called the extension and tell you the type of file.</p>
<p><em>“comma separated values”</em> (<code>.csv</code>) : <code>read.csv()</code> or <code>read_csv()</code> function to load the file.</p>
<p><em>text file</em> (<code>.txt</code>): <code>read.table()</code> or <code>read_table()</code> function.</p>
<p>The ones with underscores ( <code>read_csv()</code> and <code>read_table()</code> ) are in the <code>readr</code> package, so you’ll need to load it first (though <code>readr</code> is part of <code>tidyverse</code>, so if you load <code>tidyverse</code> you’re all set).</p>
<p>You can also load Microsoft Excel files using functions <code>read_excel()</code>, available in the <code>readxl</code> package.</p>
<p>Note that Excel files usually contain blanks for missing or unreported data or allocate many rows for variable description, which can cause issues while importing them.</p>
</section>
<section id="loading-packages" class="level2">
<h2 class="anchored" data-anchor-id="loading-packages">Loading packages</h2>
<p>Many (but not all) R packages are hosted at a repository called CRAN (<em>C</em>omprehensive <em>R</em> <em>A</em>rchive <em>N</em>etwork). The package install option within RStudio can download and install these optional packages under the menu <code>Packages &gt;&gt; Install</code>. You can also do this using the command <code>install.packages</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('tidyverse')</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this course we will use multiple packages. You need to load them with the library() function every time you run a script/R session but you only need to install them once.</p>
</section>
<section id="welcome-to-the-tidyverse" class="level2">
<h2 class="anchored" data-anchor-id="welcome-to-the-tidyverse">Welcome to the tidyverse</h2>
<p>We will be largely using the <code>tidyverse</code> suite of packages for data organisation, summarising, and plotting; see <a href="https://www.tidyverse.org/" class="uri">https://www.tidyverse.org/</a>.</p>
<p>Let’s load that package now:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Recommended reading to accompany this workshop is pages 1-11 of R for Data Science <a href="https://r4ds.hadley.nz/" class="uri">https://r4ds.hadley.nz/</a></p>
</section>
<section id="tidy-data" class="level2">
<h2 class="anchored" data-anchor-id="tidy-data">Tidy data</h2>
<p>There are three interrelated rules that make a dataset tidy:</p>
<ul>
<li>Each variable is a column; each column is a variable.</li>
<li>Each observation is a row; each row is an observation.</li>
<li>Each value is a cell; each cell is a single value.</li>
</ul>
<div id="fig-tidy" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/tidy_data.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Tidy data</figcaption>
</figure>
</div>
</section>
<section id="why-ensure-that-your-data-is-tidy" class="level2">
<h2 class="anchored" data-anchor-id="why-ensure-that-your-data-is-tidy">Why ensure that your data is tidy?</h2>
<p>There are two main advantages:</p>
<ul>
<li><p>If you have a consistent data structure, it’s easier to learn the tools that work with it because they have an underlying uniformity.</p></li>
<li><p>Placing variables in columns because it allows R’s vectorized nature to shine. Most built-in R functions work with vectors of values.</p></li>
</ul>
<p>dplyr, ggplot2, and all the other packages in the tidyverse are designed to work with tidy data.</p>
</section>
<section id="summarizing-data" class="level2">
<h2 class="anchored" data-anchor-id="summarizing-data">Summarizing data</h2>
<p>Summarizing data is a large part of data analysis.</p>
<p>We summarize data in general because it provides us with a way to generalize - that is, to make general statements that extend beyond specific observations.</p>
<p>What is a summary?</p>
<ul>
<li>Tables</li>
<li>Frequency distributions</li>
<li>Cumulative distributions</li>
<li>Histograms</li>
</ul>
</section>
<section id="dplyr" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="dplyr"><code>dplyr</code></h2>
<p>The following six functions of <code>dplyr</code> are very useful for data wrangling:</p>
<ul>
<li>For selecting columns, use <code>select()</code></li>
<li>For subsetting data, use <code>filter()</code></li>
<li>For re-ordering (e.g.&nbsp;ascending/descending), use <code>arrange()</code></li>
<li>For augmenting new calculated columns, use <code>mutate()</code></li>
<li>For computing summary measures, use <code>summarise()</code></li>
<li>For group-wise computations (e.g.&nbsp;summary measures), use <code>group_by()</code></li>
</ul>
<p>There are many other functions such as <code>transmute()</code> which will add newly calculated columns to the existing data frame but drop all unused columns.</p>
<p>The <code>across()</code> function extends <code>group_by()</code> and <code>summarise()</code> functions for multiple column and function summaries.</p>
<p>For example, you like to report rounded data in a table, which calls for an operation across both rows and columns.</p>
</section>
<section id="piping" class="level2">
<h2 class="anchored" data-anchor-id="piping">Piping</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>The piping operation is a fundamental aspect of computer programming. The semantics of pipes is taking the output from the left-hand side and passing it as input to the right-hand side.</strong></p>
</div>
</div>
<p>The <code>R</code> package <code>magrittr</code> introduced the pipe operator <code>%&gt;%</code> and can be pronounced as “then”. In RStudio windows/Linux versions, press <code>Ctrl+Shift+M</code> to insert the pipe operator. On a Mac, use <code>Cmd+Shift+M</code>.</p>
<p><code>R</code> also has its own pipe, <code>|&gt;</code>, which is an alternative to <code>%&gt;%</code>. If you want to change the pipe inserted automatically with <code>Ctrl+Shift+M</code>, find on the menu <strong>Tools &gt; Global Options</strong>, then click on <strong>Code</strong> and check the box that says “<strong>Use Native Pipe Operator</strong>”.</p>
<p>We often pipe the <code>dplyr</code> functions, and the advantage is that we show the flow of data manipulation and subsequent graphing. This approach also helps to save memory, and dataframes are not unnecessarily created, a necessity for a big data framework.</p>
</section>
<section id="graphing-with-ggplot2" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="graphing-with-ggplot2">Graphing with <code>ggplot2</code></h2>
<p>The R library <code>ggplot2</code> is very powerful for plotting but you may find the syntax little strange. There are plenty of examples at the <a href="https://ggplot2.tidyverse.org/reference/"><code>ggplot2</code> online help website</a>. The <code>ggplot2</code> package is loaded as part of the <code>tidyverse</code> set of packages.</p>
<div class="columns">
<div class="column">
<p>Advantages of <code>ggplot2</code> are the following:</p>
<ul>
<li>employs the “grammar of graphics” of <span class="citation" data-cites="Wilkinson">[@Wilkinson]</span></li>
<li>plotting involves a high level of abstraction</li>
<li>very flexible and complete graphics system</li>
<li>theme system for getting attractive plots</li>
<li>Fast growing and actively developed</li>
</ul>
</div><div class="column">
<p>Some disadvantages of <code>ggplot2</code> are the following:</p>
<ul>
<li>3-dimensional graphics (opt for <code>rgl</code> package instead)</li>
<li>Graph-theory type graphs (nodes/edges layout; opt for <code>igraph</code> and other packages)</li>
<li>Interactive graphics (opt for <code>plotly</code>, <code>ggvis</code> and other packages)</li>
</ul>
</div>
</div>
</section>
<section id="grammar-of-graphics" class="level2">
<h2 class="anchored" data-anchor-id="grammar-of-graphics">Grammar of Graphics</h2>
<p>The main idea behind the grammar of graphics of <span class="citation" data-cites="Wilkinson">[@Wilkinson]</span> is to mimic the manual graphing approach by defining building blocks and combining them to create the figure.</p>
<p>The building blocks of a graph are:</p>
<ul>
<li>data</li>
<li>aesthetic mapping</li>
<li>geometric object</li>
<li>transformation or re-expression of data</li>
<li>scales</li>
<li>coordinate system</li>
<li>position adjustments</li>
<li>faceting</li>
</ul>
</section>
<section id="aesthetic-mapping-aes" class="level2">
<h2 class="anchored" data-anchor-id="aesthetic-mapping-aes">Aesthetic Mapping (<code>aes</code>)</h2>
<p>In ggplot land <em>aesthetic</em> means visualisation features or aesthetics. These are</p>
<ul>
<li>position (i.e., on the x and y axes)</li>
<li>color (“outside” color)</li>
<li>fill (“inside” color)</li>
<li>shape (of points)</li>
<li>linetype</li>
<li>size</li>
</ul>
<p>Aesthetic mappings are set with the <code>aes()</code> function.</p>
</section>
<section id="geometric-objects-geom" class="level2">
<h2 class="anchored" data-anchor-id="geometric-objects-geom">Geometric Objects (<code>geom</code>)</h2>
<p>Geometric objects or <code>geoms</code> are the actual marking or inking on a plot such as:</p>
<ul>
<li>points (<code>geom_point</code>, for scatter plots, dot plots, etc)</li>
<li>lines (<code>geom_line</code>, for time series, trend lines, etc)</li>
<li>boxplot (<code>geom_boxplot</code>, for boxplots)</li>
</ul>
<p><em>A plot must have at least one <code>geom</code> but there is no upper limit.</em> In order to add a <code>geom</code> to a plot, the <code>+</code> operator is employed. A list of available geometric objects can be obtained by typing <code>geom_&lt;tab&gt;</code> in Rstudio. The following command can also be used which will open a Help window.</p>
<pre><code>help.search("geom_", package = "ggplot2")</code></pre>
</section>
<section id="tidying-data" class="level2">
<h2 class="anchored" data-anchor-id="tidying-data">Tidying data</h2>
<p>The principles of tidy data might seem so obvious that you wonder if you’ll ever encounter a dataset that isn’t tidy. Unfortunately, however, most real data is (very) untidy. There are two main reasons:</p>
<ul>
<li><p>Data is often organized to facilitate some goal other than analysis. For example, it’s common for data to be structured to make data entry easy.</p></li>
<li><p>Most people aren’t familiar with the principles of tidy data, and it’s hard to derive them yourself unless you spend a lot of time working with data.</p></li>
</ul>
<p>This means that most real analyses will require at least a little tidying. You’ll begin by figuring out what the underlying variables and observations are. Sometimes this is easy; other times you’ll need to consult with the people who originally generated the data.</p>
</section>
<section id="tidying-data-example" class="level2">
<h2 class="anchored" data-anchor-id="tidying-data-example">Tidying data example</h2>
<p>The hospital admissions dataset is untidy because it does allocate many columns for a variable.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>hospital <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.massey.ac.nz/~anhsmith/data/hospital.txt"</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">sep=</span><span class="st">","</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hospital)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  YEAR PERI NORTH1 NORTH2 NORTH3 SOUTH1 SOUTH2 SOUTH3
1 1980    1      0      4     27      4     16     27
2 1980    2      6     11     31      8     18     21
3 1980    3      6      4     25     20     16     24
4 1980    4      1     10     31     22     17     20
5 1980    5      4     16     22     21     30     31
6 1980    6      3      8     28     31     20     30</code></pre>
</div>
</div>
<p>This format is also called <code>wide format</code> which can be made into a tidy <code>long format</code>.</p>
</section>
<section id="tidying-data-example-cont." class="level2">
<h2 class="anchored" data-anchor-id="tidying-data-example-cont.">Tidying data example (cont.)</h2>
<p>We can use the <code>dplyr</code> function <code>pivot_longer()</code> to change this data into <code>long format</code>. Try-</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>hospital <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> NORTH1<span class="sc">:</span>SOUTH3, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"location"</span>, </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Admissions"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The command <code>pivot_wider()</code> does the opposite to <code>pivot_longer()</code></p>
</section>
<section id="joining-data" class="level2">
<h2 class="anchored" data-anchor-id="joining-data">Joining data</h2>
<p>Sometimes you may want to analyse information that is in multiple tables.</p>
<p>We will introduce a series of functions for joining tables together.</p>
</section>
<section id="joining-data-example" class="level2">
<h2 class="anchored" data-anchor-id="joining-data-example">Joining data: Example</h2>
<p>For example, consider the flights and airlines data from the nycflights13 package.</p>
<p>In one table we have flight information with an abbreviation for carrier, and in another we have a mapping between abbreviations and full names.</p>
<p>You can use a join to add the carrier names to the flight data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop unimportant variables so it's easier to understand the join results.</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>flights2 <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> <span class="fu">select</span>(year<span class="sc">:</span>day, hour, origin, dest, tailnum, carrier)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">%&gt;%</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(airlines)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 9
    year month   day  hour origin dest  tailnum carrier name                    
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                   
 1  2013     1     1     5 EWR    IAH   N14228  UA      United Air Lines Inc.   
 2  2013     1     1     5 LGA    IAH   N24211  UA      United Air Lines Inc.   
 3  2013     1     1     5 JFK    MIA   N619AA  AA      American Airlines Inc.  
 4  2013     1     1     5 JFK    BQN   N804JB  B6      JetBlue Airways         
 5  2013     1     1     6 LGA    ATL   N668DN  DL      Delta Air Lines Inc.    
 6  2013     1     1     5 EWR    ORD   N39463  UA      United Air Lines Inc.   
 7  2013     1     1     6 EWR    FLL   N516JB  B6      JetBlue Airways         
 8  2013     1     1     6 LGA    IAD   N829AS  EV      ExpressJet Airlines Inc.
 9  2013     1     1     6 JFK    MCO   N593JB  B6      JetBlue Airways         
10  2013     1     1     6 LGA    ORD   N3ALAA  AA      American Airlines Inc.  
# ℹ 336,766 more rows</code></pre>
</div>
</div>
<p>As well as x and y, each mutating join takes an argument <code>by</code> that controls which variables are used to match observations in the two tables.</p>
</section>
<section id="types-of-join" class="level2">
<h2 class="anchored" data-anchor-id="types-of-join">Types of join</h2>
<p>There are four types of mutating join, which differ in their behaviour when a match is not found.</p>
<ul>
<li><p><code>inner_join(x, y)</code> only includes observations that match in both x and y.</p></li>
<li><p><code>left_join(x, y)</code> includes all observations in <code>x</code>, regardless of whether they match or not. This is the most commonly used join because it ensures that you don’t lose observations from your primary table.</p></li>
<li><p><code>right_join(x, y)</code> includes all observations in <code>y</code>. It’s equivalent to <code>left_join(y, x)</code>, but the columns and rows will be ordered differently.</p></li>
<li><p><code>full_join()</code> includes all observations from x and y.</p></li>
</ul>
<p>The left, right and full joins are collectively know as outer joins. When a row doesn’t match in an outer join, the new variables are filled in with missing values.</p>
</section>
<section id="importance-of-data-quality-control-process" class="level2">
<h2 class="anchored" data-anchor-id="importance-of-data-quality-control-process">Importance of Data Quality Control Process</h2>
<p>Decision-making:</p>
<pre><code>High-quality data ensures that decisions are based on accurate information.</code></pre>
<p>Operational Efficiency:</p>
<pre><code>Reliable data is crucial for an efficient manufacturing. </code></pre>
<p>Customer Satisfaction:</p>
<pre><code>Accurate customer data contributes to improved customer satisfaction.</code></pre>
<p>Compliance:</p>
<pre><code>Complying with regulations requires accurate and secure data handling. </code></pre>
<p>Trust and Credibility:</p>
<pre><code>Builds trust with stakeholders, customers, and partners.</code></pre>
</section>
<section id="data-quality" class="level2">
<h2 class="anchored" data-anchor-id="data-quality">Data Quality</h2>
<p>Accuracy: Refers to the correctness of data.</p>
<p>Completeness: Addresses whether all necessary data is present.</p>
<p>Consistency: Ensures uniformity and coherence across data sets.</p>
<p>Timeliness: Timely data is up-to-date and aligns with the current context.</p>
<p>Relevance: Relevant data is directly applicable to the analysis or decision-making process.</p>
<p>Validity: Valid data meets the criteria set for its format and structure.</p>
<p>Reliability: Reliable data remains accurate and consistent across various timeframes.</p>
<p>Precision: Precise data is specific and avoids unnecessary granularity or ambiguity.</p>
</section>
<section id="data-quality-checks" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="data-quality-checks">Data Quality Checks</h2>
<ul>
<li><p>Inaccurate entries</p>
<p>Typos, spelling, capitalization</p></li>
<li><p>Missing data</p>
<p>Empty cells or rows</p></li>
<li><p>Outliers/Unrealistic entries</p>
<p>Large numbers, negative numbers, etc. Age should fall within a realistic range (e.g., 0 to 120 years)</p></li>
</ul>
</section>
<section id="common-data-issues" class="level2">
<h2 class="anchored" data-anchor-id="common-data-issues">Common data issues</h2>
<ul>
<li><p>Spelling, capitalization, typos, and white spaces</p>
<p>there are some handy functions in <code>stringr</code> and <code>janitor</code> packages <em>case_when()</em> in dplyr can be very helpful for rename or reclassifying observations</p></li>
<li><p>NAs: there is a difference between not observed, not recorded, and not applicable. This difference requires understanding of the data and data entry process for that project</p>
<p>can remove NAs using <code>na.omit()</code>, <code>!is.na()</code>, <code>na.rm=T</code>, etc. depending on what function you are using. See help menu for more details</p></li>
<li><p>Multiple types of data in a single column or wrong data type</p>
<p>can force a data class using <code>as.numeric()</code> for example</p></li>
<li><p>Multiple entries of the same observation</p>
<p><code>janitor</code> package has a function get_dupes() to find duplicate entries or the distinct() function from dplyr.</p></li>
</ul>
</section>
<section id="missing-data" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="missing-data">Missing Data</h2>
<p><em>Missing completely at random</em> (MCAR) is often used to mean there is there is no pattern to the missing data themselves or alternatively the missingness is not related to any other variable or data in the dataset.</p>
<p><em>Missing at random (MAR)</em> data is data conditionally missing at random.</p>
<p>For example a particular survey question, the response rate may differ depending on the respondent’s gender. In this situation, the actual missingness may be random but still related to the gender variable.</p>
<p><em>Missing not at random (MNAR)</em> is the pattern when missingness is related to other variables in the dataset, as well as the values of the missing data are not random.</p>
<p>There are also situations such as censoring where we just record a single value without actually measuring the variable of interest.</p>
</section>
<section id="data-quality-checks-example" class="level2">
<h2 class="anchored" data-anchor-id="data-quality-checks-example">Data Quality Checks: Example</h2>
<p>It is a good idea to check the quality of secondary data sourced from elsewhere. For example, there could be missing values in the dataset. Consider the Telomeres data downloaded from <a href="http://www.massey.ac.nz/~anhsmith/data/rsos192136_si_001.xlsx" class="uri">http://www.massey.ac.nz/~anhsmith/data/rsos192136_si_001.xlsx</a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"http://www.massey.ac.nz/~anhsmith/data/rsos192136_si_001.xlsx"</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>destfile <span class="ot">&lt;-</span> <span class="st">"rsos192136_si_001.xlsx"</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>curl<span class="sc">::</span><span class="fu">curl_download</span>(url, destfile)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>rsos192136_si_001 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"rsos192136_si_001.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The missingness of data can be quickly explored using many R packages. The downloaded Telomeres dataset contain many missing values.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> rsos192136_si_001 <span class="sc">|&gt;</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggr</span>(<span class="at">sortVar=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"combinations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Chapter00_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="missing-data-1" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="missing-data-1">Missing Data</h2>
<p>Imputation of data can be made except for the case of MCAR type. A number of R packages are available for data imputation; see <a href="https://cran.r-project.org/web/views/MissingData.html" class="uri">https://cran.r-project.org/web/views/MissingData.html</a> or <a href="https://stefvanbuuren.name/fimd/" class="uri">https://stefvanbuuren.name/fimd/</a>. We may occasionally cover data imputation issue in an assignment question.</p>
</section>
<section id="data-quality-checks-1" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="data-quality-checks-1">Data Quality Checks</h2>
<p>There are also R packages to perform automatic investigation for data cleaning. Try-</p>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<ul>
<li><p>Introduction:</p>
<p>What is data analysis?</p></li>
<li><p>Tidy data:</p>
<ul>
<li>Each variable is a column; each column is a variable.</li>
<li>Each observation is a row; each row is an observation.</li>
<li>Each value is a cell; each cell is a single value.</li>
</ul></li>
<li><p>R programming for data analysis:</p>
<p>Get practicing with R.</p></li>
</ul>
<!-- ricomisc::rstudio_viewer("Chapter-0.html", file_path = NULL) -->


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>