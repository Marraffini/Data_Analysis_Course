<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <title>161250 Data Analysis - Chapter 4:Introduction to Statistical Inference</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Chapter 4:<br>Introduction to Statistical Inference</h1>

<div class="quarto-title-authors">
</div>

</section>
<section>
<section id="statistical-inference" class="title-slide slide level1 background-black center">
<h1>Statistical Inference</h1>
<blockquote>
<p>“A statistical analysis, properly conducted, is a delicate dissection of uncertainties, a surgery of suppositions.”</p>
<p>— M.J. Moroney</p>
</blockquote>
</section>
<section id="statistical-inference-1" class="slide level2">
<h2>Statistical Inference</h2>
<div class="columns">
<div class="column" style="width:65%;">
<p>The term <em>statistical inference</em> means that we are using properties of a sample to make statements about the population from which the sample was drawn.</p>
<p>For example, say you wanted to know the mean length of the leaves on a tree (<span class="math inline">\(\mu\)</span>). You wouldn’t want to (nor need to) measure every single leaf! You would take a random sample of leaves and measure their lengths (<span class="math inline">\(x_i\)</span>), calculate the sample mean (<span class="math inline">\(\bar x\)</span>), and use <span class="math inline">\(\bar x\)</span> as an estimate of <span class="math inline">\(\mu\)</span>.</p>
</div><div class="column" style="width:35%;">
<p><img data-src="img/sampling_variation2.gif"></p>
</div>
</div>
</section>
<section id="statistical-inference-for-a-population-mean" class="slide level2">
<h2>Statistical Inference for a Population Mean</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>Consider a population <span class="math inline">\(X\)</span> with mean <span class="math inline">\(\mu\)</span>,<br>
variance <span class="math inline">\(\text{Var}(X)=\sigma^2\)</span>, and<br>
standard deviation <span class="math inline">\(\sigma\)</span>.</p>
<p>We can estimate <span class="math inline">\(\mu\)</span> by:</p>
<ul>
<li>taking a random sample of values <span class="math inline">\(\{x_1, x_2, ..., x_n\}\)</span> from the population, <span class="math inline">\(X\)</span>, and</li>
<li>calculating the sample mean <span class="math inline">\(\bar x = \frac 1 n \sum_{i=1}^{n}x_i\)</span>.</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="img/inference.png"></p>
</div>
</div>
<p>Importantly:</p>
<ul>
<li>The sample mean <span class="math inline">\(\bar x\)</span> is a single draw from a random variable <span class="math inline">\(\bar X\)</span>. It will never be exactly equal to the population mean, <span class="math inline">\(\mu\)</span>, unless you measure every single leaf.</li>
<li>There is <strong><em>uncertainty</em></strong> in our estimate of <span class="math inline">\(\mu\)</span>. Each sample yields a different <span class="math inline">\(\bar x\)</span>. This is called <strong><em>sampling error</em></strong>.</li>
</ul>
</section>
<section id="sampling-variation" class="slide level2">
<h2>Sampling Variation</h2>

<img data-src="img/samp_dist.gif" class="r-stretch"></section>
<section id="sampling-error" class="slide level2">
<h2>Sampling Error</h2>
<p>The variability of the sample means from sample to sample, <span class="math inline">\(\text{Var}(\bar X)\)</span>, depends on two things:</p>
<ul>
<li>the variability of the population values, <span class="math inline">\(\text{Var}(x)\)</span>, and</li>
<li>the size of the sample, <span class="math inline">\(n\)</span>.</li>
</ul>
<p>The variability of the sample estimate of a parameter is usually expressed as a <strong><em>standard error</em></strong> (SE), which is simply the theoretical standard deviation of <span class="math inline">\(\bar X\)</span> from sample to sample.</p>
<p>The equation is surprisingly simple!</p>
<p><span class="math inline">\(\text{Var}(\bar X) = \text{Var}(X)/n\)</span></p>
<p><span class="math inline">\(\text{SE}(\bar X) = \text{SD}(\bar X) = \sigma/\sqrt n\)</span></p>
</section>
<section id="quetelets-dataset" class="slide level2">
<h2>Quetelet’s dataset</h2>
<div class="columns">
<div class="column" style="width:70%;">
<p>In 1846, a Belgian scholar Adolphe Quetelet published an analysis of the chest sizes of a full population of 5,738 Scottish soldiers.</p>
<p>The distribution of the measurements (in inches) in his database has a mean of <span class="math inline">\(\mu\)</span> = 39.83 inches, a standard deviation of <span class="math inline">\(\sigma\)</span> = 2.05 inches, and is well approximated by a normal distribution.</p>
</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/quetelet_face.jpg"></p>
<figcaption>Adolphe Quetelet<br>1796-1874</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell columns column-output-location" data-layout-align="center">
<div class="column">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>qd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="at">Chest =</span> <span class="dv">33</span><span class="sc">:</span><span class="dv">48</span>, </span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="at">Count =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">18</span>, <span class="dv">81</span>, <span class="dv">185</span>, <span class="dv">420</span>, <span class="dv">749</span>, <span class="dv">1073</span>, <span class="dv">1079</span>, </span>
<span id="cb1-4"><a href="#cb1-4"></a>            <span class="dv">934</span>, <span class="dv">658</span>, <span class="dv">370</span>, <span class="dv">92</span>, <span class="dv">50</span>, <span class="dv">21</span>, <span class="dv">4</span>, <span class="dv">1</span>),</span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="at">Prob =</span> Count <span class="sc">/</span> <span class="fu">sum</span>(Count)</span>
<span id="cb1-6"><a href="#cb1-6"></a>  )</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a>qd <span class="sc">|&gt;</span> </span>
<span id="cb1-9"><a href="#cb1-9"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Chest, <span class="at">y =</span> Count) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>  <span class="fu">ggtitle</span>(<span class="st">"Chest circumferences of Scottish soldiers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter04_files/figure-revealjs/unnamed-chunk-1-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="quetelets-dataset-1" class="slide level2">
<h2>Quetelet’s dataset</h2>
<p>Every soldier was measured so we can treat this as the population, and <span class="math inline">\(\mu\)</span> = 39.83 and <span class="math inline">\(\sigma\)</span> = 2.05 as population parameters. Let’s take some samples of size <span class="math inline">\(n\)</span> = 6 from this population.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Convert to a long vector of values</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>qd_long <span class="ot">&lt;-</span> <span class="fu">rep</span>(qd<span class="sc">$</span>Chest, qd<span class="sc">$</span>Count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># A single sample</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">sample</span>(qd_long, <span class="at">size =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 38 40 39 38 38 40</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Ten samples</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="sc">~</span> <span class="fu">sample</span>(qd_long, <span class="at">size =</span> <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 36 36 39 44 41 37

[[2]]
[1] 42 35 45 41 41 41

[[3]]
[1] 40 40 41 40 41 40

[[4]]
[1] 40 37 36 39 38 37

[[5]]
[1] 42 39 37 39 39 40

[[6]]
[1] 43 39 43 46 41 40

[[7]]
[1] 36 40 39 35 40 39</code></pre>
</div>
</div>
</div>
</section>
<section id="quetelets-dataset-2" class="slide level2">
<h2>Quetelet’s dataset</h2>
<p>Every soldier was measured so we can treat this as the population, and <span class="math inline">\(\mu\)</span> = 39.83 and <span class="math inline">\(\sigma\)</span> = 2.05 as population parameters. Let’s take some samples of size <span class="math inline">\(n\)</span> = 6 from this population.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Convert to a long vector of values</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>qd_long <span class="ot">&lt;-</span> <span class="fu">rep</span>(qd<span class="sc">$</span>Chest, qd<span class="sc">$</span>Count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Put ten samples in a tibble</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>q_samples <span class="ot">&lt;-</span> <span class="fu">tibble</span>( <span class="at">sample =</span> <span class="fu">as_factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) ) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">mutate</span>( </span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="at">values =</span> <span class="fu">map</span>(sample, <span class="sc">~</span> <span class="fu">sample</span>(qd_long, <span class="at">size =</span> <span class="dv">6</span>)) </span>
<span id="cb8-5"><a href="#cb8-5"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="fu">unnest</span>()</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="fu">head</span>(q_samples, <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 2
   sample values
   &lt;fct&gt;   &lt;int&gt;
 1 1          37
 2 1          42
 3 1          39
 4 1          39
 5 1          42
 6 1          38
 7 2          43
 8 2          38
 9 2          41
10 2          40
11 2          40
12 2          39
13 3          40
14 3          40
15 3          39</code></pre>
</div>
</div>
</div>
</section>
<section id="quetelets-dataset-3" class="slide level2">
<h2>Quetelet’s dataset</h2>
<p>Every soldier was measured so we can treat this as the population, and <span class="math inline">\(\mu\)</span> = 39.83 and <span class="math inline">\(\sigma\)</span> = 2.05 as population parameters. Let’s take some samples of size <span class="math inline">\(n\)</span> = 6 from this population.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Convert to a long vector of values</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>qd_long <span class="ot">&lt;-</span> <span class="fu">rep</span>(qd<span class="sc">$</span>Chest, qd<span class="sc">$</span>Count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Put ten samples in a tibble</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>q_samples <span class="ot">&lt;-</span> <span class="fu">tibble</span>( <span class="at">sample =</span> <span class="fu">as_factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) ) <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">mutate</span>( </span>
<span id="cb11-4"><a href="#cb11-4"></a>    <span class="at">values =</span> <span class="fu">map</span>(sample, <span class="sc">~</span> <span class="fu">sample</span>(qd_long, <span class="at">size =</span> <span class="dv">6</span>)) </span>
<span id="cb11-5"><a href="#cb11-5"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="fu">unnest</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Calculate means of each sample</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>sample_means <span class="ot">&lt;-</span> q_samples <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">group_by</span>(sample) <span class="sc">|&gt;</span> </span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(values))</span>
<span id="cb12-5"><a href="#cb12-5"></a></span>
<span id="cb12-6"><a href="#cb12-6"></a>sample_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   sample  mean
   &lt;fct&gt;  &lt;dbl&gt;
 1 1       40.5
 2 2       41  
 3 3       39.8
 4 4       39.5
 5 5       40.8
 6 6       40.3
 7 7       40.5
 8 8       40.3
 9 9       39.2
10 10      40.2</code></pre>
</div>
</div>
</div>
</section>
<section id="quetelets-dataset-4" class="slide level2">
<h2>Quetelet’s dataset</h2>
<div class="columns">
<div class="column" style="width:55%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Make a function to do it all and plot</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>plot_samples <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">dat =</span> qd_long,</span>
<span id="cb14-3"><a href="#cb14-3"></a>                         <span class="at">no_samples =</span> <span class="dv">12</span>,</span>
<span id="cb14-4"><a href="#cb14-4"></a>                         <span class="at">sample_size =</span> <span class="dv">6</span>) {</span>
<span id="cb14-5"><a href="#cb14-5"></a></span>
<span id="cb14-6"><a href="#cb14-6"></a>  <span class="co"># Put samples in a tibble</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>  q_samples <span class="ot">&lt;-</span> <span class="fu">tibble</span>( </span>
<span id="cb14-8"><a href="#cb14-8"></a>    <span class="at">sample =</span> <span class="fu">as_factor</span>(<span class="dv">1</span><span class="sc">:</span>no_samples),</span>
<span id="cb14-9"><a href="#cb14-9"></a>    <span class="at">values =</span> <span class="fu">map</span>(sample, <span class="sc">~</span> <span class="fu">sample</span>(dat, <span class="at">size =</span> sample_size))</span>
<span id="cb14-10"><a href="#cb14-10"></a>    ) <span class="sc">|&gt;</span> <span class="fu">unnest</span>()</span>
<span id="cb14-11"><a href="#cb14-11"></a>  </span>
<span id="cb14-12"><a href="#cb14-12"></a>  <span class="co"># Calculate means of each sample</span></span>
<span id="cb14-13"><a href="#cb14-13"></a>  sample_means <span class="ot">&lt;-</span> q_samples <span class="sc">|&gt;</span> <span class="fu">group_by</span>(sample) <span class="sc">|&gt;</span> </span>
<span id="cb14-14"><a href="#cb14-14"></a>    <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(values))</span>
<span id="cb14-15"><a href="#cb14-15"></a>  </span>
<span id="cb14-16"><a href="#cb14-16"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb14-17"><a href="#cb14-17"></a>    <span class="fu">xlim</span>(<span class="fu">min</span>(dat), <span class="fu">max</span>(dat)) <span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(dat), <span class="at">alpha =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb14-19"><a href="#cb14-19"></a>    <span class="fu">geom_jitter</span>(</span>
<span id="cb14-20"><a href="#cb14-20"></a>      <span class="at">data =</span> q_samples,</span>
<span id="cb14-21"><a href="#cb14-21"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> sample, <span class="at">x =</span> values),</span>
<span id="cb14-22"><a href="#cb14-22"></a>      <span class="at">width =</span> <span class="dv">0</span>, <span class="at">height =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> .<span class="dv">8</span></span>
<span id="cb14-23"><a href="#cb14-23"></a>      ) <span class="sc">+</span> </span>
<span id="cb14-24"><a href="#cb14-24"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb14-25"><a href="#cb14-25"></a>      <span class="at">data =</span> sample_means,</span>
<span id="cb14-26"><a href="#cb14-26"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> sample, <span class="at">x =</span> mean),</span>
<span id="cb14-27"><a href="#cb14-27"></a>      <span class="at">shape =</span> <span class="dv">15</span>, <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb14-28"><a href="#cb14-28"></a>      <span class="at">colour =</span> <span class="st">"dark orange"</span></span>
<span id="cb14-29"><a href="#cb14-29"></a>      ) <span class="sc">+</span></span>
<span id="cb14-30"><a href="#cb14-30"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Sample size ="</span>, sample_size))</span>
<span id="cb14-31"><a href="#cb14-31"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:45%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">plot_samples</span>(<span class="at">sample_size =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter04_files/figure-revealjs/unnamed-chunk-11-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sample-means-and-sample-sizes" class="slide level2">
<h2>Sample means and sample sizes</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>Let’s compare the distribution of means for different sample sizes <em>across the samples</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">plot_samples</span>(<span class="at">sample_size =</span> <span class="dv">3</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">plot_samples</span>(<span class="at">sample_size =</span> <span class="dv">5</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="fu">plot_samples</span>(<span class="at">sample_size =</span> <span class="dv">10</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="fu">plot_samples</span>(<span class="at">sample_size =</span> <span class="dv">20</span>)</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="fu">plot_samples</span>(<span class="at">sample_size =</span> <span class="dv">50</span>)</span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="fu">plot_samples</span>(<span class="at">sample_size =</span> <span class="dv">100</span>)</span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="fu">plot_samples</span>(<span class="at">sample_size =</span> <span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center" data-animation.hook="gifski">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter04_files/figure-revealjs/unnamed-chunk-13-.gif" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>The larger the <span class="math inline">\(n\)</span>, the less the sample means vary.</p>
</section>
<section id="standard-error" class="slide level2">
<h2>Standard error</h2>
<p>If is distributed as a normal random variable with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>,</p>
<p><span class="math display">\[X \sim \text{Normal}(\mu, \sigma)\]</span></p>
<p>then sample means of size <span class="math inline">\(n\)</span> are distributed as</p>
<p><span class="math display">\[\bar X \sim \text{Normal}(\mu_\bar{X} = \mu, \sigma_\bar{X} = \sigma/\sqrt{n})\]</span> <span class="math inline">\(\text{SE}(\bar{X}) = \sigma_\bar{X}= \sigma/\sqrt{n})\)</span> is known as the <strong><em>standard error of the sample mean</em></strong>.</p>
<p>More generally, a standard error is the standard deviation of an estimated parameter over <span class="math inline">\(\infty\)</span> theoretical samples.</p>
<p>According to the Central Limit Theorem (CLT), raw <span class="math inline">\(X\)</span> values don’t have to be normally distributed for the sample means to be normally distributed (for any decent sample size)!</p>
</section>
<section id="quetelets-chests-standard-error-of-means-of-samples" class="slide level2">
<h2>Quetelet’s chests: Standard error of means of samples</h2>
<p><strong>Question:</strong></p>
<p>If Quetelet’s chest circumferences are distributed as <span class="math inline">\(X \sim \text{N}(\mu=39.83, \sigma=2.05)\)</span>, then how variable are the means of samples of size <span class="math inline">\(n\)</span> = 6?</p>
<p><strong>Answer:</strong></p>
<p><span class="math display">\[
\begin{aligned}
SE(\bar{X}_{n=6})&amp;=\sigma/\sqrt{n} \\
&amp;=2.05/\sqrt{6} \\
&amp;=0.8369
\end{aligned}
\]</span> Sample means of size <span class="math inline">\(n\)</span> = 6 would be distributed as</p>
<p><span class="math inline">\(\bar{X}_{n=6} \sim \text{N}(\mu=39.83, \sigma=0.8369)\)</span></p>
</section>
<section id="quetelets-chests-distribution-of-means-of-samples" class="slide level2">
<h2>Quetelet’s chests: Distribution of means of samples</h2>

<img data-src="Chapter04_files/figure-revealjs/unnamed-chunk-14-.gif" width="480" class="r-stretch quarto-figure-center"></section>
<section id="confidence-intervals" class="slide level2">
<h2>Confidence intervals</h2>
<div>
<ul>
<li class="fragment"><p>Another common way of expressing uncertainty when making statistical inferences is to present:</p>
<ul>
<li class="fragment">a point estimate (e.g., the sample mean) and</li>
<li class="fragment">a confidence interval around that estimate.</li>
</ul></li>
<li class="fragment"><p>A confidence interval gives an indication of the sampling error.</p></li>
<li class="fragment"><p>A 95% confidence interval is constructed so that <strong><em>intervals from 95% of samples will contain the true population parameter</em></strong>.</p></li>
<li class="fragment"><p>In reality the interval either contains the true value or not, so you must <strong>not</strong> interpret a confidence interval as “there’s a 95% probability that the interval contains the true parameter”.</p></li>
<li class="fragment"><p>We can say:</p>
<ul>
<li class="fragment">“95% of so-constructed intervals will contain the true value of the parameter” or</li>
<li class="fragment">“with 95% confidence, the interval contains the true value of the parameter”.</li>
</ul></li>
</ul>
</div>
</section>
<section id="confidence-intervals-1" class="slide level2">
<h2>Confidence intervals</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Because we know the population parameters for the Quetelet dataset, we can calculate where 95% of sample means will lie for any particular sample size.</p>
<p>Recall that, for a normal distribution, 95% of values lie between <span class="math inline">\(\mu \pm 1.96\times\sigma\)</span><br>
(i.e., <span class="math inline">\(\mu - 1.96\times\sigma\)</span> and <span class="math inline">\(\mu + 1.96\times\sigma\)</span>).</p>
<p>It follows that 95% of means of samples of size <span class="math inline">\(n\)</span> will lie within <span class="math inline">\(\mu \pm 1.96 \times \sigma/\sqrt{n}\)</span>.</p>
<p>For example, for samples of size 6 from the Quetelet dataset, 95% of means will lie within <span class="math inline">\(39.83 \pm 1.96\times 2.05 / \sqrt 6\)</span>,<br>
so <span class="math inline">\(\{ 37.02 , 42.64\}\)</span>.</p>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter04_files/figure-revealjs/unnamed-chunk-16-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="estimating-the-distribution-of-sample-means-from-data" class="slide level2">
<h2>Estimating the distribution of sample means from data</h2>
<div>
<ul>
<li class="fragment"><p>It’s all very well deriving the distribution of sample means when we <em>know the population parameters</em> (<span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>) but <em>in most cases we only have our one sample</em>.</p></li>
<li class="fragment"><p>We don’t know any of the population parameters. We have to <em>estimate</em> the population mean (usually denoted <span class="math inline">\(\hat\mu\)</span> or <span class="math inline">\(\bar x\)</span>) and <em>estimate</em> of the population standard deviation (usually denoted <span class="math inline">\(\hat\sigma\)</span> or <span class="math inline">\(s\)</span>) from the sample data.</p></li>
<li class="fragment"><p>This additional uncertainty complicates things a bit. In fact, we can’t even use the normal distribution any more!</p></li>
</ul>
</div>
</section>
<section id="the-t-distribution" class="slide level2">
<h2>The <em>t</em> distribution</h2>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li><p>Introducing William Sealy Gosset, who described the <em>t</em> distribution after working with random numbers.</p></li>
<li><p>Gosset was a chemist and mathematician who worked for the Guinness brewery in Dublin.</p></li>
<li><p>Guinness forbade anyone from publishing under their own names so that competing breweries wouldn’t know what they were up to, so he published his discovery in 1908 under the penname “Student”. Student’s identity was only revealed when he died. It is therefore often called “Student’s <em>t</em> distribution”.</p></li>
</ul>
</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/gosset_1876-1937.jpg"></p>
<figcaption>Willam Sealy Gosset<br>1876-1937</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="the-t-distribution-1" class="slide level2">
<h2>The <em>t</em> distribution</h2>
<ul>
<li><p>The <em>t</em> distribution is like the standard normal. It is bell-shaped and symmetric with mean = 0, but it has fatter tails (greater uncertainty) due to the fact that we do not <em>know</em> <span class="math inline">\(\sigma\)</span>; we have to <em>estimate</em> it.</p></li>
<li><p>The <em>t</em> distribution is not just a single distribution. It is really an entire series of distributions which is indexed by something called the “degrees of freedom” (or <span class="math inline">\(df\)</span>).</p></li>
</ul>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li>As <span class="math inline">\(df \rightarrow \infty\)</span>, <span class="math inline">\(t \rightarrow Z\)</span>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>p <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="at">df =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="cn">Inf</span>),</span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">by =</span> .<span class="dv">01</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb17-5"><a href="#cb17-5"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-6"><a href="#cb17-6"></a>    <span class="at">Density =</span> <span class="fu">dt</span>(<span class="at">x =</span> x, <span class="at">df =</span> df),</span>
<span id="cb17-7"><a href="#cb17-7"></a>    <span class="st">`</span><span class="at">degrees of freedom</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_factor</span>(df)</span>
<span id="cb17-8"><a href="#cb17-8"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb17-9"><a href="#cb17-9"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> Density, </span>
<span id="cb17-11"><a href="#cb17-11"></a>      <span class="at">group =</span> <span class="st">`</span><span class="at">degrees of freedom</span><span class="st">`</span>, </span>
<span id="cb17-12"><a href="#cb17-12"></a>      <span class="at">colour =</span> <span class="st">`</span><span class="at">degrees of freedom</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter04_files/figure-revealjs/unnamed-chunk-18-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="the-t-distribution-2" class="slide level2">
<h2>The <em>t</em> distribution</h2>
<p>For a sample of size <span class="math inline">\(n\)</span>, if</p>
<ul>
<li><span class="math inline">\(X\)</span> is a normal random variable with mean <span class="math inline">\(\mu\)</span>,</li>
<li><span class="math inline">\(\bar X\)</span> is the sample mean, and</li>
<li><span class="math inline">\(s\)</span> is the sample standard deviation,</li>
</ul>
<p>then the variable:</p>
<p><span class="math display">\[
T = \frac{\bar X - \mu} {s/\sqrt{n}}
\]</span></p>
<p>is distributed as a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\((n – 1)\)</span> degrees of freedom.</p>
</section>
<section id="confidence-intervals-and-the-t-distribution" class="slide level2">
<h2>Confidence intervals and the <em>t</em> distribution</h2>
<p>The process of using sample data to try and make useful statements about an unknown parameter, <span class="math inline">\(\theta\)</span>, is called statistical inference.</p>
<p>A confidence interval for the true value of a parameter is often obtained by:</p>
<p><span class="math display">\[
\hat \theta \pm t \times \text{SE}(\hat \theta)
\]</span> where <span class="math inline">\(\hat \theta\)</span> is the sample estimate of <span class="math inline">\(\theta\)</span> and <span class="math inline">\(t\)</span> is a quantile from the <span class="math inline">\(t\)</span> distribution with the appropriate degrees of freedom.</p>
<p>For example, to get the <span class="math inline">\(t\)</span> score for a 95% confidence interval with 9 degrees of freedom:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">df =</span> <span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.262157</code></pre>
</div>
</div>
<p>The piece that is being added and subtracted, <span class="math inline">\(t \times \text{SE}(\hat \theta)\)</span>, is often called the <em>margin of error</em>.</p>
</section>
<section id="confidence-intervals-for-a-sample-mean" class="slide level2">
<h2>Confidence intervals for a sample mean</h2>
<p>We can calculate a 95% confidence interval for a sample mean with the following information:</p>
<div style="font-size: 75%;">
<ul>
<li>sample mean <span class="math inline">\(\bar x\)</span>,</li>
<li>sample standard deviation <span class="math inline">\(s\)</span>,</li>
<li>the sample size <span class="math inline">\(n\)</span>, and</li>
<li>the 0.025th quantile of the <span class="math inline">\(t\)</span> distribution with degrees of freedom <span class="math inline">\(df=n-1\)</span>.</li>
</ul>
</div>
<div class="fragment">
<div class="absolute" style="top: 45%; left: 0px; ">
<p>A sample of size <span class="math inline">\(n\)</span> = 6 from Quetelet data</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">6</span>; df1 <span class="ot">&lt;-</span> n1<span class="dv">-1</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>( dq1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(qd_long, <span class="at">size =</span> n1) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39 42 38 36 40 38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>( mean1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dq1) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 38.83333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>( sd1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(dq1) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.041241</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>( t1 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">df =</span> df1) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.570582  2.570582</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>mean1 <span class="sc">+</span> t1 <span class="sc">*</span> sd1 <span class="sc">/</span> <span class="fu">sqrt</span>(n1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36.69118 40.97548</code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="absolute" style="top: 45%; right: 0px; ">
<p>Or, more simply…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">t.test</span>(dq1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  dq1
t = 46.6, df = 5, p-value = 8.595e-08
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 36.69118 40.97548
sample estimates:
mean of x 
 38.83333 </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="confidence-intervals-for-sample-means" class="slide level2">
<h2>Confidence intervals for sample means</h2>

<img data-src="Chapter04_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="t-as-a-test-statistic" class="slide level2">
<h2><em>t</em> as a test statistic</h2>
<p>This method can be used when the estimator <span class="math inline">\(\hat\theta\)</span> is approximately normally distributed and</p>
<p><span class="math display">\[
\frac{\hat\theta - \theta} {\text{SE}(\hat \theta)}
\]</span></p>
<p>has approximately a Student’s <em>t</em> distribution.</p>
<p>This paves the way for hypothesis testing for specific values of <span class="math inline">\(\theta\)</span>. Many of the methods you will learn in this course are based on this general rule.</p>
</section>
<section id="testing-hypotheses" class="slide level2">
<h2>Testing hypotheses</h2>
<ul>
<li>Testing hypotheses underpins a lot of scientific work.</li>
<li>A hypothesis is a proposition, a specific idea about the state of the world that can be tested with data.</li>
<li>For logical reasons, instead of measuring evidence for a hypothesis of interest, scientists will often:
<ul>
<li>specify a <strong><em>null hypotheses</em></strong>, which must be true if our hypothesis of interest is false, and</li>
<li>measure the evidence <em>against</em> the null hypothesis, usually in the form of a <em>p</em>-value.</li>
</ul></li>
</ul>
</section>
<section id="example-growth-of-alfalfa" class="slide level2">
<h2>Example: growth of alfalfa</h2>
<p>Say a farmer has 9 paddocks of alfalfa. He’s hired a new manager, and wants to know if, on average, this year’s crop is different to last year’s. He measures the yield for each paddock in year 1 and year 2, and calculates the difference.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>year1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">1.3</span>, <span class="fl">1.7</span>, <span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">2.0</span>, <span class="fl">2.0</span>, <span class="fl">2.0</span>, <span class="fl">2.2</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a>year2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.4</span>, <span class="fl">1.8</span>, <span class="fl">1.8</span>, <span class="fl">2.0</span>, <span class="fl">2.0</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>, <span class="fl">2.2</span>)</span>
<span id="cb32-3"><a href="#cb32-3"></a>diff <span class="ot">&lt;-</span> year2 <span class="sc">-</span> year1</span>
<span id="cb32-4"><a href="#cb32-4"></a>( xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(diff) ) ; ( s <span class="ot">&lt;-</span> <span class="fu">sd</span>(diff) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06666667</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08660254</code></pre>
</div>
</div>
<p>The mean difference is 0.067. On average, yields were 0.067 greater than last year.<br>
Is that convincing different from zero?</p>
<p>How likely is such a difference to have arisen just by chance, and really, if we had a million paddocks, there would be no difference?</p>
<p>What is the probability of seeing a difference of 0.067 or more in our dataset if the true mean were zero?</p>
<p>These questions can be addressed with a <span class="math inline">\(p\)</span>-value from a hypothesis test.</p>
</section>
<section id="example-growth-of-alfalfa-1" class="slide level2">
<h2>Example: growth of alfalfa</h2>
<p>The hypothesis of interest (called the “alternative” hypothesis) is:</p>
<p><span class="math inline">\(\ \ \ \ \ H_A: \mu \ne 0\)</span>, that is, the mean difference in yield <span class="math inline">\(\mu\)</span> between the two years is not zero.</p>
<p>The <strong>null</strong> hypothesis (the case if the alternative hypothesis is wrong) is:</p>
<p><span class="math inline">\(\ \ \ \ \ H_0: \mu = 0\)</span>, that is, the mean difference is zero.</p>
<p>We can test the null hypothesis using a <em>t</em> statistic <span class="math inline">\(t_0 = \frac{\bar x - \mu_0} {\text{SE}(\bar x)}\)</span>, where<br>
<span class="math inline">\(\ \ \ \ \ \mu_0 = 0\)</span> is the hypothesised value of the mean and<br>
<span class="math inline">\(\ \ \ \ \ \text{SE}(\bar x) = s/\sqrt{n}\)</span> is the (estimated) standard error of the sample mean.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>( t0 <span class="ot">&lt;-</span> (xbar <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> ( s <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">9</span>) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.309401</code></pre>
</div>
</div>
<p>The <em>p</em>-value is <span class="math inline">\(\text{Pr}(|t_{df=8}| &gt; t_0)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(t0, <span class="at">df =</span> <span class="dv">8</span>, <span class="at">lower =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04973556</code></pre>
</div>
</div>
<div class="absolute" style="bottom: 0px; right: 0px; ">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter04_files/figure-revealjs/unnamed-chunk-27-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="example-growth-of-alfalfa-2" class="slide level2">
<h2>Example: growth of alfalfa</h2>
<p>The hypothesis of interest (called the “alternative” hypothesis) is:</p>
<p><span class="math inline">\(\ \ \ \ \ H_A: \mu \ne 0\)</span>, that is, the mean difference in yield <span class="math inline">\(\mu\)</span> between the two years is not zero.</p>
<p>The <strong>null</strong> hypothesis (the case if the alternative hypothesis is wrong) is:</p>
<p><span class="math inline">\(\ \ \ \ \ H_0: \mu = 0\)</span>, that is, the mean difference is zero.</p>
<p>This can be done more easily:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">t.test</span>(diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  diff
t = 2.3094, df = 8, p-value = 0.04974
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 9.806126e-05 1.332353e-01
sample estimates:
 mean of x 
0.06666667 </code></pre>
</div>
</div>
<div class="absolute" style="bottom: 0px; right: 0px; ">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter04_files/figure-revealjs/unnamed-chunk-29-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="example-growth-of-alfalfa-3" class="slide level2">
<h2>Example: growth of alfalfa</h2>
<p>The <span class="math inline">\(p\)</span>-value of 0.05 means that, if the null hypothesis were true, only 5% of sample means would be as or more extreme than the observed value of 0.067. It is the area in orange in the graph below.</p>
<p>We can therefore reject the null hypothesis at the conventional 5% level, and conclude that, on average, yields were indeed higher this year.</p>
<p>This is an example of a paired <em>t</em> test. They two samples (year 1 and year 2) are not independent of one another because we have the same paddocks in both years. So, we take the differences, treat them like a single sample, and do a one-sample <em>t</em> test for the mean difference being zero.</p>
<p><span class="math inline">\(p\)</span>-values are random variables too.<br>
<a href="https://shiny.massey.ac.nz/anhsmith/demos/demo.p.is.rv/" class="uri">https://shiny.massey.ac.nz/anhsmith/demos/demo.p.is.rv/</a></p>
<div class="absolute" style="bottom: 0px; right: 0px; ">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter04_files/figure-revealjs/unnamed-chunk-30-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="truth-and-outcomes" class="slide level2">
<h2>Truth and outcomes</h2>
<p>In reality, the null hypothesis is either true or false.</p>
<p>The outcome of a test is either we reject the null hypothesis, or we fail to reject the null hypothesis (note, we never “confirm” or “accept” the null hypothesis – absence of evidence is not evidence of absence!).</p>
<p>This gives us four possibilities:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th><em><span class="math inline">\(H_0\)</span> is true</em></th>
<th><em><span class="math inline">\(H_0\)</span> is false</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Reject <span class="math inline">\(H_0\)</span></strong></td>
<td>Type I error</td>
<td>Correct result</td>
</tr>
<tr class="even">
<td><strong>Do not reject <span class="math inline">\(H_0\)</span></strong></td>
<td>Correct result</td>
<td>Type II error</td>
</tr>
</tbody>
</table>
<p>With probabilities usually represented by:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th><em><span class="math inline">\(H_0\)</span> is true</em></th>
<th><em><span class="math inline">\(H_0\)</span> is false</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Reject <span class="math inline">\(H_0\)</span></strong></td>
<td><span class="math inline">\(\alpha\)</span></td>
<td><span class="math inline">\(1-\beta\)</span> = “power”</td>
</tr>
<tr class="even">
<td><strong>Do not reject <span class="math inline">\(H_0\)</span></strong></td>
<td><span class="math inline">\(1 - \alpha\)</span></td>
<td><span class="math inline">\(\beta\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="truth-and-outcomes-1" class="slide level2">
<h2>Truth and outcomes</h2>
<p>The probability of making a Type I error, rejecting <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_0\)</span> is true, is set by the experimenter <em>a priori</em> (beforehand) as the significance level, <span class="math inline">\(\alpha\)</span>.</p>
<ul>
<li>Say we set <span class="math inline">\(\alpha\)</span> at the conventional 0.05. We know that, if <span class="math inline">\(H_0\)</span> is true, we have a 5% chance of rejecting <span class="math inline">\(H_0\)</span> (the Type I error rate is 0.05) and a 95% chance of not rejecting <span class="math inline">\(H_0\)</span>.</li>
</ul>
<p>The probability of retaining (not rejecting) <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_0\)</span> is false is usually represented by <span class="math inline">\(\beta\)</span> (“beta”).</p>
<ul>
<li>We usually do not know <span class="math inline">\(\beta\)</span> because it depends on <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(n\)</span> and also the <em>effect size</em> under the alternative hypothesis. These must be asserted to calculate <span class="math inline">\(\beta\)</span> and power, <span class="math inline">\(1-\beta\)</span>.</li>
</ul>
</section>
<section id="calculating-power" class="slide level2">
<h2>Calculating power</h2>
<p>The <strong><em>power</em></strong> of a hypothesis test is the probability of rejecting the null hypothesis if it is indeed false. Basically, <em>“if we’re right, what is the probability that we’ll be able to show it?”</em></p>
<p>The power of the <span class="math inline">\(t\)</span> test can be evaluated using R if you assert the effect size <span class="math inline">\(\delta\)</span>:</p>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">power.t.test</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">delta =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 10
          delta = 1
             sd = 1
      sig.level = 0.05
          power = 0.5619846
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">power.t.test</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">delta =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 50
          delta = 1
             sd = 1
      sig.level = 0.05
          power = 0.9986074
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
</div>
</div>
<p>The bigger the sample size, the bigger more power we have to detect an effect.</p>
<p>Often, experimenters might aim to have a power of 80% or more, so they will most likely reject the null if it is false.</p>
</section>
<section id="sampling-distributions" class="slide level2">
<h2>Sampling distributions</h2>
<p>The term <em>sampling distribution</em> means the distribution of the computed statistic such as the sample mean when sampling is repeated many times.</p>
<p>For a normal population,</p>
<ul>
<li><p>Student’s <span class="math inline">\(t\)</span> distribution is the sampling distribution of the mean (after rescaling).</p></li>
<li><p><span class="math inline">\(\chi^2\)</span> distribution is the sampling distribution of the sample variance <span class="math inline">\(S^2\)</span>.</p></li>
<li><p><span class="math inline">\((n-1)S^2/\sigma^2\)</span> follows <span class="math inline">\(\chi^2\)</span> distribution.</p></li>
</ul>
<p><span class="math inline">\(F\)</span> distribution is ratio of two <span class="math inline">\(\chi^2\)</span> distributions.</p>
<ul>
<li>It becomes the sampling distribution of the ratio of two sample variances <span class="math inline">\(S_1^2/S_2^2\)</span> from two normal populations (after scaling).</li>
</ul>
<p><span class="math inline">\(t\)</span> distribution is symmetric but <span class="math inline">\(\chi^2\)</span> and <span class="math inline">\(F\)</span> distributions are right skewed. - For large samples, they become normal - For <span class="math inline">\(n&gt;30\)</span>, the skew will diminish</p>
<p>For the three sampling distributions, the sample size <span class="math inline">\(n\)</span> becomes the proxy parameter, called the degrees of freedom (df).</p>
<ul>
<li><span class="math inline">\(t_{n-1}\)</span>, <span class="math inline">\(\chi_{n-1}^2\)</span> &amp; <span class="math inline">\(F_{(n_1-1),(n_2-1) }\)</span></li>
</ul>
</section>
<section id="two-sample-t-test" class="slide level2">
<h2>Two sample t-test</h2>
<ul>
<li><p>The two-sample <em>t</em>-test is a common statistical test. You have two populations, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>, with means <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span> and variances <span class="math inline">\(\sigma^2_1\)</span> and <span class="math inline">\(\sigma^2_2\)</span>, respectively.</p></li>
<li><p>We wish to test whether the two population means are equal.<br>
Null hypothesis: <span class="math inline">\(H_0:\mu=\mu_1=\mu_2\)</span><br>
Two-sided alternative hypothesis: <span class="math inline">\(H_1:\mu_1 \neq \mu_2\)</span></p></li>
<li><p>The basic <em>t</em>-test <strong><em>assumes equal variances</em></strong>; that is, <span class="math inline">\(\sigma^2_1 = \sigma^2_2\)</span>.<br>
If we make this assumption and it is false, the test may give the wrong conclusion!</p></li>
</ul>
</section>
<section id="two-sample-t-test-with-equal-variances" class="slide level2">
<h2>Two sample t-test with equal variances</h2>
<p>Under the assumption of equal variances <span class="math inline">\(\sigma^2_1 = \sigma^2_2\)</span>, we can perform a <strong>pooled-sample t-test</strong>.</p>
<p>We calculate the estimated pooled variance as:</p>
<p><span class="math display">\[s_{p}^{2} = w_{1} s_{1}^{2} +w_{2} s_{2}^{2}\]</span></p>
<p>where the <em>weights</em> are <span class="math inline">\(w_{1} =\frac{n_{1}-1}{n_{1} +n_{2}-2}\)</span> and <span class="math inline">\(w_{2} =\frac{n_{2}-1}{n_{1} +n_{2}-2}\)</span>,<br>
and <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> are the sample sizes for samples 1 and 2, respectively.</p>
<p>For the pooled case, the <span class="math inline">\(df\)</span> for the <span class="math inline">\(t\)</span>-test is simply</p>
<p><span class="math display">\[df = n_{1}+n_{2}-2\]</span></p>
</section>
<section id="two-sample-t-test-with-unequal-variances" class="slide level2">
<h2>Two sample t-test with unequal variances</h2>
<p>This is often called the “Welch test”.</p>
<p>We do not need to calculated the pooled variance <span class="math inline">\(s^2_p\)</span>;<br>
we simply use <span class="math inline">\(s^2_1\)</span> and <span class="math inline">\(s^2_2\)</span> as they are.</p>
<p>For the unpooled case, the <span class="math inline">\(df\)</span> for the test is smaller: <span class="math display">\[df=\frac{\left(\frac{s_{1}^{2}}{n_{1}} +\frac{s_{2}^{2} }{n_{2}} \right)^{2} }{\frac{1}{n_{1} -1} \left(\frac{s_{1}^{2}}{n_{1}}\right)^{2} +\frac{1}{n_{2} -1} \left(\frac{s_{2}^{2}}{n_{2} } \right)^{2}}\]</span> The <span class="math inline">\(df\)</span> doesn’t have to be an integer in this case.</p>
</section>
<section id="validity-of-equal-variance-assumption" class="slide level2">
<h2>Validity of equal variance assumption</h2>
<p>We can test the null hypothesis that the variances are equal using either a Bartlett’s test or Levene’s test. Levene’s is generally favourable over Bartlett’s.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>tv <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"https://www.massey.ac.nz/~anhsmith/data/tv.csv"</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(TELETIME<span class="sc">~</span><span class="fu">factor</span>(SEX), <span class="at">data=</span>tv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value  Pr(&gt;F)  
group  1  3.1789 0.08149 .
      44                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Highish <em>p-value</em> means there’s no strong evidence against the null hypothesis that the variances are equal. Therefore, we might feel happy to assume equal variances and use a pooled variance estimate.</p>
</section>
<section id="validity-of-equal-variance-assumption-1" class="slide level2">
<h2>Validity of equal variance assumption</h2>
<p><em>t</em>-test assuming equal variances:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">t.test</span>(TELETIME <span class="sc">~</span> <span class="fu">factor</span>(SEX), <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">data=</span>tv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  TELETIME by factor(SEX)
t = -0.7249, df = 44, p-value = 0.4723
alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0
95 percent confidence interval:
 -461.3476  217.2606
sample estimates:
mean in group 1 mean in group 2 
       1668.261        1790.304 </code></pre>
</div>
</div>
<p><em>t</em>-test <em>not</em> assuming equal variances (Welch test):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">t.test</span>(TELETIME <span class="sc">~</span> <span class="fu">factor</span>(SEX), <span class="at">data=</span>tv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  TELETIME by factor(SEX)
t = -0.7249, df = 40.653, p-value = 0.4727
alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0
95 percent confidence interval:
 -462.1384  218.0514
sample estimates:
mean in group 1 mean in group 2 
       1668.261        1790.304 </code></pre>
</div>
</div>
</section>
<section id="shiny-apps-some-not-currently-working" class="slide level2">
<h2>Shiny apps (some not currently working)</h2>
<p><a href="https://shiny.massey.ac.nz/anhsmith/demos/demo.2sample.t.test/" class="uri">https://shiny.massey.ac.nz/anhsmith/demos/demo.2sample.t.test/</a></p>
<p><a href="https://shiny.massey.ac.nz/anhsmith/demos/explore.2sample.t-test/" class="uri">https://shiny.massey.ac.nz/anhsmith/demos/explore.2sample.t-test/</a></p>
<p><a href="https://shiny.massey.ac.nz/anhsmith/demos/explore.paired.t-test/" class="uri">https://shiny.massey.ac.nz/anhsmith/demos/explore.paired.t-test/</a></p>
<p>For more on non-parametric tests, see Study Guide.</p>
</section>
<section id="test-of-proportions" class="slide level2">
<h2>Test of proportions</h2>
<p>Testing the null hypothesis that a proportion <span class="math inline">\(p=0.5\)</span><br>
Alternative hypothesis: <span class="math inline">\(p \ne 0.5\)</span></p>
<p>Say a survey of 1000 beached whales had 450 females.</p>
<div class="columns">
<div class="column">
<p>Is the population 50:50?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">prop.test</span>(<span class="dv">450</span>, <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test with continuity correction

data:  450 out of 1000, null probability 0.5
X-squared = 9.801, df = 1, p-value = 0.001744
alternative hypothesis: true p is not equal to 0.5
95 percent confidence interval:
 0.4189204 0.4814685
sample estimates:
   p 
0.45 </code></pre>
</div>
</div>
</div><div class="column">
<p>An exact version of the test</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">binom.test</span>(<span class="fu">c</span>(<span class="dv">450</span>, <span class="dv">550</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  c(450, 550)
number of successes = 450, number of trials = 1000, p-value = 0.001731
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.4188517 0.4814435
sample estimates:
probability of success 
                  0.45 </code></pre>
</div>
</div>
</div>
</div>
<p>To test for a proportion other than 0.5</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">binom.test</span>(<span class="fu">c</span>(<span class="dv">450</span>, <span class="dv">550</span>), <span class="at">p =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  c(450, 550)
number of successes = 450, number of trials = 1000, p-value &lt; 2.2e-16
alternative hypothesis: true probability of success is not equal to 0.75
95 percent confidence interval:
 0.4188517 0.4814435
sample estimates:
probability of success 
                  0.45 </code></pre>
</div>
</div>
</section>
<section id="comparing-several-proportions" class="slide level2">
<h2>Comparing several proportions</h2>
<p>Data on smokers in four group of patients<br>
(from Fleiss, 1981, <em>Statistical methods for rates and proportions</em>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>smokers  <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="dv">83</span>, <span class="dv">90</span>, <span class="dv">129</span>, <span class="dv">70</span> )</span>
<span id="cb57-2"><a href="#cb57-2"></a>patients <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="dv">86</span>, <span class="dv">93</span>, <span class="dv">136</span>, <span class="dv">82</span> )</span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="fu">prop.test</span>(smokers, patients)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    4-sample test for equality of proportions without continuity correction

data:  smokers out of patients
X-squared = 12.6, df = 3, p-value = 0.005585
alternative hypothesis: two.sided
sample estimates:
   prop 1    prop 2    prop 3    prop 4 
0.9651163 0.9677419 0.9485294 0.8536585 </code></pre>
</div>
</div>
<p>More on chi-squared tests next week.</p>
</section>
<section id="tests-for-normality" class="slide level2">
<h2>Tests for normality</h2>
<p>Testing the hypothesis that sample data came from a normally distributed population. <span class="math inline">\(H_0: X \sim N(\mu, \sigma)\)</span>.</p>
<ul>
<li>Kolmogorov-Smirnov test (based on the biggest difference between the empirical and theoretical cumulative distributions)</li>
<li>Shapiro-Wilk test (based on variance of the difference)</li>
</ul>
<p>Example: a sample of <span class="math inline">\(n\)</span> = 50 from N(100,1).</p>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb59-2"><a href="#cb59-2"></a><span class="fu">shapiro.test</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean=</span><span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  rnorm(50, mean = 100)
W = 0.98928, p-value = 0.9279</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="fu">ks.test</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>), <span class="st">"pnorm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact one-sample Kolmogorov-Smirnov test

data:  rnorm(50)
D = 0.073034, p-value = 0.9347
alternative hypothesis: two-sided</code></pre>
</div>
</div>
</div>
</div>
<p>The large p-values mean that there’s no evidence of non-normality.</p>
<p>Like all tests, they can give the wrong answer. Try with <code>set.seed(1234)</code>.</p>
</section>
<section id="can-also-use-plots-to-assess-normality" class="slide level2">
<h2>Can also use plots to assess normality</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>tv <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"https://www.massey.ac.nz/~anhsmith/data/tv.csv"</span>)</span>
<span id="cb63-2"><a href="#cb63-2"></a></span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="fu">ggplot</span>(tv, <span class="fu">aes</span>(<span class="at">sample =</span> TELETIME)) <span class="sc">+</span> </span>
<span id="cb63-4"><a href="#cb63-4"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normal quantile plot for TV viewing times"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Chapter04_files/figure-revealjs/unnamed-chunk-42-1.png" width="384" class="r-stretch quarto-figure-center"></section>
<section id="transformations" class="slide level2">
<h2>Transformations</h2>
<ul>
<li><p>It can be useful to transform skewed data to make the distribution more like a ‘normal’ if that is required for a particular analysis.</p></li>
<li><p>A linear transformation <span class="math inline">\(Y^*= a+bY\)</span> only changes the scale or centre, not the shape of the distribution.</p></li>
<li><p>Transformations can help to improve symmetry, normality, and stabilise the variance.</p></li>
</ul>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<p>Right skewed distribution is made roughly symmetric using a log transformation for no. of vehicles variable (rangitikei.* dataset)</p>

<img data-src="Chapter04_files/figure-revealjs/unnamed-chunk-43-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="a-ladder-of-powers-for-transforming-data" class="slide level2">
<h2>A Ladder of Powers for Transforming Data</h2>
<ul>
<li>Right skewed data needs a shrinking transformation</li>
<li>Left skewed data needs a stretching transformation</li>
<li>The strength or power of the transformation depends on the degree of skew.<br>
</li>
</ul>
<table>
<colgroup>
<col style="width: 9%">
<col style="width: 32%">
<col style="width: 23%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">POWER</th>
<th style="text-align: left;">Formula</th>
<th style="text-align: left;">Name</th>
<th style="text-align: left;">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;"><span class="math inline">\(x^3\)</span></td>
<td style="text-align: left;">cube</td>
<td style="text-align: left;">stretches large values</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;"><span class="math inline">\(x^2\)</span></td>
<td style="text-align: left;">square</td>
<td style="text-align: left;">stretches large values</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span class="math inline">\(x\)</span></td>
<td style="text-align: left;">raw</td>
<td style="text-align: left;">No change</td>
</tr>
<tr class="even">
<td style="text-align: left;">1/2</td>
<td style="text-align: left;"><span class="math inline">\(\sqrt{x}\)</span></td>
<td style="text-align: left;">square root</td>
<td style="text-align: left;">squashes large values</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;"><span class="math inline">\(\log{x}\)</span></td>
<td style="text-align: left;">logarithm</td>
<td style="text-align: left;">squashes large values</td>
</tr>
<tr class="even">
<td style="text-align: left;">-1/2</td>
<td style="text-align: left;"><span class="math inline">\(\frac{-1}{\sqrt{x}}\)</span></td>
<td style="text-align: left;">reciprocal root</td>
<td style="text-align: left;">squashes large values</td>
</tr>
<tr class="odd">
<td style="text-align: left;">-1</td>
<td style="text-align: left;"><span class="math inline">\(\frac{-1}{x}\)</span></td>
<td style="text-align: left;">reciprocal</td>
<td style="text-align: left;">squashes large values</td>
</tr>
</tbody>
</table>
</section>
<section id="box-cox-transformation" class="slide level2">
<h2>Box-Cox transformation</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>This is a normalising transformation based on the Box-Cox power parameter, <span class="math inline">\(\lambda\)</span>.</p>
<p>R gives a point estimate of the Box-Cox power &amp; a confidence interval.</p>
<p>Usually, we are concerned about whether the <em>residuals from a model</em> are normally distributed – put the model in the <code>lm</code> statement.</p>
<p>Sometimes, no “good” value of <span class="math inline">\(\lambda\)</span> can be found.</p>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">library</span>(lindia)</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="fu">gg_boxcox</span>(<span class="fu">lm</span>(rangitikei<span class="sc">$</span>vehicle <span class="sc">~</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter04_files/figure-revealjs/unnamed-chunk-44-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="statistical-inference-based-on-transformed-data" class="slide level2">
<h2>Statistical inference based on transformed data</h2>
<ul>
<li><p>Obtain the confidence interval using transformed data and then back transform the limits (to keep the original scale)</p>
<ul>
<li>The confidence limits calculated on log-transformed data can be exponentiated back to the raw scale (i.e., <span class="math inline">\(e^{\text{confidence limit}}\)</span>)</li>
<li>The confidence limits of square-root-transformed data can be squared back to the raw scale (ie. <span class="math inline">\({\text{confidence limit}^2}\)</span>)</li>
</ul></li>
<li><p>For hypothesis test, apply the same transformation on the value hypothesised under the null</p></li>
<li><p>Explore <a href="https://shiny.massey.ac.nz/anhsmith/demos/explore.transformations/" class="uri">https://shiny.massey.ac.nz/anhsmith/demos/explore.transformations/</a> app (not currently working)</p></li>
</ul>
</section>
<section id="example-1" class="slide level2">
<h2>Example</h2>
<p>Brain weights of <code>Animals</code> data are right-skewed.</p>
<div class="cell columns column-output-location" data-layout-align="center">
<div class="column">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="fu">data</span>(Animals, <span class="at">package =</span> <span class="st">"MASS"</span>)</span>
<span id="cb65-2"><a href="#cb65-2"></a></span>
<span id="cb65-3"><a href="#cb65-3"></a><span class="fu">bind_cols</span>( </span>
<span id="cb65-4"><a href="#cb65-4"></a>  <span class="co"># confidence intervals on raw data</span></span>
<span id="cb65-5"><a href="#cb65-5"></a>  <span class="st">`</span><span class="at">raw x</span><span class="st">`</span> <span class="ot">=</span> Animals <span class="sc">|&gt;</span> </span>
<span id="cb65-6"><a href="#cb65-6"></a>    <span class="fu">pull</span>(brain) <span class="sc">|&gt;</span> </span>
<span id="cb65-7"><a href="#cb65-7"></a>    <span class="fu">t.test</span>() <span class="sc">|&gt;</span> </span>
<span id="cb65-8"><a href="#cb65-8"></a>    <span class="fu">pluck</span>(<span class="st">"conf.int"</span>),</span>
<span id="cb65-9"><a href="#cb65-9"></a>  <span class="co"># confidence intervals on log-transformed data</span></span>
<span id="cb65-10"><a href="#cb65-10"></a>  <span class="st">`</span><span class="at">log x</span><span class="st">`</span> <span class="ot">=</span> Animals <span class="sc">|&gt;</span> </span>
<span id="cb65-11"><a href="#cb65-11"></a>    <span class="fu">pull</span>(brain) <span class="sc">|&gt;</span> </span>
<span id="cb65-12"><a href="#cb65-12"></a>    <span class="fu">log</span>() <span class="sc">|&gt;</span> </span>
<span id="cb65-13"><a href="#cb65-13"></a>    <span class="fu">t.test</span>() <span class="sc">|&gt;</span> </span>
<span id="cb65-14"><a href="#cb65-14"></a>    <span class="fu">pluck</span>(<span class="st">"conf.int"</span>),</span>
<span id="cb65-15"><a href="#cb65-15"></a>  <span class="co"># confidence intervals on log-transformed data </span></span>
<span id="cb65-16"><a href="#cb65-16"></a>  <span class="co"># and then back-transformed</span></span>
<span id="cb65-17"><a href="#cb65-17"></a>  <span class="st">`</span><span class="at">log x, CIs back-transformed</span><span class="st">`</span> <span class="ot">=</span> Animals <span class="sc">|&gt;</span> </span>
<span id="cb65-18"><a href="#cb65-18"></a>    <span class="fu">pull</span>(brain) <span class="sc">|&gt;</span> </span>
<span id="cb65-19"><a href="#cb65-19"></a>    <span class="fu">log</span>() <span class="sc">|&gt;</span> </span>
<span id="cb65-20"><a href="#cb65-20"></a>    <span class="fu">t.test</span>() <span class="sc">|&gt;</span> </span>
<span id="cb65-21"><a href="#cb65-21"></a>    <span class="fu">pluck</span>(<span class="st">"conf.int"</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-22"><a href="#cb65-22"></a>    <span class="fu">exp</span>()</span>
<span id="cb65-23"><a href="#cb65-23"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb65-24"><a href="#cb65-24"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<table>
<caption>Lower and upper confidence limits </caption>
<thead>
<tr class="header">
<th style="text-align: right;">raw x</th>
<th style="text-align: right;">log x</th>
<th style="text-align: right;">log x, CIs back-transformed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">56.88993</td>
<td style="text-align: right;">3.495101</td>
<td style="text-align: right;">32.95362</td>
</tr>
<tr class="even">
<td style="text-align: right;">1092.15293</td>
<td style="text-align: right;">5.355790</td>
<td style="text-align: right;">211.83131</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="non-parametric-tests" class="slide level2">
<h2>Non-parametric tests</h2>
<p>Non-parametric tests are light on assumptions, and can be used for highly asymmetric data (as an alternative to using transformations).</p>
<p>Many non-parametric methods rely on replacing the observed data by their <em>ranks</em>.</p>
</section>
<section id="spearmans-rank-correlation" class="slide level2">
<h2>Spearman’s Rank Correlation</h2>
<div class="columns">
<div class="column">
<p>Rank the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables, and then obtain usual Pearson correlation coefficient.</p>
<p>The plot shows non-parametric Spearman in the the upper triangle and parametric Pearson in the bottom triangle.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb66-2"><a href="#cb66-2"></a></span>
<span id="cb66-3"><a href="#cb66-3"></a>p <span class="ot">&lt;-</span> <span class="fu">ggpairs</span>(</span>
<span id="cb66-4"><a href="#cb66-4"></a>  trees, </span>
<span id="cb66-5"><a href="#cb66-5"></a>  <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">'cor'</span>, <span class="at">method =</span> <span class="st">"spearman"</span>)),</span>
<span id="cb66-6"><a href="#cb66-6"></a>  <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">'cor'</span>) </span>
<span id="cb66-7"><a href="#cb66-7"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-spear" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter04_files/figure-revealjs/fig-spear-1.png" width="480"></p>
<figcaption>Figure&nbsp;1: Comparison of Pearsonian and Spearman’s rank correlations</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="wilcoxon-signed-rank-test" class="slide level2">
<h2>Wilcoxon signed rank test</h2>
<p>A non-parametric alternative to the one-sample t-test</p>
<p><span class="math inline">\(H_0: \eta=\eta_0\)</span> where <span class="math inline">\(\eta\)</span> (Greek letter ‘eta’) is the population median</p>
<p>Based on based on ranking <span class="math inline">\((|Y-\eta_0|)\)</span>, where the ranks for data with <span class="math inline">\(Y&lt;\eta_0\)</span> are compared to the ranks for data with <span class="math inline">\(Y&gt;\eta_0\)</span></p>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="fu">wilcox.test</span>(tv<span class="sc">$</span>TELETIME, <span class="at">mu=</span><span class="dv">1680</span>, <span class="at">conf.int=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank exact test

data:  tv$TELETIME
V = 588, p-value = 0.6108
alternative hypothesis: true location is not equal to 1680
95 percent confidence interval:
 1557.5 1906.5
sample estimates:
(pseudo)median 
          1728 </code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="fu">t.test</span>(tv<span class="sc">$</span>TELETIME, <span class="at">mu=</span><span class="dv">1680</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  tv$TELETIME
t = 0.58856, df = 45, p-value = 0.5591
alternative hypothesis: true mean is not equal to 1680
95 percent confidence interval:
 1560.633 1897.932
sample estimates:
mean of x 
 1729.283 </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="mann-whitney-test" class="slide level2">
<h2>Mann-Whitney test</h2>
<p>For two group comparison, pool the two group responses and then rank the pooled data</p>
<p>Ranks for the first group are compared to the ranks for the second group</p>
<p>The null hypothesis is that the two group medians are the same: <span class="math inline">\(H_0: \eta_1=\eta_2\)</span>.</p>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="fu">wilcox.test</span>(rangitikei<span class="sc">$</span>people<span class="sc">~</span>rangitikei<span class="sc">$</span>time, <span class="at">conf.int=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  rangitikei$people by rangitikei$time
W = 30, p-value = 0.007711
alternative hypothesis: true location shift is not equal to 0
95 percent confidence interval:
 -88.99996 -10.00005
sample estimates:
difference in location 
             -36.46835 </code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="fu">t.test</span>(rangitikei<span class="sc">$</span>people<span class="sc">~</span>rangitikei<span class="sc">$</span>time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  rangitikei$people by rangitikei$time
t = -3.1677, df = 30.523, p-value = 0.003478
alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0
95 percent confidence interval:
 -102.28710  -22.13049
sample estimates:
mean in group 1 mean in group 2 
       22.71429        84.92308 </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="another-form-of-test" class="slide level2">
<h2>Another form of test</h2>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="fu">kruskal.test</span>(rangitikei<span class="sc">$</span>people<span class="sc">~</span>rangitikei<span class="sc">$</span>time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  rangitikei$people by rangitikei$time
Kruskal-Wallis chi-squared = 7.2171, df = 1, p-value = 0.007221</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="fu">wilcox.test</span>(rangitikei<span class="sc">$</span>people<span class="sc">~</span>rangitikei<span class="sc">$</span>time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  rangitikei$people by rangitikei$time
W = 30, p-value = 0.007711
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="permutation-tests" class="slide level2">
<h2>Permutation tests</h2>
<p>A permutation (or randomisation) test has the following steps:</p>
<ol type="1">
<li>Randomly permute the observed data <em>many times</em>, thereby destroying any real relationship,</li>
<li>Recalculate the test statistic <span class="math inline">\(T\)</span> for each random permutation</li>
<li>Compare the observed value of <span class="math inline">\(T\)</span> (from the actual data) with the values of <span class="math inline">\(T\)</span> under permutation.</li>
</ol>
<p>One sample hypothesis test example follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="fu">library</span>(exactRankTests)</span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="fu">perm.test</span>(tv<span class="sc">$</span>TELETIME, <span class="at">null.value=</span><span class="dv">1500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample Permutation Test

data:  tv$TELETIME
T = 79547, p-value = 2.842e-14
alternative hypothesis: true mu is not equal to 0</code></pre>
</div>
</div>
<p>For small samples, this approach is not powerful.</p>
</section>
<section id="two-group-comparison" class="slide level2">
<h2>Two group comparison</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="fu">perm.test</span>(TELETIME<span class="sc">~</span>SEX, <span class="at">distribution =</span><span class="st">'exact'</span>, <span class="at">data=</span>tv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    2-sample Permutation Test

data:  TELETIME by SEX
T = 38370, p-value = 0.471
alternative hypothesis: true mu is not equal to 0</code></pre>
</div>
</div>
<p>Also using a linear model fit (cover later)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="fu">library</span>(lmPerm)</span>
<span id="cb83-2"><a href="#cb83-2"></a><span class="fu">summary</span>(<span class="fu">lmp</span>(TELETIME<span class="sc">~</span>SEX, <span class="at">data=</span>tv))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Settings:  unique SS : numeric variables centered"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lmp(formula = TELETIME ~ SEX, data = tv)

Residuals:
      Min        1Q    Median        3Q       Max 
-1178.261  -510.793    -7.283   402.989  1130.739 

Coefficients:
    Estimate Iter Pr(Prob)
SEX      122   51     0.98

Residual standard error: 570.9 on 44 degrees of freedom
Multiple R-Squared: 0.0118, Adjusted R-squared: -0.01066 
F-statistic: 0.5255 on 1 and 44 DF,  p-value: 0.4723 </code></pre>
</div>
</div>
<p>Read the study guide example for bootstrap tests (not examined)</p>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<p>Basic methods of inference include:</p>
<ul>
<li>estimating a population parameter (e.g.&nbsp;mean) using a sample of values,</li>
<li>estimating standard deviation of a sample estimate using the standard error,</li>
<li>constructing confidence intervals for an estimate, and</li>
<li>testing hypotheses about particular values of the population parameter.</li>
</ul>
<p>Inference is relatively easy for normally distributed populations.</p>
<p>Student’s <em>t</em>-tests include:</p>
<ul>
<li>one-sample <em>t</em>-test, including paired-sample <em>t</em>-test for a difference of zero</li>
<li>two-sample <em>t</em>-test assuming equal variances (estimating pooled variance)</li>
<li>two-sample <em>t</em>-test not assuming equal variances (Welch test)</li>
</ul>
<p>The <em>t</em>-test is generally robust for non-normal populations (especially for large samples).</p>
<p>Power transformations, such as square-root, log, or Box-Cox aim to reduce skewness.</p>
<p>Non-parametric tests can be used for non-normal data, but they are usually less powerful than parametric tests.</p>
<!-- ## Exercises -->
<!-- download.file("<https://www.massey.ac.nz/~kgovinda/220exer/Chap3moreexamples.R>", destfile="Chap3moreexamples.R") -->
<!-- download.file("<https://www.massey.ac.nz/~kgovinda/220exer/chapter-3-exercises.html>", destfile="chapter-3-exercises.html") -->
<!-- install.packages("remotes") -->
<!-- remotes::install_github("ricompute/ricomisc") -->
<!-- ricomisc::rstudio_viewer("chapter-3.html", file_path = NULL) -->


<img src="img/L_Color.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p><a href="https://anhsmith.github.io/161250/slides.html">161250 Data Analysis</a></p>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>