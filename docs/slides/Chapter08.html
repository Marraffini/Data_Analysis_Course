<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <title>161250 Data Analysis - Chapter 8:Analysis of Variance (ANOVA) and Analysis of Covariance (ANCOVA)</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Chapter 8:<br>Analysis of Variance (ANOVA) and Analysis of Covariance (ANCOVA)</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="learning-objectives" class="slide level2">
<h2>Learning Objectives</h2>
<ul>
<li>Define and understand an ANOVA</li>
<li>Use a one-way ANOVA on example data</li>
<li>Understand and calculate an ANOVA table</li>
<li>Describe Tukey’s post hoc tests and assumptions of ANOVAs</li>
<li>Understand the difference between one-way and two-way ANOVAs</li>
</ul>
</section>
<section id="anova" class="slide level2">
<h2>ANOVA</h2>
<ul>
<li><p>Analysis of variance, or ANOVA, is an approach to comparing data with multiple means across different groups, and allows us to see patterns and trends within complex and varied data.</p></li>
<li><p>Used for categorical or grouped data.</p></li>
<li><p>Often data from experiments (treatments make good factors).</p></li>
<li><p>EDA bar, points, or box plots are options to show differences between groups.</p></li>
</ul>
</section>
<section id="one-way-single-factor-anova-model" class="slide level2">
<h2>One-way (single factor) ANOVA model</h2>
<ul>
<li>fabric burn-time data</li>
</ul>
<table>
<thead>
<tr class="header">
<th>fabric 1</th>
<th>fabric 2</th>
<th>fabric 3</th>
<th>fabric 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>17.8</td>
<td>11.2</td>
<td>11.8</td>
<td>14.9</td>
</tr>
<tr class="even">
<td>16.2</td>
<td>11.4</td>
<td>11</td>
<td>10.8</td>
</tr>
<tr class="odd">
<td>17.5</td>
<td>15.8</td>
<td>10</td>
<td>12.8</td>
</tr>
<tr class="even">
<td>17.4</td>
<td>10</td>
<td>9.2</td>
<td>10.7</td>
</tr>
<tr class="odd">
<td>15</td>
<td>10.4</td>
<td>9.2</td>
<td>10.7</td>
</tr>
</tbody>
</table>
<ul>
<li>Can we regard the mean burn times of the four fabrics as equal?<br>

<ul>
<li>fabric 1 seems to take longer time to burn</li>
</ul></li>
<li>Start with hypotheses and EDA to visualize groups</li>
</ul>
</section>
<section id="one-way-anova-hypotheses" class="slide level2">
<h2>One-way ANOVA Hypotheses</h2>
<ul>
<li><span class="math inline">\(H_0\)</span>: The mean burn times are equal for the four fabrics</li>
<li><span class="math inline">\(H_a\)</span>: The mean burn time of at least one fabric is different.</li>
</ul>
</section>
<section id="one-way-anova" class="slide level2">
<h2>One-way ANOVA</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>fabric<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">"../data/fabric.txt"</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>fabric <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(fabric), <span class="at">y=</span>burntime))<span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_cl_boot"</span>, <span class="at">colour =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-1-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>fabric <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(fabric), <span class="at">y=</span>burntime))<span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="fu">stat_summary_bin</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"bar"</span>, <span class="at">orientation =</span> <span class="st">'x'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-1-2.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="one-way-single-factor-anova-model-1" class="slide level2">
<h2>One-way (single factor) ANOVA model</h2>

<img data-src="img/oneway.png" class="r-stretch"></section>
<section id="anova-table" class="slide level2">
<h2>ANOVA table</h2>
<blockquote>
<p>observation = mean + effect + error</p>
</blockquote>
<blockquote>
<p>SS Total = SS Factor + SS Error</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(burntime <span class="sc">~</span> fabric, <span class="at">data =</span> fabric))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
fabric       3 120.50   40.17   13.89 0.000102 ***
Residuals   16  46.26    2.89                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>fabric effect on burntime is highly significant.
<ul>
<li>In other words, the null hypothesis of equal mean burntime is rejected.
<ul>
<li>Or alternatively the mean burntime is different for <strong>at least</strong> one fabric</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="anova-table-1" class="slide level2">
<h2>ANOVA table</h2>
<p>How are these values calculated?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
fabric       3 120.50   40.17   13.89 0.000102 ***
Residuals   16  46.26    2.89                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">SS</th>
<th style="text-align: left;">df</th>
<th style="text-align: center;">MeanSq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FACTOR</td>
<td style="text-align: left;">k-1</td>
<td style="text-align: center;">FACTOR SS/(k-1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">n-k</td>
<td style="text-align: center;">ERROR SS/(n-k)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TOTAL</td>
<td style="text-align: left;">n-1</td>
<td style="text-align: center;">TOTAL SS/(n-1)</td>
</tr>
</tbody>
</table>
</section>
<section id="anova-table-2" class="slide level2">
<h2>ANOVA table</h2>
<p>Calculating F values of a factor:</p>
<p><span class="math inline">\(F = \frac{MS_{Factor}}{MS_{Error}}\)</span></p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">SS</th>
<th style="text-align: left;">df</th>
<th style="text-align: center;">MeanSq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FACTOR</td>
<td style="text-align: left;">k-1</td>
<td style="text-align: center;">FACTOR SS/(k-1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">n-k</td>
<td style="text-align: center;">ERROR SS/(n-k)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TOTAL</td>
<td style="text-align: left;">n-1</td>
<td style="text-align: center;">TOTAL SS/(n-1)</td>
</tr>
</tbody>
</table>
</section>
<section id="anova-table-practice" class="slide level2">
<h2>ANOVA table practice</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">SS</th>
<th style="text-align: left;">df</th>
<th style="text-align: left;">MeanSq</th>
<th style="text-align: left;">F- value</th>
<th style="text-align: center;">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FACTOR</td>
<td style="text-align: left;">k-1</td>
<td style="text-align: left;">FACTOR SS/(k-1)</td>
<td style="text-align: left;">MSF/MSE</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">n-k</td>
<td style="text-align: left;">ERROR SS/(n-k)</td>
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">TOTAL</td>
<td style="text-align: left;">n-1</td>
<td style="text-align: left;">TOTAL SS/(n-1)</td>
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">SS</th>
<th style="text-align: left;">df</th>
<th style="text-align: left;">MeanSq</th>
<th style="text-align: left;">F- value</th>
<th style="text-align: center;">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fabric</td>
<td style="text-align: left;">120.5</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: left;">46.3</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">TOTAL</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</section>
<section id="reminder-on-p-values" class="slide level2">
<h2>Reminder on P values</h2>
<p>In null-hypothesis significance testing, the p-value is the probability of obtaining test results at least as extreme as the result actually observed, under the assumption that the null hypothesis is correct.</p>
<p>A very small p-value means that such an extreme observed outcome would be very unlikely under the null hypothesis.</p>
<p>We calculate them based on our theoretical sampling distributions (normal, <span class="math inline">\(t\)</span>, <span class="math inline">\(F\)</span>, <span class="math inline">\(\chi^2\)</span>)</p>
</section>
<section id="reminder-of-sampling-distributions" class="slide level2">
<h2>Reminder of Sampling Distributions</h2>
<p>A sampling distribution is a probabilistic model of sampling variation–it describes the behaviour of some sample statistic</p>
<p>For a normal population, when the population parameters and are known, we can easily derive the sampling distributions of the sample mean or sample variance.</p>
<p>When the population parameters are unknown, we have to estimate them from data.</p>
</section>
<section id="reminder-of-sampling-distributions-1" class="slide level2">
<h2>Reminder of Sampling Distributions</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-4-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="graphical-comparison-of-means" class="slide level2">
<h2>Graphical comparison of means</h2>
<ul>
<li>The graph below shows individual 95% confidence intervals for the fabric means</li>
</ul>

<img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="one-way-anova-model-assumptions" class="slide level2">
<h2>One-way ANOVA model Assumptions</h2>
<ul>
<li><p>Residuals are randomly and normally distributed</p></li>
<li><p>Residuals must be independent of means.</p>
<ul>
<li>If SD increases with mean, try square root or logarithmic transformation.</li>
</ul></li>
<li><p>The ANOVA model assumes equal SD for the treatments.</p></li>
<li><p>If experimental errors are more in some subgroups, divide the problem into separate ones.</p></li>
<li><p>Positive correlation among residuals leads to under estimation of error variance; negative correlation leads to overestimation.<br>
</p></li>
</ul>
<p><em>These assumptions are harder to validate to small experimental design data</em></p>
</section>
<section id="visualize-assumptions" class="slide level2">
<h2>Visualize assumptions</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">plot</span>(<span class="fu">aov</span>(burntime <span class="sc">~</span> fabric, <span class="at">data =</span> fabric))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-7-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-7-2.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-7-3.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-7-4.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualize-assumptions-1" class="slide level2">
<h2>Visualize assumptions</h2>

<img data-src="Chapter08_files/figure-revealjs/fig-meansd-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">Figure&nbsp;1: SD vs mean for four fabrics</p><ul>
<li><p>Residuals must be independent of means.</p>
<ul>
<li>If SD increases with mean, try square root or logarithmic transformation.</li>
</ul></li>
</ul>
<p>With only four fabrics in the sample, it is difficult to make any definitive claim.</p>
<p>If the assumptions were valid, we would expect the four points to fall approximately along a horizontal band indicating constant standard deviations, and hence variances, regardless of the means of the groups.</p>
<p>This figure suggests that this is the case, so the assumption of equal variances appears to be valid.</p>
</section>
<section id="equal-variance" class="slide level2">
<h2>Equal variance</h2>
<p><strong>Bartlett’s test</strong>: - null hypothesis: equal variances - but it has an assumption of its own (response variable must be normally distributed)</p>
<p><strong>Levene’s test</strong> - null hypothesis: equal variances - is applicable for any continuous distribution</p>
<div class="cell" data-layout-align="center" data-warnings="false">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">bartlett.test</span>(burntime <span class="sc">~</span> fabric, <span class="at">data =</span> fabric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  burntime by fabric
Bartlett's K-squared = 2.6606, df = 3, p-value = 0.447</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(burntime <span class="sc">~</span> fabric, <span class="at">data =</span> fabric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  3  0.1788 0.9092
      16               </code></pre>
</div>
</div>
</section>
<section id="what-if-the-equal-variance-assumption-is-violated" class="slide level2">
<h2>What if the equal variance assumption is violated?</h2>
<p>ANOVA’s are considered to be fairly robust against violations of the equal variances assumption as long as each group has the same sample size.</p>
<p>If this assumption is violated, the most common way to deal with it is to transform the response variable using one of the three transformations:</p>
<ol type="1">
<li><p>Log Transformation: Transform the response variable from y to log(y).</p></li>
<li><p>Square Root Transformation: Transform the response variable from y to √y.</p></li>
<li><p>Cube Root Transformation: Transform the response variable from y to y1/3.</p></li>
</ol>
<p>By performing these transformations, the problem of heteroscedasticity typically goes away.</p>
</section>
<section id="normality" class="slide level2">
<h2>Normality</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>aov_fabric <span class="ot">&lt;-</span> <span class="fu">aov</span>(burntime <span class="sc">~</span> fabric, <span class="at">data =</span> fabric)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">shapiro.test</span>(aov_fabric<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  aov_fabric$residuals
W = 0.88926, p-value = 0.02606</code></pre>
</div>
</div>
<p>ANOVAs are robust to mild issues of non-normality</p>
<p>But if have issues with normality and unequal variance try transformations</p>
</section>
<section id="when-transformations-do-not-help" class="slide level2">
<h2>When transformations do not help:</h2>
<ul>
<li><p>Weighted least squares regression: This type of regression assigns a weight to each data point based on the variance of its fitted value.</p>
<ul>
<li>Essentially, this gives small weights to data points that have higher variances, which shrinks their squared residuals. When the proper weights are used, this can eliminate the problem of heteroscedasticity.</li>
</ul></li>
<li><p>Non-parametric test:</p>
<ul>
<li>Kruskal-Wallis Test is the non-parametric version of a one-way ANOVA</li>
</ul></li>
</ul>
</section>
<section id="tukey-hsd" class="slide level2">
<h2>Tukey HSD</h2>
<ul>
<li>Tukey HSD (Honest Significant Differences) plot allows pairwise comparison of treatment means.</li>
<li>Which fabric types have different burn times? (remember the alternative hypothesis of a one-way ANOVA is <em>at least</em> one of the means are different)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = burntime ~ fabric, data = fabric)

$fabric
                   diff      lwr      upr     p adj
Fabric 2-Fabric 1 -5.02 -8.09676 -1.94324 0.0013227
Fabric 3-Fabric 1 -6.54 -9.61676 -3.46324 0.0000851
Fabric 4-Fabric 1 -4.80 -7.87676 -1.72324 0.0019981
Fabric 3-Fabric 2 -1.52 -4.59676  1.55676 0.5094118
Fabric 4-Fabric 2  0.22 -2.85676  3.29676 0.9968426
Fabric 4-Fabric 3  1.74 -1.33676  4.81676 0.3968476</code></pre>
</div>
</div>
</section>
<section id="tukey-hsd-interval-plot" class="slide level2">
<h2>Tukey HSD (Interval Plot)</h2>

<img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="two-way-two-factor-anova" class="slide level2">
<h2>Two way (two factor) ANOVA</h2>
<ul>
<li><p>Two factors are present.</p></li>
<li><p>A two-way ANOVA is used to estimate how the mean of a continuous variable changes according to the levels of two categorical variables.</p></li>
<li><p>Use a two-way ANOVA when you want to know how two independent variables, in combination, affect a dependent variable.</p></li>
<li><p>Very similar to multiple regression but with categorical variables.</p></li>
</ul>
</section>
<section id="two-way-two-factor-anova-example" class="slide level2">
<h2>Two way (two factor) ANOVA example</h2>
<ul>
<li>Example: We will use the built in data ToothGrowth. It contains data from a study evaluating the effect of vitamin C on tooth growth in Guinea pigs. The experiment has been performed on 60 pigs, where each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, (orange juice or ascorbic acid (a form of vitamin C and coded as VC). Tooth length was measured and a sample of the data is shown below.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>   len supp dose
1  4.2   VC  0.5
2 11.5   VC  0.5
3  7.3   VC  0.5
4  5.8   VC  0.5
5  6.4   VC  0.5
6 10.0   VC  0.5</code></pre>
</div>
</div>
</section>
<section id="run-a-two-way-anova" class="slide level2">
<h2>Run a Two-way ANOVA</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(len<span class="sc">~</span>dose<span class="sc">+</span>supp, <span class="at">data=</span>ToothGrowth))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
dose         2 2426.4  1213.2   82.81  &lt; 2e-16 ***
supp         1  205.3   205.3   14.02 0.000429 ***
Residuals   56  820.4    14.7                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>A two-way ANOVA tests two null hypotheses at the same time:</p>
<ul>
<li>All group means are equal at each level of the first variable</li>
<li>All group means are equal at each level of the second variable</li>
</ul>
</section>
<section id="two-way-model-fit" class="slide level2">
<h2>Two-way model fit</h2>
<blockquote>
<p>Model:<br>
Observation = Overall Mean + Factor 1 Effect + Factor 2 Effect + Error</p>
</blockquote>
<ul>
<li><span class="math inline">\(H_0\)</span>: factor 1 means are equal; factor 2 means are equal</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
dose         2 2426.4  1213.2   82.81  &lt; 2e-16 ***
supp         1  205.3   205.3   14.02 0.000429 ***
Residuals   56  820.4    14.7                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Supplement and dose effects are significant at 5% level.</p>
</section>
<section id="main-effect-plots" class="slide level2">
<h2>Main effect plots</h2>
<ul>
<li>Simply plot of response means for factor levels</li>
</ul>

<img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="tukey-hsd-1" class="slide level2">
<h2>Tukey HSD</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>teeth <span class="ot">&lt;-</span> <span class="fu">aov</span>(len<span class="sc">~</span>supp<span class="sc">+</span>dose, <span class="at">data=</span>ToothGrowth)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">TukeyHSD</span>(teeth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = len ~ supp + dose, data = ToothGrowth)

$supp
      diff       lwr       upr     p adj
VC-OJ -3.7 -5.679762 -1.720238 0.0004293

$dose
          diff       lwr       upr p adj
D1-D0.5  9.130  6.215909 12.044091 0e+00
D2-D0.5 15.495 12.580909 18.409091 0e+00
D2-D1    6.365  3.450909  9.279091 7e-06</code></pre>
</div>
</div>
</section>
<section id="summary-so-far" class="slide level2">
<h2>Summary so far</h2>
<ul>
<li>ANOVA: 1 and 2 factor</li>
<li>ANOVA table</li>
<li>Assumptions</li>
<li>Tukey’s HSD</li>
</ul>
</section>
<section id="learning-objectives-part-2" class="slide level2">
<h2>Learning Objectives: Part 2</h2>
<ul>
<li>Understand the use of interactions in linear models</li>
<li>Use a two-way ANOVA with interactions on example data</li>
<li>Understand and calculate an ANOVA table when interactions are present</li>
<li>Describe Tukey’s post hoc tests and assumptions of ANOVAs with interactions</li>
<li>Understand the difference and similarities between this chapter and previous linear models covered</li>
<li>Review non-parametric options</li>
</ul>
</section>
<section id="interaction-effect" class="slide level2">
<h2>Interaction effect</h2>
<ul>
<li>Whether Factor A effects are constant over Factor B effects or Factor B effects are constant over Factor A effects?
<ul>
<li>If the answer is no, then there is an interaction between A &amp; B.</li>
</ul></li>
<li>Example:
<ul>
<li>Temperature and pressure are factors affecting the yield in chemical experiments.</li>
<li>They do <code>interact</code> in a mechanistic sense.</li>
</ul></li>
</ul>
<p><code>Interaction</code> may or may not have physical meaning.</p>
</section>
<section id="two-way-anova-and-interaction-effects" class="slide level2">
<h2>Two-way ANOVA and Interaction effects</h2>
<p>A two-way ANOVA with interaction tests three null hypotheses at the same time:</p>
<ul>
<li>All group means are equal at each level of the first variable</li>
<li>All group means are equal at each level of the second variable</li>
<li>There is no interaction effect between the two variables</li>
</ul>
</section>
<section id="interaction-plots" class="slide level2">
<h2>Interaction Plots</h2>
<ul>
<li>In the absence of interaction, the plotted means of factor will be roughly parallel
<ul>
<li>see Plot 1. A &amp; B do not interact.</li>
</ul></li>
<li>If the the plotted means of factor crossings are far from parallel, then there is interaction
<ul>
<li>Plot 2 shows extreme (antagonistic) interaction between A &amp; B.</li>
</ul></li>
</ul>

<img data-src="img/interaction.png" class="r-stretch"></section>
<section id="interaction-plot-for-zooplankton-data" class="slide level2">
<h2>Interaction Plot for Zooplankton data</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb20-2"><a href="#cb20-2"></a>p1<span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> supp, <span class="at">y =</span> len, <span class="at">group=</span>dose, <span class="at">colour=</span>dose)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">"point"</span>)<span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">"line"</span>)<span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">mean</span>(ToothGrowth<span class="sc">$</span>len), <span class="at">slope=</span><span class="dv">0</span>)<span class="sc">+</span> </span>
<span id="cb20-6"><a href="#cb20-6"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Dose*Supplement Interaction effect"</span>)</span>
<span id="cb20-7"><a href="#cb20-7"></a></span>
<span id="cb20-8"><a href="#cb20-8"></a>p2<span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> dose, <span class="at">y =</span> len, <span class="at">group=</span>supp, <span class="at">colour=</span>supp)) <span class="sc">+</span><span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">"point"</span>)<span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">"line"</span>)<span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">mean</span>(ToothGrowth<span class="sc">$</span>len), <span class="at">slope=</span><span class="dv">0</span>)<span class="sc">+</span> </span>
<span id="cb20-11"><a href="#cb20-11"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Dose*Supplement Interaction effect"</span>)</span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb20-13"><a href="#cb20-13"></a>p1<span class="sc">+</span>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch quarto-figure-center"><ul>
<li>Interaction effect may be present</li>
</ul>
</section>
<section id="two-way-model-fit-1" class="slide level2">
<h2>Two-way model fit</h2>
<blockquote>
<p>observation = mean + Factor A + Factor B + interaction effect + error</p>
</blockquote>
<ul>
<li><p>The above model is known as <code>multiplicative</code> model</p></li>
<li><p>If interaction effect is ignored, we deal with an <code>additive</code> model</p></li>
</ul>
</section>
<section id="two-way-model-fit-2" class="slide level2">
<h2>Two-way model fit</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>ToothGrowth <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">aov</span>(<span class="at">formula =</span> len <span class="sc">~</span> supp <span class="sc">*</span> dose) <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
supp         1  205.4   205.4  15.572 0.000231 ***
dose         2 2426.4  1213.2  92.000  &lt; 2e-16 ***
supp:dose    2  108.3    54.2   4.107 0.021860 *  
Residuals   54  712.1    13.2                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="residual-diagnostics" class="slide level2">
<h2>Residual diagnostics</h2>

<img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-20-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="interpreting-interactions" class="slide level2">
<h2>Interpreting interactions</h2>
<ul>
<li><p>If an interaction term is significant, the effect of Factor A <strong>depends</strong> on Factor B (and vice versa)</p></li>
<li><p>Use interaction plots to visualize</p></li>
<li><p>Posthoc tests to examine different level combinations</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">TukeyHSD</span>(modl)<span class="sc">$</span><span class="st">`</span><span class="at">supp:dose</span><span class="st">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 diff        lwr        upr        p adj
VC:D0.5-OJ:D0.5 -5.25 -10.048124 -0.4518762 2.425209e-02
OJ:D1-OJ:D0.5    9.47   4.671876 14.2681238 4.612304e-06
VC:D1-OJ:D0.5    3.54  -1.258124  8.3381238 2.640208e-01
OJ:D2-OJ:D0.5   12.83   8.031876 17.6281238 2.125153e-09
VC:D2-OJ:D0.5   12.91   8.111876 17.7081238 1.769939e-09
OJ:D1-VC:D0.5   14.72   9.921876 19.5181238 2.985967e-11
VC:D1-VC:D0.5    8.79   3.991876 13.5881238 2.100948e-05
OJ:D2-VC:D0.5   18.08  13.281876 22.8781238 4.855005e-13
VC:D2-VC:D0.5   18.16  13.361876 22.9581238 4.821699e-13
VC:D1-OJ:D1     -5.93 -10.728124 -1.1318762 7.393032e-03
OJ:D2-OJ:D1      3.36  -1.438124  8.1581238 3.187361e-01
VC:D2-OJ:D1      3.44  -1.358124  8.2381238 2.936430e-01
OJ:D2-VC:D1      9.29   4.491876 14.0881238 6.908163e-06
VC:D2-VC:D1      9.37   4.571876 14.1681238 5.774013e-06
VC:D2-OJ:D2      0.08  -4.718124  4.8781238 1.000000e+00</code></pre>
</div>
</div>
</section>
<section id="interpreting-interactions-1" class="slide level2">
<h2>Interpreting interactions</h2>

<img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="importance-of-interactions" class="slide level2">
<h2>Importance of interactions</h2>
<ul>
<li><p>When you have statistically significant interaction effects, you can’t interpret the main effects without considering the interactions</p></li>
<li><p>Interactions can be used to control for unhelpful variation (blocking effect in experiments)</p></li>
<li><p>Interactions can be mechanistically meaningful</p></li>
</ul>
</section>
<section id="anova-extensions-and-inference" class="slide level2">
<h2>ANOVA extensions and inference</h2>
<p>Linear models can theoretically be performed with an infinite amount of predictors</p>
<p>The more predictors the more samples needed, your effect sample number is no longer your total sample size but the lowest treatment</p>
<p>Interaction effects with more than 3 (sometimes even more than 2) become very difficult to interpret and visualize</p>
<p>Good experimental design and causal thinking can aid in analysis design, design test then collect data, it is much harder the other way around</p>
</section>
<section id="indicator-variables" class="slide level2">
<h2>Indicator variables</h2>
<ul>
<li>Indicator variables are used if the predictor is qualitative rather than quantitative.
<ul>
<li>Consider gender, a categorical variable.
<ul>
<li>Let <span class="math inline">\(I_1\)</span> be an indicator variable that takes a value 1 for males and 0 for females.<br>
</li>
<li>Let <span class="math inline">\(I_2\)</span> takes 1 for females and 0 for males.</li>
<li>Note only one of <span class="math inline">\(I_1\)</span> &amp; <span class="math inline">\(I_2\)</span> is sufficient.</li>
</ul></li>
</ul></li>
<li>The minimum number of indicator variables needed is related to degrees of freedom.</li>
</ul>
</section>
<section id="anova-through-regression" class="slide level2">
<h2>ANOVA through regression</h2>
<ul>
<li>Consider the burn-time data for the four fabrics.
<ul>
<li>The four fabric types are categorical.</li>
<li>Define-
<ul>
<li><span class="math inline">\(I_1\)</span> = 1 for fabric 1 and 0 otherwise</li>
<li><span class="math inline">\(I_2\)</span> = 1 for fabric 2 and 0 otherwise</li>
<li><span class="math inline">\(I_3\)</span> = 1 for fabric 3 and 0 otherwise</li>
<li><span class="math inline">\(I_4\)</span> = 1 for fabric 4 and 0 otherwise</li>
</ul></li>
</ul></li>
<li>Note that any THREE indicator variables are sufficient for the four fabrics.
<ul>
<li>3 df for 4 fabrics</li>
</ul></li>
</ul>
</section>
<section id="regression-summary" class="slide level2">
<h2>Regression summary</h2>
<ul>
<li>Regress the burn-time response on the indicator variables <span class="math inline">\(I_1\)</span>,<span class="math inline">\(I_2\)</span>, <span class="math inline">\(I_3\)</span> &amp; <span class="math inline">\(I_4\)</span></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>   burntime   fabric I1 I2 I3 I4
1      17.8 Fabric 1  1  0  0  0
2      16.2 Fabric 1  1  0  0  0
3      17.5 Fabric 1  1  0  0  0
4      17.4 Fabric 1  1  0  0  0
5      15.0 Fabric 1  1  0  0  0
6      11.2 Fabric 2  0  1  0  0
7      11.4 Fabric 2  0  1  0  0
8      15.8 Fabric 2  0  1  0  0
9      10.0 Fabric 2  0  1  0  0
10     10.4 Fabric 2  0  1  0  0
11     11.8 Fabric 3  0  0  1  0
12     11.0 Fabric 3  0  0  1  0
13     10.0 Fabric 3  0  0  1  0
14      9.2 Fabric 3  0  0  1  0
15      9.2 Fabric 3  0  0  1  0
16     14.9 Fabric 4  0  0  0  1
17     10.8 Fabric 4  0  0  0  1
18     12.8 Fabric 4  0  0  0  1
19     10.7 Fabric 4  0  0  0  1
20     10.7 Fabric 4  0  0  0  1</code></pre>
</div>
</div>
</section>
<section id="regression-and-anova" class="slide level2">
<h2>Regression and ANOVA</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = burntime ~ I1 + I2 + I3, data = fabric)

Residuals:
   Min     1Q Median     3Q    Max 
-1.780 -1.205 -0.460  0.775  4.040 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  11.9800     0.7604  15.754 3.65e-11 ***
I1            4.8000     1.0754   4.463 0.000392 ***
I2           -0.2200     1.0754  -0.205 0.840485    
I3           -1.7400     1.0754  -1.618 0.125206    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.7 on 16 degrees of freedom
Multiple R-squared:  0.7226,    Adjusted R-squared:  0.6706 
F-statistic: 13.89 on 3 and 16 DF,  p-value: 0.0001016</code></pre>
</div>
</div>
<ul>
<li>Compare with the one-way output</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
fabric       3 120.50   40.17   13.89 0.000102 ***
Residuals   16  46.26    2.89                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="regression-and-anova-1" class="slide level2">
<h2>Regression and ANOVA</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>fabric <span class="sc">|&gt;</span> <span class="fu">lm</span>(<span class="at">formula =</span> burntime<span class="sc">~</span>I1<span class="sc">+</span>I2<span class="sc">+</span>I3) <span class="sc">|&gt;</span> <span class="fu">anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: burntime
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
I1         1 111.521 111.521 38.5718 1.248e-05 ***
I2         1   1.408   1.408  0.4871    0.4952    
I3         1   7.569   7.569  2.6179    0.1252    
Residuals 16  46.260   2.891                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>Compare with the one-way output</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = burntime ~ fabric, data = fabric)

$fabric
                   diff      lwr      upr     p adj
Fabric 2-Fabric 1 -5.02 -8.09676 -1.94324 0.0013227
Fabric 3-Fabric 1 -6.54 -9.61676 -3.46324 0.0000851
Fabric 4-Fabric 1 -4.80 -7.87676 -1.72324 0.0019981
Fabric 3-Fabric 2 -1.52 -4.59676  1.55676 0.5094118
Fabric 4-Fabric 2  0.22 -2.85676  3.29676 0.9968426
Fabric 4-Fabric 3  1.74 -1.33676  4.81676 0.3968476</code></pre>
</div>
</div>
</section>
<section id="analysis-of-covariance-ancova" class="slide level2">
<h2>Analysis of Covariance (ANCOVA)</h2>
<p>Analysis of covariance (ANCOVA) is a statistical method that combines linear regression and analysis of variance (ANOVA) to evaluate the relationship between a response variable and various independent variables while controlling for covariates.</p>
<ul>
<li>Indicator variables are used as additional regressors along with a quantitative predictor (covariate).</li>
</ul>
</section>
<section id="data-example-test-anxiety" class="slide level2">
<h2>Data example: test anxiety</h2>
<p>Researchers investigated the effect of exercises in reducing the level of anxiety, where they measured the anxiety score of three groups of individuals practicing physical exercises at different levels (grp1: low, grp2: moderate and grp3: high).</p>
<p>The anxiety score was measured pre- and 6-months post-exercise training programs. It is expected that any reduction in the anxiety by the exercises programs would also depend on the participant’s basal level of anxiety score.</p>
<p>In this analysis we use the pretest anxiety score (<code>pretest</code>) as the covariate and are interested in possible differences between group with respect to the post-test anxiety scores.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  id    group pretest posttest
  &lt;fct&gt; &lt;fct&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1 15    grp1     19.8     19.4
2 30    grp2     19.3     17.7
3 33    grp3     15.5     11  </code></pre>
</div>
</div>
</section>
<section id="interaction" class="slide level2">
<h2>Interaction</h2>
<p>Are the regression slopes the same?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>              Df Sum Sq Mean Sq F value Pr(&gt;F)    
group          2  72.13   36.07 203.973 &lt;2e-16 ***
pretest        1 101.29  101.29 572.828 &lt;2e-16 ***
group:pretest  2   0.04    0.02   0.127  0.881    
Residuals     39   6.90    0.18                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Interaction term is not significant (at sig. level of 5%).</p>
</section>
<section id="check-assumptions" class="slide level2">
<h2>Check assumptions</h2>
<p>Linearity:</p>

<img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-30-1.png" width="960" class="r-stretch quarto-figure-center"><p>Appears to be a linear relationship in each training group</p>
</section>
<section id="assumptions" class="slide level2">
<h2>Assumptions</h2>
<p>Residuals:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-31-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-31-2.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-31-3.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-31-4.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="assumptions-1" class="slide level2">
<h2>Assumptions</h2>
<p>Normality:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  variable                 statistic p.value
  &lt;chr&gt;                        &lt;dbl&gt;   &lt;dbl&gt;
1 summary(model$residuals)     0.964   0.849</code></pre>
</div>
</div>
<p>The Shapiro Wilk test was not significant (<span class="math inline">\(\alpha = 0.05\)</span>), so we can assume normality of residuals</p>
<p>Equal variance:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  2  0.2604  0.772
      42               </code></pre>
</div>
</div>
<p>The Levene’s test was not significant (<span class="math inline">\(\alpha = 0.05\)</span>), so we can assume homogeneity of the residual variances for all groups.</p>
</section>
<section id="ancova-fit" class="slide level2">
<h2>ANCOVA fit</h2>
<p>Estimates are the slope in each treatment (<code>group</code>). Remember that R assigns the first (alphabetical) level of the treatment to <code>Intercept</code></p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = posttest ~ pretest + group, data = anxiety)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.00467 -0.29485 -0.02866  0.33846  0.68799 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.94088    0.72574  -1.296 0.202074    
pretest      1.02775    0.04202  24.461  &lt; 2e-16 ***
groupgrp2   -0.64112    0.15137  -4.235 0.000126 ***
groupgrp3   -2.98463    0.15027 -19.862  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4114 on 41 degrees of freedom
Multiple R-squared:  0.9615,    Adjusted R-squared:  0.9587 
F-statistic: 341.5 on 3 and 41 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="ancova-fit-1" class="slide level2">
<h2>ANCOVA fit</h2>
<p>Use ANOVA table to display</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: posttest
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
pretest    1 99.400  99.400  587.16 &lt; 2.2e-16 ***
group      2 74.023  37.011  218.63 &lt; 2.2e-16 ***
Residuals 41  6.941   0.169                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Post-hoc tests to see which group is different</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = posttest ~ group + pretest, data = anxiety)

$group
               diff       lwr        upr p adj
grp2-grp1 -1.093333 -1.458662 -0.7280048     0
grp3-grp1 -3.060000 -3.425329 -2.6946715     0
grp3-grp2 -1.966667 -2.331995 -1.6013381     0</code></pre>
</div>
</div>
</section>
<section id="data-example-fast-food-resturants" class="slide level2">
<h2>Data example: fast-food resturants</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code> Restaurant  Sales Households Location I1 I2
          1 135.27        155  Highway  0  0
          2  72.74         93  Highway  0  0
          3 114.95        128  Highway  0  0
          4 102.93        114  Highway  0  0
          5 131.77        158  Highway  0  0
          6 160.91        183  Highway  0  0
          7 179.86        178     Mall  1  0
          8 220.14        215     Mall  1  0
          9 179.64        172     Mall  1  0
         10 185.92        197     Mall  1  0
         11 207.82        207     Mall  1  0
         12 113.51         95     Mall  1  0
         13 203.98        224   Street  0  1
         14 174.48        199   Street  0  1
         15 220.43        240   Street  0  1
         16  93.19        100   Street  0  1</code></pre>
</div>
</div>
<ul>
<li>Do we need three separate models?</li>
</ul>

<img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-38-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="ancova" class="slide level2">
<h2>ANCOVA</h2>

<img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-39-1.png" width="960" class="r-stretch quarto-figure-center"><ul>
<li>In order to allow for different slopes for each location, we define the product (or interaction) variables</li>
</ul>
</section>
<section id="data-set-up" class="slide level2">
<h2>Data set up</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>  Restaurant  Sales Households Location I1 I2
1          1 135.27        155  Highway  0  0
2          2  72.74         93  Highway  0  0
3          3 114.95        128  Highway  0  0
4          4 102.93        114  Highway  0  0
5          5 131.77        158  Highway  0  0
6          6 160.91        183  Highway  0  0</code></pre>
</div>
</div>
</section>
<section id="ancova-model" class="slide level2">
<h2>ANCOVA model</h2>
<p>We examine the relationship between restaurant sales (response variable, in thousands of dollars) and the number of households (H) in the restaurant’s trading area and the location of the restaurant (Mall, Street, and Highway). We can use the indicator variables (<span class="math inline">\(I_1\)</span> and <span class="math inline">\(I_2\)</span>) to define our three locations uniquely.</p>
<p><span class="math inline">\(Sales = \beta_0 + \beta_1 I_1 + \beta_2 I_2 + (\beta_3 + \beta_4 I_1 + \beta_5 I_2)Households\)</span></p>
<p>This model provides a separate model for each location as well as allows for the interaction between location of the restaurant and the number of households through the slope coefficient</p>
</section>
<section id="ancova-model-1" class="slide level2">
<h2>ANCOVA model</h2>
<p><span class="math inline">\(Sales = \beta_0 + \beta_1 I_1 + \beta_2 I_2 + (\beta_3 + \beta_4 I_1 + \beta_5 I_2)Households\)</span></p>
<ul>
<li><p>For Highway Locations: <span class="math inline">\(I_1=0\)</span> &amp; <span class="math inline">\(I_2=0\)</span> hence our model simplifies to</p>
<p><span class="math inline">\(Sales = \beta_{0} + (\beta_3)Households\)</span></p></li>
<li><p>For Mall Locations: <span class="math inline">\(I_1=1\)</span> &amp; <span class="math inline">\(I_2=0\)</span> so the model becomes</p>
<p><span class="math inline">\(Sales = \beta_{0} + \beta_{1} + (\beta_3 + \beta_4)Households\)</span></p></li>
<li><p>For Street Locations: <span class="math inline">\(I_1=0\)</span> &amp; <span class="math inline">\(I_2=1\)</span> so the model becomes <span class="math inline">\(Sales = \beta_{0} + \beta_2 + (\beta_3 + \beta_5) Households\)</span></p></li>
</ul>
<p><em>note</em> R does not <em>require</em> us to code Location as an indicator variable</p>
</section>
<section id="ancova-fit-2" class="slide level2">
<h2>ANCOVA fit</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>modl <span class="ot">=</span> <span class="fu">lm</span>(Sales<span class="sc">~</span>Households<span class="sc">*</span>Location, <span class="at">data =</span> restaurant)</span>
<span id="cb40-2"><a href="#cb40-2"></a>outs <span class="ot">&lt;-</span> <span class="fu">summary</span>(modl)<span class="sc">$</span>coefficients</span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="fu">round</span>(outs[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                 -6.203     11.818  -0.525    0.611
Households                   0.909      0.083  10.906    0.000
LocationMall                39.223     16.451   2.384    0.038
LocationStreet               8.036     16.273   0.494    0.632
Households:LocationMall     -0.074      0.104  -0.710    0.494
Households:LocationStreet   -0.012      0.101  -0.120    0.907</code></pre>
</div>
</div>
<p>We can plug these numbers into our equations <span class="math inline">\(Sales = \beta_{0} + \beta_{1} I_1 + \beta_2 I_2 + (\beta_3 + \beta_4 I_1 + \beta_5 I_2)Households\)</span></p>
<p><span class="math inline">\(Sales = -6.2 + 39.22 + 8.04 + ( 0.909 -0.074 -0.012) Households\)</span></p>
</section>
<section id="ancova-model-2" class="slide level2">
<h2>ANCOVA model</h2>
<p><span class="math inline">\(Sales = -6.2 + 39.22 + 8.04 + ( 0.909 -0.074 -0.012) Households\)</span></p>
<ul>
<li><p>For Highway Locations: <span class="math inline">\(I_1=0\)</span> &amp; <span class="math inline">\(I_2=0\)</span> hence our model simplifies to</p>
<p><span class="math inline">\(Sales = -6.2 + (0.909)Households\)</span></p></li>
<li><p>For Mall Locations: <span class="math inline">\(I_1=1\)</span> &amp; <span class="math inline">\(I_2=0\)</span> so the model becomes</p>
<p><span class="math inline">\(Sales = -6.2 + 39.22 + (0.909 -0.074)Households\)</span></p></li>
<li><p>For Street Locations: <span class="math inline">\(I_1=0\)</span> &amp; <span class="math inline">\(I_2=1\)</span> so the model becomes <span class="math inline">\(Sales = -6.2 + 8.04 + (0.909 -0.012) Households\)</span></p></li>
</ul>
</section>
<section id="graphing-the-model" class="slide level2">
<h2>Graphing the model</h2>

<img data-src="Chapter08_files/figure-revealjs/unnamed-chunk-42-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<p>ANOVA models study categorical predictors (factors).</p>
<pre><code>-   Interaction between factors is important. 
-   ANOVA models and regression models are related and fall under a general family of linear models.</code></pre>
<p>ANCOVA models employs both numerical variables (covariates) and qualitative factors for modelling.</p>
<pre><code>-   Interaction between factors and covariates is important.</code></pre>
</section>
<section id="review-of-non-parametric-tests" class="slide level2">
<h2>Review of non-parametric tests</h2>
<p>Non-parametric tests are light on assumptions, and can be used for highly asymmetric data (as an alternative to using transformations).</p>
<p>Many non-parametric methods rely on replacing the observed data by their <em>ranks</em>.</p>
</section>
<section id="spearmans-rank-correlation" class="slide level2">
<h2>Spearman’s Rank Correlation</h2>
<div class="columns">
<div class="column">
<p>Rank the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables, and then obtain usual Pearson correlation coefficient.</p>
<p>The plot shows non-parametric Spearman in the the upper triangle and parametric Pearson in the bottom triangle.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb44-2"><a href="#cb44-2"></a></span>
<span id="cb44-3"><a href="#cb44-3"></a>p <span class="ot">&lt;-</span> <span class="fu">ggpairs</span>(</span>
<span id="cb44-4"><a href="#cb44-4"></a>  trees, </span>
<span id="cb44-5"><a href="#cb44-5"></a>  <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">'cor'</span>, <span class="at">method =</span> <span class="st">"spearman"</span>)),</span>
<span id="cb44-6"><a href="#cb44-6"></a>  <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">'cor'</span>) </span>
<span id="cb44-7"><a href="#cb44-7"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-spear" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Chapter08_files/figure-revealjs/fig-spear-1.png" width="480"></p>
<figcaption>Figure&nbsp;2: Comparison of Pearsonian and Spearman’s rank correlations</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="wilcoxon-signed-rank-test" class="slide level2">
<h2>Wilcoxon signed rank test</h2>
<p>A non-parametric alternative to the one-sample t-test</p>
<p><span class="math inline">\(H_0: \eta=\eta_0\)</span> where <span class="math inline">\(\eta\)</span> (Greek letter ‘eta’) is the population median</p>
<p>Based on based on ranking <span class="math inline">\((|Y-\eta_0|)\)</span>, where the ranks for data with <span class="math inline">\(Y&lt;\eta_0\)</span> are compared to the ranks for data with <span class="math inline">\(Y&gt;\eta_0\)</span></p>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">wilcox.test</span>(tv<span class="sc">$</span>TELETIME, <span class="at">mu=</span><span class="dv">1680</span>, <span class="at">conf.int=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank exact test

data:  tv$TELETIME
V = 588, p-value = 0.6108
alternative hypothesis: true location is not equal to 1680
95 percent confidence interval:
 1557.5 1906.5
sample estimates:
(pseudo)median 
          1728 </code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">t.test</span>(tv<span class="sc">$</span>TELETIME, <span class="at">mu=</span><span class="dv">1680</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  tv$TELETIME
t = 0.58856, df = 45, p-value = 0.5591
alternative hypothesis: true mean is not equal to 1680
95 percent confidence interval:
 1560.633 1897.932
sample estimates:
mean of x 
 1729.283 </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="non-parametric-anova" class="slide level2">
<h2>Non-parametric ANOVA</h2>
<p>Kruskal-Wallis test: allows to compare three or more groups</p>
<p>Mann-Whitney test: allows to compare 2 groups under the non-normality assumption.</p>
</section>
<section id="kruskal-wallis-test" class="slide level2">
<h2>Kruskal-Wallis test</h2>
<p>The null and alternative hypotheses of the Kruskal-Wallis test are:</p>
<p>H0: The 3 groups are equal in terms of the variable H1: At least one group is different from the other 2 groups in terms of variable</p>
<p>Similar to an ANOVA the alternative hypothesis is not that all groups are different. The opposite of all groups being equal (H0) is that at least one group is different from the others (H1).</p>
<p>In this sense, if the null hypothesis is rejected, it means that at least one group is different from the other 2, but not necessarily that all 3 groups are different from each other. Post-hoc tests must be performed to test whether all 3 groups differ.</p>
</section>
<section id="mann-whitney-test" class="slide level2">
<h2>Mann-Whitney test</h2>
<p>For two group comparison, pool the two group responses and then rank the pooled data</p>
<p>Ranks for the first group are compared to the ranks for the second group</p>
<p>The null hypothesis is that the two group medians are the same: <span class="math inline">\(H_0: \eta_1=\eta_2\)</span>.</p>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">load</span>(<span class="st">"../data/rangitikei.Rdata"</span>)</span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="fu">wilcox.test</span>(rangitikei<span class="sc">$</span>people<span class="sc">~</span>rangitikei<span class="sc">$</span>time, <span class="at">conf.int=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  rangitikei$people by rangitikei$time
W = 30, p-value = 0.007711
alternative hypothesis: true location shift is not equal to 0
95 percent confidence interval:
 -88.99996 -10.00005
sample estimates:
difference in location 
             -36.46835 </code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">t.test</span>(rangitikei<span class="sc">$</span>people<span class="sc">~</span>rangitikei<span class="sc">$</span>time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  rangitikei$people by rangitikei$time
t = -3.1677, df = 30.523, p-value = 0.003478
alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0
95 percent confidence interval:
 -102.28710  -22.13049
sample estimates:
mean in group 1 mean in group 2 
       22.71429        84.92308 </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="another-form-of-test" class="slide level2">
<h2>Another form of test</h2>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">kruskal.test</span>(rangitikei<span class="sc">$</span>people<span class="sc">~</span>rangitikei<span class="sc">$</span>time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  rangitikei$people by rangitikei$time
Kruskal-Wallis chi-squared = 7.2171, df = 1, p-value = 0.007221</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">wilcox.test</span>(rangitikei<span class="sc">$</span>people<span class="sc">~</span>rangitikei<span class="sc">$</span>time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  rangitikei$people by rangitikei$time
W = 30, p-value = 0.007711
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="linear-models-review" class="slide level2">
<h2>Linear models Review</h2>
<p>Family tree</p>
<p>T-tests, regressions, ANOVAs, and ANCOVAs are related</p>
<p>Similarities:</p>
<pre><code>-   1 continuous response variable
-   Assumptions: normality, equal variance, and independence of residuals</code></pre>
<p>Differences:</p>
<pre><code>- EDA
- test statistics
- number and type of predictors</code></pre>
</section>
<section id="whats-the-difference-between-a-t.test-and-an-anova" class="slide level2">
<h2>What’s the difference between a t.test and an ANOVA?</h2>
<p>A t-test is used to determine whether or not there is a statistically significant difference between the means of two groups</p>
<ul>
<li>sample group vs hypothetical population <strong>One-sample t-test</strong></li>
<li>two independent samples <strong>Two-sample t-test</strong>
<ul>
<li>also called independent t-test because the two samples are considered independent</li>
</ul></li>
<li>samples linked in some why, not independent <strong>Paired t-test</strong></li>
</ul>
<p>An ANOVA is used to determine whether or not there is a statistically significant difference between the means of three or more groups, <strong>but not which group</strong></p>
<ul>
<li>one factor split into 3 or more groups (levels) <strong>One-way ANOVA</strong></li>
<li>two factors split into 3 or more groups (levels) <strong>Two-way ANOVA</strong></li>
<li>more than two factors <strong>Three factor ANOVA</strong> etc…</li>
</ul>
</section>
<section id="whats-the-difference-between-a-t.test-and-an-anova-1" class="slide level2">
<h2>What’s the difference between a t.test and an ANOVA?</h2>
<p>The main difference between a t-test and an ANOVA is in how the two tests calculate their test statistic to determine if there is a statistically significant difference between groups.</p>
<p>T-test:</p>
<ul>
<li>T statistic: ratio of the mean difference between two groups relative to overal standard deviation of the differences</li>
<li>One-sample t-test: <span class="math inline">\(t = \frac{x-\mu}{s/\sqrt n}\)</span></li>
<li>Two-sample t-test: <span class="math inline">\(t = \frac{(\bar{x_{1}}-\bar{x_{2}})-d}{\frac{s_1}{\sqrt n} + \frac{s_2}{\sqrt n}}\)</span><br>
</li>
<li>Paired t-test: <span class="math inline">\(t=\frac{\bar{d}}{\frac{S_{d}}{\sqrt n}}\)</span></li>
</ul>
<p><span class="math inline">\(s =\)</span> sample standard deviation <span class="math inline">\(d =\)</span> difference</p>
<p>ANOVA:</p>
<ul>
<li><p>F statistic: ratio of the variance between the groups relative to the variance within the groups<br>
</p></li>
<li><p><span class="math inline">\(F = \frac{s_b^2}{s_w^2}\)</span> Where <span class="math inline">\(s_b^2\)</span> is the between sample variance, and <span class="math inline">\(s_w^2\)</span> is the within sample variance.</p></li>
<li><p>MSF/MSE</p></li>
</ul>
</section>
<section id="when-to-use-a-t.test-or-an-anova" class="slide level2">
<h2>When to use a t.test or an ANOVA?</h2>
<p>In practice, when we want to compare the means of two groups, we use a t-test. When we want to compare the means of three or more groups, we use an ANOVA.</p>
<p>Suppose we have three groups we wish to compare the means between: group A, group B, and group C.</p>
<p>If you did the following t-tests:</p>
<ul>
<li><p>A t-test to compare the difference in means between group A and group B</p></li>
<li><p>A t-test to compare the difference in means between group A and group C</p></li>
<li><p>A t-test to compare the difference in means between group B and group C</p></li>
</ul>
</section>
<section id="what-if-we-just-did-many-t-tests" class="slide level2">
<h2>What if we just did many t-tests?</h2>
<p>For each t-test there is a chance that we will commit a type I error, which is the probability that we reject the null hypothesis when it is actually true. Let’s say we set this to 0.05 (<span class="math inline">\(\alpha = 0.05\)</span>). This means that when we perform multiple t-tests, this error rate increases.</p>
<ul>
<li>The probability that we commit a type I error with one t-test is 1 – 0.95 = 0.05.</li>
<li>The probability that we commit a type I error with two t-tests is 1 – (0.95^2) = 0.0975.</li>
<li>The probability that we commit a type I error with three t-tests is 1 – (0.95^3) = 0.1427.</li>
</ul>
<p>The type I error just increases!</p>
<p>We use a post-hoc (after) test to see which group is driving differences, these pairwise comparisons have a correction factor to adjust our Type I error</p>
</section>
<section id="whats-the-difference-between-a-regression-and-an-anova" class="slide level2">
<h2>What’s the difference between a regression and an ANOVA?</h2>
<p>A regression is used to understand the relationship between predictor variable(s) and a response variable</p>
<ul>
<li>one predictor <strong>Simple Regression</strong></li>
<li>two or more predictors <strong>Multiple Regression</strong></li>
</ul>
<p>An ANOVA is used to determine whether or not there is a statistically significant difference between the means of three or more groups, <strong>but not which group</strong></p>
<ul>
<li>one factor split into 3 or more groups (levels) <strong>One-way ANOVA</strong></li>
<li>two factors split into 3 or more groups (levels) <strong>Two-way ANOVA</strong></li>
<li>more than two factors <strong>Three factor ANOVA</strong> etc…</li>
</ul>
<p>Not too much difference there</p>
</section>
<section id="whats-the-difference-between-a-regression-and-an-anova-1" class="slide level2">
<h2>What’s the difference between a regression and an ANOVA?</h2>
<p>Regression:</p>
<ul>
<li>T statistic: test if each predictor’s estimate is different from 0</li>
<li><span class="math inline">\(R^2\)</span>: proportion of variance explained <span class="math inline">\(\frac{SSR}{SST}\)</span></li>
<li>F statistic: overall F statistic for the regression model, <span class="math inline">\(\frac{MS_{reg}}{MS_{error}}\)</span> where <span class="math inline">\(MS = \frac{SS}{df}\)</span></li>
</ul>
<p>ANOVA:</p>
<ul>
<li>F statistic: ratio of the variance between the groups relative to the variance within the groups<br>
</li>
<li><span class="math inline">\(F = \frac{s_b^2}{s_w^2}\)</span></li>
</ul>
<p>where <span class="math inline">\(s_b^2\)</span> is the between sample variance, and <span class="math inline">\(s_w^2\)</span> is the within sample variance.</p>
<ul>
<li>MSF/MSE</li>
</ul>
<p>The F statistic is the same, thats why you can produce an ANOVA table from your regression</p>
</section>
<section id="when-to-use-a-regression-or-an-anova" class="slide level2">
<h2>When to use a regression or an ANOVA?</h2>
<p>Conventionally, a regression refers to continuous predictors and ANOVAs are used for discrete variables.</p>
<p>BUT …</p>
<p>You can code discrete variable as indicator variables and then treat them as continuous and run a regression!</p>
<p>Generally, if you have 1 continuous and 1 discrete variable you should generate indicator variables and run a multiple regression</p>
<p>If you are using the continuous predictor as a covariate it would be called an <strong>ANCOVA</strong>.</p>
<p>You can code a discrete variable into continuous but if you do the reverse you lose statistical inference.</p>
</section>
<section id="reminder-on-hypotheses" class="slide level2">
<h2>Reminder on Hypotheses</h2>
<p>T-Test: difference between the means of two groups</p>
<ul>
<li>Null: <span class="math inline">\(\mu_{1} - \mu_{2}\)</span> is equal to <span class="math inline">\(0\)</span> Can be <span class="math inline">\(=\)</span>, <span class="math inline">\(\le\)</span>, or <span class="math inline">\(\ge\)</span></li>
<li>Alt: <span class="math inline">\(\mu_{1} - \mu_{2}\)</span> is not equal to <span class="math inline">\(0\)</span> Can be <span class="math inline">\(\ne\)</span>, <span class="math inline">\(&lt;\)</span>, or <span class="math inline">\(&gt;\)</span></li>
</ul>
<p>Regressions: understand the relationship between predictor variable(s) and a response variable</p>
<ul>
<li>Null: true slope coefficient is <span class="math inline">\(= 0\)</span> (i.e.&nbsp;no relationship)</li>
<li>Alt: true slope coefficient <span class="math inline">\(\ne 0\)</span> (i.e.&nbsp;relationship)</li>
</ul>
<p>ANOVA: difference between the means of three or more groups</p>
<ul>
<li>Null: group means are equal</li>
<li>Alt: At least one mean is different</li>
</ul>
</section>
<section id="where-to-go-from-here" class="slide level2">
<h2>Where to go from here?</h2>
<p>Linear models form the basis of a lot more statistics tests.</p>


<img src="img/L_Color.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p><a href="https://anhsmith.github.io/161250/slides.html">161250 Data Analysis</a></p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>