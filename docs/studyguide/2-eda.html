<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>161250 Data Analysis - Chapter 2: Exploratory Data Analysis (EDA)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../studyguide/3-probability.html" rel="next">
<link href="../studyguide/1-data-collection.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">161250 Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides.html" rel="" target="">
 <span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../studyguide/index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Study Guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../workshops/ws01.html" rel="" target="">
 <span class="menu-text">Workshops</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-extra-code" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Extra Code</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-extra-code">    
        <li>
    <a class="dropdown-item" href="../exercises/Chap2more.R" rel="" target="">
 <span class="dropdown-text">Ex2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap3more.R" rel="" target="">
 <span class="dropdown-text">Ex3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap4more.R" rel="" target="">
 <span class="dropdown-text">Ex4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap5more.R" rel="" target="">
 <span class="dropdown-text">Ex5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap6more.R" rel="" target="">
 <span class="dropdown-text">Ex6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap7more.R" rel="" target="">
 <span class="dropdown-text">Ex7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/Chap8more.R" rel="" target="">
 <span class="dropdown-text">Ex8</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../studyguide/index.html">Study Guide</a></li><li class="breadcrumb-item"><a href="../studyguide/2-eda.html">Chapter 2: Exploratory Data Analysis (EDA)</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../studyguide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Study Guide</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/1-data-collection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 1: Data Collection and Quality Issues</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/2-eda.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Chapter 2: Exploratory Data Analysis (EDA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/3-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 3: Probability Concepts and Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/4-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 4: Statistical Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/5-tabulated.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 5: Tabulated Counts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/6-single.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 6: Models with a Single Continuous Predictor</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/7-multiple.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 7: Models with Multiple Continuous Predictors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../studyguide/8-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 8: Analysis of Variance (ANOVA) and Covariance (ANCOVA)</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-two-modes-of-data-analysis" id="toc-the-two-modes-of-data-analysis" class="nav-link active" data-scroll-target="#the-two-modes-of-data-analysis">The two modes of data analysis</a></li>
  <li><a href="#the-basics-of-exploratory-data-analysis" id="toc-the-basics-of-exploratory-data-analysis" class="nav-link" data-scroll-target="#the-basics-of-exploratory-data-analysis">The basics of Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#error-checking" id="toc-error-checking" class="nav-link" data-scroll-target="#error-checking">Error checking</a></li>
  <li><a href="#understanding-data" id="toc-understanding-data" class="nav-link" data-scroll-target="#understanding-data">Understanding data</a></li>
  </ul></li>
  <li><a href="#categorical-data" id="toc-categorical-data" class="nav-link" data-scroll-target="#categorical-data">Categorical Data</a>
  <ul class="collapse">
  <li><a href="#bar-chart" id="toc-bar-chart" class="nav-link" data-scroll-target="#bar-chart">Bar chart</a></li>
  <li><a href="#pie-charts" id="toc-pie-charts" class="nav-link" data-scroll-target="#pie-charts">Pie charts</a></li>
  </ul></li>
  <li><a href="#numerical-data" id="toc-numerical-data" class="nav-link" data-scroll-target="#numerical-data">Numerical Data</a>
  <ul class="collapse">
  <li><a href="#dotplot" id="toc-dotplot" class="nav-link" data-scroll-target="#dotplot">Dotplot</a></li>
  <li><a href="#histograms" id="toc-histograms" class="nav-link" data-scroll-target="#histograms">Histograms</a></li>
  <li><a href="#theoretical-distributions" id="toc-theoretical-distributions" class="nav-link" data-scroll-target="#theoretical-distributions">Theoretical Distributions</a></li>
  </ul></li>
  <li><a href="#summary-statistics-and-their-display" id="toc-summary-statistics-and-their-display" class="nav-link" data-scroll-target="#summary-statistics-and-their-display">Summary Statistics and their display</a>
  <ul class="collapse">
  <li><a href="#symmetry-plots" id="toc-symmetry-plots" class="nav-link" data-scroll-target="#symmetry-plots">Symmetry plots</a></li>
  <li><a href="#box-plots" id="toc-box-plots" class="nav-link" data-scroll-target="#box-plots">Box plots</a></li>
  </ul></li>
  <li><a href="#cumulative-frequencies-and-quantiles" id="toc-cumulative-frequencies-and-quantiles" class="nav-link" data-scroll-target="#cumulative-frequencies-and-quantiles">Cumulative Frequencies and Quantiles</a>
  <ul class="collapse">
  <li><a href="#cumulative-frequencies" id="toc-cumulative-frequencies" class="nav-link" data-scroll-target="#cumulative-frequencies">Cumulative frequencies</a></li>
  <li><a href="#quantiles" id="toc-quantiles" class="nav-link" data-scroll-target="#quantiles">Quantiles</a></li>
  <li><a href="#quantile-quantile-plots" id="toc-quantile-quantile-plots" class="nav-link" data-scroll-target="#quantile-quantile-plots">Quantile-Quantile Plots</a></li>
  </ul></li>
  <li><a href="#exploring-relationships" id="toc-exploring-relationships" class="nav-link" data-scroll-target="#exploring-relationships">Exploring Relationships</a>
  <ul class="collapse">
  <li><a href="#scatterplots" id="toc-scatterplots" class="nav-link" data-scroll-target="#scatterplots">Scatterplots</a></li>
  <li><a href="#correlation-coefficients" id="toc-correlation-coefficients" class="nav-link" data-scroll-target="#correlation-coefficients">Correlation coefficients</a></li>
  <li><a href="#correlation-matrices" id="toc-correlation-matrices" class="nav-link" data-scroll-target="#correlation-matrices">Correlation matrices</a></li>
  <li><a href="#bivariate-distributions" id="toc-bivariate-distributions" class="nav-link" data-scroll-target="#bivariate-distributions">Bivariate distributions</a></li>
  <li><a href="#higher-dimensional-data" id="toc-higher-dimensional-data" class="nav-link" data-scroll-target="#higher-dimensional-data">Higher dimensional data</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="2-eda.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Chapter 2: Exploratory Data Analysis (EDA)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p><em>“Data has no meaning apart from its context.”</em><br> — Walter A Shewhart</p>
</blockquote>
<blockquote class="blockquote">
<p><em>Sherlock Holmes: “How do all these unusuals strike you, Watson?”</em><br> <em>Dr.&nbsp;Watson: “Their cumulative effect is certainly considerable,and yet each of them is quite possible in itself”</em><br> — Sir Arthur Conan Doyle, <em>The Adventure of the Abbey Grange</em></p>
</blockquote>
<section id="the-two-modes-of-data-analysis" class="level1">
<h1>The two modes of data analysis</h1>
<p>Exploratory Data Analysis (EDA) is exactly as it sounds: the process of exploring a data set, usually by visual examination, calculating summary statistics, and making tables and graphical displays. Exploratory analysis was likened to detective work by John <span class="citation" data-cites="tukey1977">Tukey (<a href="#ref-tukey1977" role="doc-biblioref">1977</a>)</span> in his seminal book. As in a detective story, the circumstances surrounding a crime can be accidental; it is important to keep in mind that not all patterns that you see in a sample data set will reflect true patterns in the population.</p>
<p>When analysing data, it is important to keep front of mind the purpose of the analysis. One can distinguish between the following two broad modes of analysis:</p>
<ul>
<li><p><strong>Exploratory</strong> or <strong>hypothesis-generating analyses</strong> are about <em>discovering new patterns</em>. Such analyses are typically rather unstructured exploration by summarising data and making tables and graphs, without any preconceived ideas about what might be found. The purpose is often to produce better understanding of a system, and is a good way of generating new hypotheses that can be tested with subsequent data/experiments.</p></li>
<li><p><strong>Confirmatory</strong> or <strong>inferential</strong> or <strong>hypothesis-testing analyses</strong> are about <em>testing a priori ideas</em>. The ideas about what patterns would be present in the data were known to the analyst <em>prior to seeing the data</em>, often in accordance with some scientific theory about the mechanistic processes in the system under study. These analyses often take the form of fitting statistical models and performing formal hypothesis tests, and evaluating evidence for particular effects.</p></li>
</ul>
<p>Here’s the important part: one must no report an exploratory analysis as though it was a confirmatory analysis. In other words, if an exploratory data analysis leads you to a new scientific hypothesis, do not report this as though it were an <em>a priori</em> hypothesis that you then tested with those data. This is scientifically dishonest and is a major contributor to the replication crisis in science <span class="citation" data-cites="ioannidis_why_2005">(<a href="#ref-ioannidis_why_2005" role="doc-biblioref">Ioannidis 2005</a>)</span>. Taking a hypothesis that occurred to you after seeing patterns in the data, and <em>using that same data to test that hypothesis</em>, is a form of circular reasoning. The strength of any evidence obtained in this way is much weaker than if one tests a bona fide <em>a priori</em> hypothesis.</p>
<p>To address the issue of testing hypotheses with the same data that generated them, scientists are increasingly encouraged to publically <em>preregister</em> their scientific hypotheses before the data are even collected <span class="citation" data-cites="nosek_preregistration_2018">(<a href="#ref-nosek_preregistration_2018" role="doc-biblioref">Nosek et al. 2018</a>)</span>. This guarantees that there was no “data snooping” for patterns prior to hypothesis testing.</p>
<p>So, if you have any <em>a priori</em> ideas and hypotheses about what patterns you might see in the data (e.g., the mean of <span class="math inline">\(y\)</span> will be higher for group <span class="math inline">\(A\)</span> than group <span class="math inline">\(B\)</span>), before you look at or even collect the data, it is wise to write them down or, better still, formally preregister them. This will help clarify the purpose of the analysis, and reduce the risk of misrepresenting your results.</p>
<p>From the <a href="https://www.cos.io/initiatives/prereg">Center for Open Science website</a>:</p>
<blockquote class="blockquote">
<p>Preregistration separates <em>hypothesis-generating</em> (exploratory) from <em>hypothesis-testing</em> (confirmatory) research. Both are important. But the same data cannot be used to generate and test a hypothesis, which can happen unintentionally and reduce the credibility of your results. Addressing this problem through planning improves the quality and transparency of your research. This helps you clearly report your study and helps others who may wish to build on it. For instructions on how to submit a preregistration on OSF, please visit our help guides.</p>
</blockquote>
<p><img src="../img/confexpl.png" class="img-fluid"></p>
<p>Of course, <em>hypothesis-generating</em> (exploratory) and <em>hypothesis-testing</em> (confirmatory) modes of analysis are by no means mutually exclusive. Calculating summary statistics and making tables and plots are an important part of inferential analyses, and one can use inferential statistics (e.g., confidence intervals) to summarise patterns seen in exploratory analyses.</p>
<p>See <a href="https://statmodeling.stat.columbia.edu/2022/09/06/exploratory-and-confirmatory-data-analysis/">this blog post</a> by Andrew Gelman for more on how the two modes fit together.</p>
</section>
<section id="the-basics-of-exploratory-data-analysis" class="level1">
<h1>The basics of Exploratory Data Analysis</h1>
<p>Following <span class="citation" data-cites="Chatfield">Chatfield (<a href="#ref-Chatfield" role="doc-biblioref">1995</a>)</span>, here are some guidelines for tackling statistical analyses.</p>
<ol type="1">
<li><p>Make sure you understand the structure of the data, including what was measured, how, and why.</p></li>
<li><p>Write down the purpose of the analysis in the form of aims, research questions, and/or hypotheses, and make a plan for how to test any formal hypotheses, including evaluating the validity of assumptions.</p></li>
<li><p>Critically examine the data to check for errors, inconsistencies, and mismatches with the structure of the data as you understand it.</p></li>
<li><p>Explore the data with summary statistics, tables, and plots.</p></li>
<li><p>Conduct any inferential statistical analyses. Use statistics, tables, and plots to</p>
<ol type="a">
<li>check the assumptions of the analysis and</li>
<li>summarise the results.</li>
</ol></li>
<li><p>Be honest and use common sense.</p></li>
</ol>
<p>As discussed in Chapter 1, one must be congnisant to how the data were collected and any sampling biases that may be present. What is the population of interest, and is the sample representative of that population? Were the methods of recording the data accurate? Finally, what exactly does each variable represent? Are the variables contained in the data direct measurements of the variable of interest, or merely convenient surrogates?</p>
<section id="error-checking" class="level2">
<h2 class="anchored" data-anchor-id="error-checking">Error checking</h2>
<p>The data are assumed to be in some sort of electronic form; e.g.&nbsp;text file, spreadsheet, database, etc. Before analysing the data, it is prudent to check for mistakes in the data. If one has access to the raw data (e.g.&nbsp;returned questionnaires), one can check observations by hand. If the raw data are not available, then the best one can do is to look for observations whose values are out of allowable ranges, or are very suspicious. A common problem occurs with the coding of missing information. Missing values are commonly recorded as a blank, <code>*</code>, <code>-1</code>, <code>-999</code>, or <code>NA</code>. Only one type of coding should be used. The use of <code>NA</code> is preferred since this is easier to spot. The use of blanks is particularly dangerous when one is exporting data from a spreadsheet to a text file. When the data from the text file is read into a computer package, a missing value may be skipped and the value from the next observation read in its place. When the data set is large, looking at a data set one observation at a time may not be feasible. In this case, plotting the data may show any observations with illegal values.</p>
</section>
<section id="understanding-data" class="level2">
<h2 class="anchored" data-anchor-id="understanding-data">Understanding data</h2>
<p>After any data errors have been found and corrected, the data understanding stage commences. This stage involves tabulating, summarising, and plotting the data in many ways to gain insight into the data set. We typically want to:</p>
<ul>
<li>examine the distributions, or shapes, of individual variables;</li>
<li>compare different groups of data, with special emphasis on location and scale;</li>
<li>and discover any trends and relationships exhibited between pairs of variables.</li>
</ul>
<p>Again, don’t fall into the trap of <strong>data snooping</strong>, where you develop and test hypotheses with the same data. For instance, suppose that boxplots of the income of individuals in different age groups show that youngest and oldest age groups are the most different. If one elects to perform the hypothesis test for the difference between these two groups based on observations made during EDA, the resulting <span class="math inline">\(p\)</span>-value is not valid.</p>
<p>In the sections below, we briefly review many common tools used to visualise data during EDA.</p>
</section>
</section>
<section id="categorical-data" class="level1">
<h1>Categorical Data</h1>
<p>There are many methods for examining categorical variables. We will explore several methods, including tables, bar charts, dot plots, and pie charts. These tools are covered in foundation courses and hence we will briefly review them.</p>
<section id="bar-chart" class="level2">
<h2 class="anchored" data-anchor-id="bar-chart">Bar chart</h2>
<p>The rules for constructing a bar chart are very simple and perhaps they can be reduced to a single rule and that is to make the <em>height of each bar proportional to the quantity displayed</em>. Consider the dataset <strong>Snodgrass</strong> available in the <code>R</code> package <code>archdata</code>. This dataset contains information on the size, location and contents of 91 house pits at the Snodgrass site which was occupied between about CE 1325-1420. The variable names and their description are given below:</p>
<ul>
<li><code>East</code>: East grid location of house in feet (excavation grid system)</li>
<li><code>South</code>: East grid location of house in feet (excavation grid system)</li>
<li><code>Length</code>: House length in feet</li>
<li><code>Width</code>: House width in feet<br>
</li>
<li><code>Segment</code>: Three areas within the site 1, 2, 3<br>
</li>
<li><code>Inside</code>: Location within or outside the “white wall” Inside, Outside<br>
</li>
<li><code>Area</code>: Area in square feet<br>
</li>
<li><code>Points</code>: Number of projectile points<br>
</li>
<li><code>Abraders</code>: Number of abraders<br>
</li>
<li><code>Discs</code>: Number of discs<br>
</li>
<li><code>Earplugs</code>: Number of earplugs<br>
</li>
<li><code>Effigies</code>: Number of effigies<br>
</li>
<li><code>Ceramics</code>: Number of ceramics<br>
</li>
<li><code>Total</code>: Total Number of artifacts listed above<br>
</li>
<li><code>Types</code>: Number of kinds of artifacts listed above</li>
</ul>
<p>The data from 91 house pits at the Snodgrass site were reported by Price and Giffin in 1979. The layout of the houses follows a grid pattern with the long axis oriented north-east surrounded by a fortification trench. There is also evidence of an interior wall that may have separated the houses inside that wall from those outside the wall. Price and Griffin use differences in house size and artifacts composition to suggest that those distinctions may have reflected rank differences between the occupants of the two areas.</p>
<p>The distribution of number of Ceramics found can be displayed in the form of a bar chart; see <a href="#fig-barchart">Figure&nbsp;1</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Snodgrass, <span class="at">package =</span> <span class="st">"archdata"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Ceramics) <span class="sc">+</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-barchart" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-barchart-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Bar Chart of Ceramics counts</figcaption>
</figure>
</div>
</div>
</div>
<p>The bar graph illustrates clearly that no ceramics were found in many houses but a lot were found in a few houses. This may be due to status and wealth of the occupants.</p>
<p>Note that we are treating number of Ceramics as ordinal in the above graph. For nominal data software tend to order the categories alphabetically.</p>
<p>However, a graph is not always the best way to display a small set of numbers. Graphs do have some disadvantages: they take up a lot of space, and they do not usually allow the recovery of the exact observations. For these reasons, particularly for a small data sets, a table is sometimes more effective. There were only three segment categories; and their counts can be simply displayed as a table.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Snodgrass<span class="sc">$</span>Segment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3 
38 28 25 </code></pre>
</div>
</div>
<p>It would be interesting to see whether the discovery of ceramics is Segment dependent. In other words, we would like to explore two factors in display. This can be done in many ways (<a href="#fig-barcharts">Figure&nbsp;2</a>).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Snodgrass, <span class="at">package =</span> <span class="st">"archdata"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Ceramics, <span class="at">fill =</span> Segment) <span class="sc">+</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bar plot with colour grouping"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Ceramics) <span class="sc">+</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">vars</span>(Segment)) <span class="sc">+</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Segment-wise Bar plots"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Ceramics, <span class="at">fill =</span> Segment) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Clustered Barplot"</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>Ceramics, <span class="at">fill =</span> Segment) <span class="sc">+</span> </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Clustered Bar plot - flipped"</span>) <span class="sc">+</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-barcharts" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-barcharts-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Bar Chart of Ceramics counts by Segment</figcaption>
</figure>
</div>
</div>
</div>
<p>It is easy to spot that the Ceramics findings were largely from the first segment. This EDA conclusion can be drawn from all of the above plots. However, these bar plots do not rate the same as a “presentation style graphic”.</p>
<p>Tufte (2001) argues in favour of certain principles of graphical integrity for presentation style graphics. These are:</p>
<ol type="1">
<li><p>The representation of numbers in a graph should be directly proportional to the numbers themselves;</p></li>
<li><p>Clear and detailed labels should be used to prevent ambiguity;</p></li>
<li><p>Provide explanations and important events pertaining to data on the graphic itself;</p></li>
<li><p>The graph should display data variation, not design variation—visual changes in the graph should be due to the data, not changes in way the data are drawn;</p></li>
<li><p>The number of dimensions used in the graph should not exceed the number of dimensions in the data;</p></li>
<li><p>Graphs must not quote data out of context; for example, a monthly drop in the murder rate of a city should be plotted within the context of the murder rate over the last few years, or murder rates in comparable cities over the same period.</p></li>
</ol>
<p>A final point concerns the use of colour. In many sorts of graphs, data types are differentiated by the use of colour. This practice is perfectly legitimate, but one should be aware that a surprising proportion of people have impaired colour perception, such as being unable to distinguish between red and green (see <a href="https://cran.r-project.org/web/packages/colorBlindness/vignettes/colorBlindness.html">here</a> for colourblind-friendly pallettes). A remedy to these problems is to use different plotting symbols, line types, or shading, in conjunction with different colours. One should always make sure that the colours selected are clearly visible in the medium in which they are presented. Colours on a computer monitor can appear quite different when projected onto a screen in a lecture theatre, or when printed onto paper.</p>
<p>According to <span class="citation" data-cites="Tufte2001">Tufte (<a href="#ref-Tufte2001" role="doc-biblioref">2001</a>)</span>, a good graphical display should:</p>
<ol type="1">
<li><p>Display the data;</p></li>
<li><p>Encourage the viewer to concentrate on the substance of the data, in the context of the problem, not on the artistic merits of the graph;</p></li>
<li><p>Avoid distorting, intentionally or unintentionally, what the data have to say;</p></li>
<li><p>Have a high data to ink ratio; that is, convey the greatest amount of information in the shortest time with the least ink in the smallest space;</p></li>
<li><p>Enable one to easily compare different pieces of data;</p></li>
<li><p>Reveal overall trends and patterns in the data that are not obvious from viewing the raw numbers;</p></li>
<li><p>Reveal detailed information secondary to the main trend; for example, the location of outliers, variability of the response.</p></li>
</ol>
<p>This Chapter is largely concerned with EDA for discovery of patterns and peculiarities in a dataset. So we will not be too worried if the graphs produced are not aesthetically pleasing or does not meet a particular standard for a presentation style graph.</p>
<p>The end goal of most analyses is of course some form of written report or presentation. In either case, the findings of the study, should be supported by tables and graphs created during the EDA; these should clarify and support the final conclusions, not deceive or confuse the audience. One should refrain from showing all tables and plots that were created, but rather a careful selection that reinforces the main findings. The remaining figures can, if necessary, be placed in an appendix of the written report. The figures and tables that are shown should be well labelled and annotated. Abbreviations and cryptic variable names should be replaced by sensible labels and descriptions. The emphasis should be on conveying information rather than producing an eye catching plot. Special care should be taken to ensure that the table or graph cannot be easily misinterpreted.</p>
<p>In addition, a poorly made graph can be deceptive. This is a problem both in the understanding the data phase, and the presenting the data phase. One common mistake (but by no means the only one) in creating a graph is to use more dimensions to represent the data than there are data dimensions. For example, it is not uncommon to see a bar chart where the bars are drawn as three dimensional rectangular prisms. The false perspective actually obscures the differences in the heights of the bars.</p>
<p>Another pitfall is to use a clever graphic rather than one that clearly presents the data. The classic example of this is a pictogram, where pictures of varying size represent some quantities. Pictograms are often drawn dishonestly: to show a two-fold difference, each side of the picture is increased by a factor of two, so the area is in fact increased by a factor of four. Dishonesty in data presentation is clearly unacceptable. But even an honest pictogram is usually not the best way to present data. It is difficult to accurately judge differences between areas; which is what a pictogram asks the viewer to do.</p>
</section>
<section id="pie-charts" class="level2">
<h2 class="anchored" data-anchor-id="pie-charts">Pie charts</h2>
<p>Pie charts are a popular, though usually rather poor, way of presenting data. Like bar charts, they frequently use a large figure to represent just a few numbers. Pie charts also have a poor accuracy of decoding. That means people’s impression of the difference in size between two pie slices is often quite different from the actual difference in size. Pie charts use angles to represent percentages; people tend to underestimate the size of acute angles and overestimate the size of obtuse angles. The exploded pie chart makes it more difficult to accurately compare pie slices: the exploded piece always appears bigger. The three dimensional pie chart is even worse. Bar charts, dot charts, or tables should be preferred to pie charts.</p>
</section>
</section>
<section id="numerical-data" class="level1">
<h1>Numerical Data</h1>
<section id="dotplot" class="level2">
<h2 class="anchored" data-anchor-id="dotplot">Dotplot</h2>
<p>One of the simplest kinds of graph for a numerical variable is the single line (or one dimensional) graph. Each observation is represented by a point (or a star <code>*</code> or a dot <code>.</code>) on the line. These graphs can be useful to see the rough distribution and gaps, if any, in the data. <a href="#fig-dot1">Figure&nbsp;3</a> shows a dotplot of Length of the house pits for the Inside and Outside groupings. Evidently privileged tribes lived inside in general, and the length of their dwellings is longer.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>Inside, <span class="at">y=</span>Length) <span class="sc">+</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis=</span><span class="st">'y'</span>, <span class="at">dotsize=</span>.<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-dot1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-dot1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;3: A typical dot plot for two groups</figcaption>
</figure>
</div>
</div>
</div>
<p>On reflection, the one dimensional dotplot gives rise to a second dimension wherever observations are identical or nearly the same. In a dotplot such points are usually stacked. As our eyes tend to pick up trends very easily, they tend to be distracted by the vertical changes. The main problem here is that some of the values which coincide by chance may be taken to represent real increases in density. To overcome this we try ‘jittering’ the data, which is equivalent to plotting a random number on the vertical axis against the data values on the horizontal axis. It is suggested that the vertical jitter be restricted to a small range so that the overall effect is that of a one-dimensional spread with greater, or lesser, density of points along the graph. <a href="#fig-dot2">Figure&nbsp;4</a> shows a jittered dotplot. You can decide for yourself which strategy is better.</p>
<p>Clearly, the use of jittering is much more relevant for larger sets of data. Notice that with jittering we are interested in the relative density of the graph in different places rather than in trends.</p>
<p>As the vertical reading is determined at random our eyes may be distracted by a seeming trend which is mainly due to this randomness. For this reason, it is helpful to try more than one plot with different levels of jitter This is in the spirit of EDA, in which data is viewed from as many angles as is feasible. The other side of this coin is that conclusions from one display of data should be treated with some scepticism. The availability of computers allows data to be plotted, tabulated and transformed quickly, so we should look at it several ways to better appreciate the peculiarities inherent in our data.</p>
<p>In practice, one tends to avoid jittering except in (two-variable) scatter plots where there are many repeated <span class="math inline">\((x, y)\)</span> points. Graphs with jitter are mainly needed when the data are heavily rounded, discrete, or grouped in some way, or there are a large number of points to be plotted.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dot2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-dot2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;4: A jittered dot plot</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="histograms" class="level2">
<h2 class="anchored" data-anchor-id="histograms">Histograms</h2>
<p>The histogram is a standard method of showing the distribution of a quantitative variable. A histogram is made by dividing the range of a variable into “bins” and counting the number of data points that fall within each bin. It is like a bar chart after forcing a quantitative variable into bins. It can be used for discrete ungrouped data, but a bar chart is generally more suitable for discrete data because histograms can mislead the reader into thinking that values exist other than at the centre of the intervals.</p>
<p><a href="#fig-hist1">Figure&nbsp;5</a> shows the histogram of <code>Length</code>. Clearly the distribution is far from symmetric and left skewed. The bimodal pattern also suggests subgrouping.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Length) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">12</span>, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-hist1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-hist1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;5: A typical histogram</figcaption>
</figure>
</div>
</div>
</div>
<p>Notice that a different shape of histogram may result depending on the class intervals (bins) used (that is by choosing different class widths or different midpoints of the classes). This suggests that it may be wise to draw more than one histogram for a given data set particularly if statements are to be made about modes or gaps in the data. The guideline for the maximum number of intervals, <span class="math inline">\(L\)</span>, can follow the same formula as for stem-and-leaf displays. Some software use the <span class="citation" data-cites="Sturges">Sturges (<a href="#ref-Sturges" role="doc-biblioref">1926</a>)</span> formula namely <span class="math display">\[\texttt{bin width} = \frac {\texttt{range}(x)} {\log_2(n)+1}.\]</span> For fixing the width of the bins, the range of the data is divided by the sum of one and the base two logarithm of the sample size.</p>
<p>There are a few ways to scale the y-axis of a histogram, as shown in <a href="#fig-threehist">Figure&nbsp;6</a>:</p>
<ol type="a">
<li><p><strong>Frequency histograms</strong> show the counts in each bin; the heights of the bars sum to <span class="math inline">\(n\)</span>.</p></li>
<li><p><strong>Relative frequency histograms</strong> show the proportions or percent of data in each bin—the counts in each bin divided by the total; the heights sum to 1 or 100%.</p></li>
<li><p><strong>Density histograms</strong> show the densities; the areas (heights <span class="math inline">\(\times\)</span> widths) of the bars sum to 1.</p></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span>  Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Length) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(a) Frequency histogram"</span>, </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Heights of the bars sum to n"</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span>  Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Length) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="dv">20</span>, </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count)))</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(b) Relative frequency histogram"</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Heights sum to 100%"</span>) <span class="sc">+</span> </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span>  Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Length) <span class="sc">+</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="dv">20</span>, </span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(c) Density histogram"</span>,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Heights x widths sum to 1"</span>)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-threehist" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-threehist-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption class="figure-caption">Figure&nbsp;6: Three types of histograms</figcaption>
</figure>
</div>
</div>
</div>
<p>If, instead of drawing blocks over the class intervals as in a histogram, we join the mid points of the tops of the bars, we obtain a display known as a <strong>frequency polygon</strong> . If we use relative frequencies, it is a <strong>relative frequency polygon</strong>; see <a href="#fig-hist3">Figure&nbsp;7</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Length, <span class="at">y =</span> <span class="fu">after_stat</span>(density)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>( <span class="at">bins =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-hist3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-hist3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;7: A typical frequency polygon</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-hist3a">Figure&nbsp;8</a> shows a kernel density plot, which is a method that produces a smoother density line.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(Length) <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">alpha =</span> .<span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"darkorange2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-hist3a" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-hist3a-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8: A typical smoothed density curve</figcaption>
</figure>
</div>
</div>
</div>
<p>Kernel Density Estimation (KDE) is generated by dropping a little mini-distribution, usually a normal curve, on each individual point and summing them up (<a href="#fig-kdegif">Figure&nbsp;9</a>).</p>
<div id="fig-kdegif" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="../img/kde.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;9: A demonstration of kernel density estimation</figcaption>
</figure>
</div>
<p>These smooth plots are also useful to see the type of skewness involved, multimodality (several peaks) and unusual observations (or outliers). The disadvantage is that we may over-smooth and mask some of the subgrouping patterns; see <a href="#fig-hist4">Figure&nbsp;10</a>. Even though the two distributions appear to be similar, the length distribution for the Inside group has a larger mean/median etc (called the location parameters).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Length, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> Inside) <span class="sc">+</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-hist4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-hist4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;10: Identification of Subgrouping</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="theoretical-distributions" class="level2">
<h2 class="anchored" data-anchor-id="theoretical-distributions">Theoretical Distributions</h2>
<p>A histogram gives a general picture of the frequencies or relative frequencies of the data. If an observation is taken at random from the population from which the sample was drawn, the chance of it falling in any one of the class intervals should be approximately proportional to the area of the block over that interval (not exactly proportional because the histogram was only based on a sample from the population, not the population itself).</p>
<p>If we could draw a histogram for the whole population, then the probabilities would be exact. The relative frequencies form a probability distribution and if the class intervals are small enough the tops of the bars of the histogram would often approximate a smooth curve such as the density plot. In many cases this smooth curve is almost symmetrical with a rounded peak at the centre. One particular shape, fitting a certain mathematical formula, is a very good approximation to many sets of data. For instance, heights of people, weights of animals or yields of wheat all follow this distribution fairly well (although theoretically the distribution has an infinite range of possible values). One of the widely used <em>theoretical</em> distribution is called the <em>Normal</em> or <em>Gaussian</em> distribution but we will not bore you with its formula. However, most software can compute the tail areas (probabilities) under theoretical distributions. We shall study this distribution in greater detail in a Chapter 3. For the moment let us note that our EDA techniques should provide us with information about the parameters of the distribution, and we also want graphical techniques that display the continuous nature of the data.</p>
<p>Discrete data also have probability distributions and the bar graph gives a general picture of its shape. One commonly occurring discrete theoretical distribution is known as the <strong>Poisson distribution</strong> and approximates reasonably well the numbers of road accidents over a fixed time period. The main feature of a Poisson distribution is that there is a peak at the nearest integer below or equal to the average, and then a steady falling off. The mean is a parameter of the model, so we want our exploratory techniques to tell us about the mean, and to help us decide whether or not the Poisson model is appropriate for a given set of data. Theoretically, possible values are any whole positive numbers, but large numbers of accidents are very unlikely. Again, any graphical method we use must properly display the discrete nature of Poisson data. The other commonly adopted discrete distribution is the binomial distribution. This distribution is valid when the individual outcomes are classified into two categories such as Success and Failure.</p>
</section>
</section>
<section id="summary-statistics-and-their-display" class="level1">
<h1>Summary Statistics and their display</h1>
<p>For a small to moderate size batch of numbers, the stem-and-leaf display may reveal at a glance all of the peculiarities in the data. However it is useful, particularly for large batches, to calculate some statistics which capture the main features of the data. These are called <strong>summary statistics</strong> and they help us to gain an overall picture without being distracted by some individual peculiarities. You must be familiar with the common summary statistics such as mean, median, standard deviation etc.</p>
<p>The <code>R</code> default function <code>summary()</code> gives the mean, median, lower and upper quartiles, minimum, and maximum for a variable) as well as for a dataframe) For the length variable in our <em>Snodgrass</em> dataset, we obtain this default summary as</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Snodgrass<span class="sc">$</span>Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   4.00   13.00   14.50   15.07   17.75   21.00 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try summary(Snodgrass)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We need used <code>R</code> functions such as <code>sd()</code> to obtain the standard deviation etc. Packages such as <code>psych</code> contain functions to get enhanced summaries. Try</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(Snodgrass<span class="sc">$</span>Length)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">describeBy</span>(Snodgrass<span class="sc">$</span>Length, <span class="at">group=</span>Snodgrass<span class="sc">$</span>Inside)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For EDA purposes, <span class="citation" data-cites="tukey1977">Tukey (<a href="#ref-tukey1977" role="doc-biblioref">1977</a>)</span> suggested to generate further positional summaries using the concept of median. The sorted (smallest to largest) Length data from the <em>Snodgrass</em> dataset was presented earlier for discussing the stem plot. In total <span class="math inline">\(n = 91\)</span> house pits were present, so that the <strong>median</strong> Length is the <span class="math inline">\(46^{\text th}\)</span> value and equals 14.5. Notice that the median is in the middle of the distribution having 45 points on either side.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(Snodgrass<span class="sc">$</span>Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.5</code></pre>
</div>
</div>
<section id="symmetry-plots" class="level2">
<h2 class="anchored" data-anchor-id="symmetry-plots">Symmetry plots</h2>
<p>A symmetry plot is based on the distance of left and right side points. If the underlying distribution is symmetric, the points on the left and right side would be roughly equidistant from the median. For the length data, we obtain the symmetry plot after writing a little <code>R</code> function as follows:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>symmetryplot <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(ggplot2)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(x)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(x) <span class="sc">%/%</span> <span class="dv">2</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  sx <span class="ot">&lt;-</span> <span class="fu">sort</span>(x)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  dfm <span class="ot">&lt;-</span> <span class="fu">tibble</span>( </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> <span class="fu">median</span>(x) <span class="sc">-</span> sx[<span class="dv">1</span><span class="sc">:</span>m], </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">rev</span>(sx)[<span class="dv">1</span><span class="sc">:</span>m] <span class="sc">-</span> <span class="fu">median</span>(x)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  dfm <span class="sc">|&gt;</span> </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y)) <span class="sc">+</span> </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>X)) <span class="sc">+</span> </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Distance below median"</span>) <span class="sc">+</span> </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Distance above median"</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">symmetryplot</span>(Snodgrass<span class="sc">$</span>Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="2-eda_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The points do not follow the <span class="math inline">\(45^\circ\)</span> line where <span class="math inline">\(Y=X\)</span>; divergence from this line indicates a lack of symmetry.</p>
<p>If each half of the distribution is further divided in halves, we obtain the <strong>fourths</strong> or( <strong>hinges</strong>), as the medians for the lower and upper halves. The end points, the minimum and the maximum are called the lower and upper <strong>extreme</strong> values, respectively.</p>
<p>The <code>R</code> function obtains the set (minimum, lower hinge, median, upper hinge, maximum) in its function <code>fivenum</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Five number summary</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(Snodgrass<span class="sc">$</span>Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  4.00 13.00 14.50 17.75 21.00</code></pre>
</div>
</div>
</section>
<section id="box-plots" class="level2">
<h2 class="anchored" data-anchor-id="box-plots">Box plots</h2>
<p>A <strong>boxplot</strong> (or sometimes a <em>box-and-whisker plot</em>) is a visual display of the five-number summary, which can be used to assess the skew in the data. The components of a boxplot are explained in <a href="#fig-boxplt">Figure&nbsp;11</a>.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fn[2], xend = fn[4], y = -0.1, yend = -0.1), : All aesthetics have length 1, but the data has 91 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = fn[2], xend = fn[2] - 1.5 * (fn[4] - fn[2]), : All aesthetics have length 1, but the data has 91 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-boxplt" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-boxplt-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;11: Annotated boxplot</figcaption>
</figure>
</div>
</div>
</div>
<p>The box shows the positions of the first and third quartiles, or “hinges”, and the thick middle line shows the median. As 50% of the observations fall between the first and third quartiles, the position of the box is important and is the first thing that catches our eyes. If the median is in the centre of the box, this suggests that the distribution may be symmetric; if the median is near one end, the distribution is skewed. In particular, if the median is in the <em>right</em> side of the box, it implies that the middle 50% of the data are skewed to the <em>left</em>. For right skewed data, the median will be placed at the left end of the box (as against in the centre of the box).</p>
<p>After having considered the ‘centre’ of a distribution, which we have measured by the median, and looked at where the bulk of the data lies, measured by the quartiles; then we are particularly interested in the strange, unusual values. They could be obvious mistakes (incorrectly coded, or decimal places in the wrong place, transposition of digits such as 91 instead of 19) or incorrect measurements or recording. These last two possibilities often occur before the data gets to the statistician so that it may be difficult to check whether these mistakes have occurred. Apart from obvious errors, we can only point to ‘far out’ values as being strange and we term them <strong>‘outliers’</strong>. To help decide this matter, we define a few more terms, of which the most common one is the <strong>interquartile range</strong> or <strong>IQR</strong>, which is the distance between the first and third quartiles ( <span class="math inline">\(Q3-Q1\)</span> ). Any observation which is more than <span class="math inline">\(1.5 \times IQR\)</span> (sometimes called the “step”) less than the first or more than the third quartile can be considered a <em>possible</em> outlier (<a href="#fig-boxplt">Figure&nbsp;11</a>.</p>
<p>Boxplots are ideal for comparing a few groups of data because they give a visual summary of certain main features of the distributions but they are not as cluttered as other displays. Common sense must prevail, for there is a limit to the amount of information that the eye can take in. Up to 10 or 12 boxplots can be plotted, preferably on the same scale; more than 12 could be confusing.</p>
<p>Shown in <a href="#fig-boxplt1">Figure&nbsp;12</a> are the boxplots of <code>Length</code> for the Inside-Outside groupings. Note that the boxplots have been constructed on the same scale; that is, they have common (<code>Length</code>) axis.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span> Length, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> Inside, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> Inside) <span class="sc">+</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-boxplt1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-boxplt1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12: Boxplots</figcaption>
</figure>
</div>
</div>
</div>
<p>The boxplots in <a href="#fig-boxplt1">Figure&nbsp;12</a> show that the general shapes of the distributions of <code>Length</code> are broadly similar. In each case, the median is near the centre of the box. The box of the <code>Outside</code> group is entirely to the right of the box of the <code>Inside</code> group, indicating that the distribution of <code>Length</code> is higher for the <code>Outside</code> group. We can also see that the <code>Inside</code> group may have greater spread than the <code>Outside</code> group.</p>
</section>
</section>
<section id="cumulative-frequencies-and-quantiles" class="level1">
<h1>Cumulative Frequencies and Quantiles</h1>
<section id="cumulative-frequencies" class="level2">
<h2 class="anchored" data-anchor-id="cumulative-frequencies">Cumulative frequencies</h2>
<p>When the data consists of individual points rather than grouped data, we first order the data from smallest to largest and we can plot the row numbers against these.</p>
<p>For the Length data from the <em>Snodgrass</em> dataset, we have shown the ordered values earlier. If we assume that these are evenly spread throughout the distribution, these 91 values divide the distribution into 91 even parts each containing a relative frequency of 1/91 = 0.010989. In the absence of information about Length of other house pits, the above assumption seems reasonable. It would have even stronger justification if this sample of 91 were chosen at random from the population of the of all house pits, but this stretches the imagination somewhat as these 91 observations are just a chance archaeological find of what was preserved. Nevertheless, we have no real reason to consider that they are not representative of the whole population <em>Snodgrass</em> house pits.</p>
<p>To find the cumulative relative frequency, we divide the column of row numbers by 91. There is a slight problem in that we do not know the smallest, and the largest Length. Hence we make an arbitrary decision that the smallest is likely to be 4 feet with cumulative relative frequency of zero and the largest 21 feet with a cumulative frequency of 1.</p>
<p>With the Length data, there is a slight hitch in that there is duplication of the values. This is not really a problem, so long as we ignore the cumulative frequency in the table which corresponds to each first repeated value. The frequency jumps by one at the value of each observation except when there is a repetition in which case it jumps by the number of repetitions. Having obtained the cumulative relative frequencies, we can plot these against the ordered Length values.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(Length) <span class="sc">+</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-cumfrq" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-cumfrq-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;13: Cumulative Relative Frequency Curve</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-cumfrq">Figure&nbsp;13</a> shows the Cumulative Relative Frequency Curve. The procedure we described is a very basic one, and <code>R</code> software will get a better one where we make more assumptions on how to relate the observed data to the cumulative relative frequencies.</p>
</section>
<section id="quantiles" class="level2">
<h2 class="anchored" data-anchor-id="quantiles">Quantiles</h2>
<p>An important use of cumulative relative frequency graph is to find the <strong>quantiles</strong> of the distribution which is a general term for percentiles, deciles etc. For example, the <span class="math inline">\(50^{\text th}\)</span> percentile or the 5<span class="math inline">\(^{\text th}\)</span> decile (tenth) is the median which has 50% of the distribution up to, and including it. Any desired percentile can be found from the graph by drawing a horizontal line at the desired cumulative relative frequency and noting the value at which it cuts the curve. <a href="#fig-cumfrq1">Figure&nbsp;14</a> illustrates how the 30<span class="math inline">\(^{\text th}\)</span> percentile can be interpolated for the Length variable. It is desirable to use software to draw the cumulative relative frequency curves or estimate the quantiles.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>q30 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Snodgrass<span class="sc">$</span>Length, <span class="fl">0.3</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(Length) <span class="sc">+</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>() <span class="sc">+</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> q30, </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="dv">0</span>, </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">xend =</span> q30, </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">yend =</span> .<span class="dv">3</span>),  </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour=</span><span class="dv">2</span>, </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length=</span><span class="fu">unit</span>(<span class="fl">0.30</span>,<span class="st">"cm"</span>), </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ends=</span><span class="st">"first"</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> .<span class="dv">3</span>, </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">xend =</span> q30, </span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">yend =</span> .<span class="dv">3</span>), </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour=</span><span class="dv">2</span>, </span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length=</span><span class="fu">unit</span>(<span class="fl">0.30</span>,<span class="st">"cm"</span>))</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"ECDF(Length)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = q30, y = 0, xend = q30, yend = 0.3), colour = 2, : All aesthetics have length 1, but the data has 91 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = 0, y = 0.3, xend = q30, yend = 0.3), colour = 2, : All aesthetics have length 1, but the data has 91 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-cumfrq1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-cumfrq1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;14: ECDF Curve for Length data</figcaption>
</figure>
</div>
</div>
</div>
<p>The 25<span class="math inline">\(^{\text th}\)</span> percentile is known as the <strong>lower quartile</strong> and the 75<span class="math inline">\(^{\text th}\)</span> percentile is known as the <strong>upper quartile</strong>. The inter-quartile range (IQR) is defined as the difference between the upper and lower quartiles. The lower and upper quartiles will slightly differ from the lower and upper hinges for small data sets due to the differences in estimating the cumulative relative frequency function known as the empirical cumulative distribution function (<strong>ECDF</strong>).</p>
<p>The <code>R</code> function <code>quantile()</code> will get the quantiles easily. The following output shows the percentiles for Length data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(Snodgrass<span class="sc">$</span>Length, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  0%  10%  20%  30%  40%  50%  60%  70%  80%  90% 100% 
 4.0 11.5 12.0 13.5 14.0 14.5 16.0 16.5 18.0 20.0 21.0 </code></pre>
</div>
</div>
</section>
<section id="quantile-quantile-plots" class="level2">
<h2 class="anchored" data-anchor-id="quantile-quantile-plots">Quantile-Quantile Plots</h2>
<p>At times, two groups may have different numbers of observations but they may be similar in some ways and it may be appropriate to compare them. This comparison can be done in several ways but Q-Q plot is once such graph useful for such a comparison. The quantiles of the first batch is plotted against the quantiles of the second batch. A 45 degree <span class="math inline">\((Y=X)\)</span> line is also drawn. If the points on a quantile-quantile plot fall along, or close to, the 45 degree line, then the two variables follow the same distribution; if they fall on a line parallel to the 45 degree line, the two variables follow similar distributions but one has a larger location parameter (say mean, or median) than the other; if the slope differs from the 45 degree line the variables have a similar distribution but may have a different standard deviation; if the plot is linear then the distributions of <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> are different.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12344</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>nq <span class="ot">&lt;-</span> <span class="dv">201</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span> , nq, <span class="at">length.out =</span> <span class="dv">50</span>) <span class="sc">/</span> nq <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">/</span> nq</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">quantile</span>(X, p), <span class="at">y =</span> <span class="fu">quantile</span>(Y, p)) <span class="sc">+</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"X &amp; Y roughly follow</span><span class="sc">\n</span><span class="st">the same distributions"</span>) <span class="sc">+</span> </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X quantiles"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y quantiles"</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>Y2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">quantile</span>(X2, p), </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">quantile</span>(Y2, p)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span> </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"The distribution of Y has</span><span class="sc">\n</span><span class="st">a larger location (mean/median)"</span>) <span class="sc">+</span> </span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X quantiles"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y quantiles"</span>)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>Y3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">quantile</span>(X3, p), </span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">quantile</span>(Y3, p)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span> </span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"The distribution of Y has</span><span class="sc">\n</span><span class="st">a larger scale (SD, F-spread etc)"</span>) <span class="sc">+</span> </span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X quantiles"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y quantiles"</span>)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>Y4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">quantile</span>(X4, p), <span class="at">y =</span> <span class="fu">quantile</span>(Y4, p)) <span class="sc">+</span> </span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"The distributions of  X and Y </span><span class="sc">\n</span><span class="st">are different"</span>) <span class="sc">+</span> </span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X quantiles"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y quantiles"</span>)</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-qq1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-qq1-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;15: Quantile-Quantile plot patterns</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-qq1">Figure&nbsp;15</a>, different kinds of quantile-quantile plots are shown; note the following three cases in particular.</p>
<ol type="1">
<li><p><span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> follow similar distributions but the quantiles of <span class="math inline">\(Y\)</span> are a constant amount greater than the quantiles of <span class="math inline">\(X\)</span>.</p></li>
<li><p><span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> follow similar distributions but the standard deviation of <span class="math inline">\(Y\)</span> is greater than that of <span class="math inline">\(X\)</span>.</p></li>
<li><p><span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> follow different distributions.</p></li>
</ol>
<p><a href="#fig-lenqq">Figure&nbsp;16</a> gives Q-Q plot comparing the Length of house pits for Inside and Outside groups. This Q-Q plot suggests that the two distributions are similar but the average Length is greater for the Inside dwellings.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>nq <span class="ot">&lt;-</span> <span class="fu">length</span>(Snodgrass<span class="sc">$</span>Length)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span> , nq, <span class="at">length.out =</span> <span class="dv">20</span>) <span class="sc">/</span> nq <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">/</span> nq</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Inside <span class="sc">==</span> <span class="st">"Inside"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Length)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Inside <span class="sc">==</span> <span class="st">"Outside"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Length)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">quantile</span>(X, p), </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">quantile</span>(Y, p)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span> </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Length quantiles for Inside Group"</span>) <span class="sc">+</span> </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Length quantiles for Outside Group"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-lenqq" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-lenqq-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;16: Quantile-Quantile plot of Length for Inside-Outside groups</figcaption>
</figure>
</div>
</div>
</div>
<p>Note that the distribution of two variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> can be compared in a number of ways using boxplots, overlaid ECDF plots etc.</p>
</section>
</section>
<section id="exploring-relationships" class="level1">
<h1>Exploring Relationships</h1>
<section id="scatterplots" class="level2">
<h2 class="anchored" data-anchor-id="scatterplots">Scatterplots</h2>
<p>Consider data which can be written as pairs (<span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span>). The two groups of data (<span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>) need not be in the same units but they are assumed to be related in some way. Scatterplots are useful in exploring the type of relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>( <span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"testmarks.RData"</span>) ) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">url =</span> <span class="st">"http://www.massey.ac.nz/~anhsmith/data/testmarks.RData"</span>, </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">destfile =</span> <span class="st">"testmarks.RData"</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"testmarks.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(testmarks) <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>English, <span class="at">x=</span>Maths) <span class="sc">+</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-sca1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-sca1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;17: Scatter plot of English vs Maths scores</figcaption>
</figure>
</div>
</div>
</div>
<p>The data in <strong>testmarks.txt</strong> consists of the records of 40 students, at a school, on standard tests of comprehension of English and Mathematics. The test marks data can be graphed plotting English test scores against Mathematics test scores. The resulting graph, known as the scatterplot, is shown as <a href="#fig-sca1">Figure&nbsp;17</a>. This plot enables us to see if there is a relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p>Here, the scatterplot shows a clear upward trend – as the Mathematics mark increases so does the English mark, in general.</p>
<p>There are a number of useful features that can be added to a scatterplot. The individual distributions of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> can be shown by adding appropriate graphical displays (e.g.&nbsp;boxplots) along the axes. If a number of the students have the same marks then it may be advisable to add a jitter as we discussed earlier.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(testmarks) <span class="sc">+</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>English, <span class="at">x=</span>Maths) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(p1, <span class="at">type=</span><span class="st">"boxplot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-marginbp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-marginbp-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;18: English vs Maths scores</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-marginbp">Figure&nbsp;18</a>, it can be seen (with some effort) that each set of scores seems to be <em>uniformly</em> distributed along its axis, although the Maths marks exhibit gaps which may indicate different groups within the class.</p>
<p>Finally, does the variability in English marks change as the Maths mark changes, or is it fairly constant, i.e.&nbsp;does the vertical height of the scatter change from left to right? In this case the variability appears to be fairly constant (we will see why this is important later).</p>
<p>The <strong>Rangitikei</strong> data gives the number of people making recreational use of the Rangitikei River and the number of vehicles seen at a particular location and time. The data were collected at two locations (location being a categorical variable).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>( <span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"rangitikei.RData"</span>) ) {</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">url =</span> <span class="st">"http://www.massey.ac.nz/~anhsmith/data/rangitikei.RData"</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">destfile =</span> <span class="st">"rangitikei.RData"</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"rangitikei.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>If the data are grouped, this information can be added to a scatterplot by using different symbols and/or colours for each group. For example, we can show a scatterplot of people vs vehicles with different points for locations (<a href="#fig-sca2">Figure&nbsp;19</a>).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rangitikei) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span> people, <span class="at">x =</span> vehicle, <span class="at">col =</span> loc, <span class="at">shape =</span> loc) <span class="sc">+</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-sca2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-sca2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;19: Scatterplot with a grouping variable</figcaption>
</figure>
</div>
</div>
</div>
<p>There appears to be little difference in the number of people and vehicles seen among the locations.</p>
<p><a href="#fig-marginbp1">Figure&nbsp;20</a> shows the number of people against the number of vehicles seen as well as the distribution of each variable along the axes using boxplots (these are often referred to as <em>marginal distributions</em>). The first plot in <a href="#fig-marginbp1">Figure&nbsp;20</a> (A) shows the scatter of all points, whereas the second one (B) shows the scatter with the very large value (Observation #26) removed. In the first plot, the outlier shows up quite clearly in both boxplots. In the second plot, the boxplot associated with the variable ‘people’ still shows one point as an outlier, though this doesn’t appear to be as extreme as the outlier in the first plot.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> rangitikei <span class="sc">|&gt;</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>people, <span class="at">x=</span>vehicle) <span class="sc">+</span> </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(A): All of the data"</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> rangitikei <span class="sc">|&gt;</span> </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove the rows with highest value of 'people'</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(people <span class="sc">&lt;</span> <span class="fu">max</span>(people)) <span class="sc">|&gt;</span> </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>people, <span class="at">x=</span>vehicle) <span class="sc">+</span> </span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(B): Without observation #26"</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggMarginal</span>(p1, <span class="at">type=</span><span class="st">"boxplot"</span>), </span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggMarginal</span>(p2, <span class="at">type=</span><span class="st">"boxplot"</span>), </span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-marginbp1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-marginbp1-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;20: People vs vehicle plots</figcaption>
</figure>
</div>
</div>
</div>
<p>Note that the outlier point in <a href="#fig-marginbp1">Figure&nbsp;20</a> (A) showed clearly in the marginal distributions of both variables. However, it was consistent with the <em>relationship</em> between vehicle and people. While this might not surprise us (the relationship between people and vehicles might be expected to stay the same even for a location with large numbers of each), it follows that an outlier with respect to the underlying relationship between two variables will be different from an outlier in the marginal distribution sense. And such a value may not be an outlier in either marginal distribution.</p>
<p>Look again at <a href="#fig-marginbp">Figure&nbsp;18</a> - there is one student with a high Maths mark but a low English mark. While neither mark is unusual in itself, the point stands out from the rest of the scatterplot because it is unusually high or low (i.e.&nbsp;up or down) on the plot. In general an outlier with respect to the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is one whose <span class="math inline">\(Y\)</span> value is unusually large or small compared to other cases with similar <span class="math inline">\(X\)</span> values.</p>
<p>Now let’s load the <code>horsehearts</code> dataset, which contains the weights of horses’ hearts along with some other heart measurements.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>( <span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"horsehearts.RData"</span>) ) {</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">url =</span> <span class="st">"http://www.massey.ac.nz/~anhsmith/data/horsehearts.RData"</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">destfile =</span> <span class="st">"horsehearts.RData"</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"horsehearts.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(horsehearts) <span class="sc">+</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>WEIGHT, <span class="at">x=</span>EXTDIA) <span class="sc">+</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggMarginal</span>(p1, <span class="at">type=</span><span class="st">"density"</span>), </span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggMarginal</span>(p2, <span class="at">type=</span><span class="st">"density"</span>), </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-marginbp2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-marginbp2-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;21: Weight vs Exterior Widths</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-marginbp2">Figure&nbsp;21</a> shows scatterplots of weights of horses’ hearts against their exterior widths in the systolic phase (that is the contracted phase). The scatterplot indicates that a straight line would not fit the data well. On the other hand, there is some evidence the weights fall into one of two subgroups (with a value around 2.5kg being the cut off point). Scatterplots are particularly useful in pinpointing possible groupings of points so that the structure of the data is revealed which might otherwise go undetected in descriptive statistics calculated for the full data set.</p>
<p>One way of quickly assessing whether a straight line fit is reasonable is to smooth the points in the plot using a LOWESS (LOcally WEighted Scatterplot Smoother) smoothed line. The lowess (also called loess) procedure is based on local sets of points (instead of the whole data set) at a given <span class="math inline">\(x\)</span> range, and fits a smoothed line to the data. The second scatterplot in <a href="#fig-marginbp2">Figure&nbsp;21</a> shows the lowess smoother which confirms that there is curvature in the underlying relationship- possibly a cubic curve would fit this.</p>
</section>
<section id="correlation-coefficients" class="level2">
<h2 class="anchored" data-anchor-id="correlation-coefficients">Correlation coefficients</h2>
<p>As we have seen before, scatterplots provide a good starting point for exploring the relationship between two variables. In <a href="#fig-scaqud">Figure&nbsp;22</a>, the weight, <span class="math inline">\(Y\)</span>, is plotted against the exterior width <span class="math inline">\(X\)</span> (diastolic phase in column 7 of <strong>horsehearts.txt</strong>). It is helpful to divide the scatterplot into four quarters, called quadrants, by drawing a line horizontally at the average <span class="math inline">\(Y\)</span> value or weight (2.235 kg) and vertically at the average <span class="math inline">\(X\)</span> value (or diastolic exterior width 14.13 mm). The first quadrant is the top right hand side quarter. We move anti-clockwise for numbering the quadrants, and the bottom left hand side quadrant is called the third quadrant.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-scaqud" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-scaqud-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Figure&nbsp;22: Four quadrants of a scatter plot</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-scaqud">Figure&nbsp;22</a>, most of the points fall in the third and first quadrants which indicates that there is an increasing relationship between the two variables (as the length increases, the weight tends to increase which is not too surprising!).</p>
<p>Although this scatterplot indicates a nonlinear relationship would fit better than a linear relationship, we will continue to use it for illustration. It is useful to have an objective measure of how strong a linear relationship is (as we have seen, stretching or compressing one or both axes can give different impressions). This measure is called the Pearsonian <strong><em>correlation coefficient</em></strong> between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> and is denoted by <span class="math inline">\(r_{xy}\)</span> or <span class="math inline">\(r\)</span> for short:</p>
<p><span class="math display">\[
\begin{aligned}
r_{xy} &amp;= \frac{{\text {sum}(x - \bar x)(y - \bar y)}}{{\text{squareroot}[\text {sum}(x - \bar x)^2  {\text{sum}}(y - \bar y)^2 ]}} \\
\\
&amp;= \frac{\sum (x-\bar{x})(y-\bar{y}) }{\sqrt{\sum (x-\bar{x})^{2}  \sum (y-\bar{y})^{2}  } } \\
\\
&amp;=\frac{S_{xy} }{\sqrt{S_{xx} S_{yy} } }
\end{aligned}
\]</span></p>
<p>Here <span class="math inline">\(S_{xx}=S_x^2\)</span> is the variance of <span class="math inline">\(X\)</span>, <span class="math inline">\(S_{yy}=S_y^2\)</span> is the variance of <span class="math inline">\(Y\)</span>, and <span class="math inline">\(S_{xy}\)</span> is the covariance between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p>The Pearson correlation (coefficient) between WEIGHT and EXTDIA equals 0.759. Perfect correlation (+1) would occur if all points fell on a straight line in the first and third quadrants. Assuming a bivariate normal distribution, the null hypothesis that the true correlation coefficient <span class="math inline">\(\rho _{xy} =0\)</span> can be tested using the test statistic <span class="math display">\[t = \frac{{r_{xy} }}{{\sqrt {\frac{{1 - r_{xy}^2 }}{{n - 2}}} }}\]</span> Statistical software programs directly give the <span class="math inline">\(p\)</span>-value for this test. The estimated correlation coefficient of 0.759 for <span class="math inline">\((n-2)=44\)</span> df is significant (<span class="math inline">\(p\)</span>-value is close to zero). Testing of hypothesis related topics are covered in the next Chapter.</p>
<p>The scatterplot indicates that there may be two groups of horses; whose hearts weigh about 2.3 kg or more and whose heart weights are less than 2.3 kg. If possible, one should try to establish whether there are two groups for some reason (perhaps age, sex or breed). If the points tended to concentrate in quadrants 2 and 4, this would indicate that the correlation between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> is negative (as <span class="math inline">\(X\)</span> increases, <span class="math inline">\(Y\)</span> tends to decrease). If the points were evenly scattered among the four quadrants, the correlation coefficient would be close to zero.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-corp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-corp-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;23: Limitations of the correlation coefficient</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-corp">Figure&nbsp;23</a> shows a number of possible plots of <span class="math inline">\(Y\)</span> against <span class="math inline">\(X\)</span> and their associated correlation coefficients. Notice that the correlation coefficient may be close to zero even though there is a strong pattern present. This is because the correlation coefficient only measures the strength of the <em>linear</em> relationship between two variables. In the presence of subgroups the correlation coefficient can become spurious or even be close to zero when there is indeed the correlation is high within the subgroup. Simpson (1951) demonstrated that relationships noted within a population may not hold and could be the opposite within all subgroups. This amalgamation paradox can happen to most summary statistical measures including the correlation coefficient.</p>
<p>The other situation that is not shown in <a href="#fig-corp">Figure&nbsp;23</a> is that the correlation coefficient can be positive and a line would be a reasonable fit although the scatter diagram indicates that both <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> have skewed distributions suggesting that transformations should be applied.</p>
<div id="fig-corpat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/corpat.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;24: Sign of the correlation coefficient</figcaption>
</figure>
</div>
<p>To see why the sign of <span class="math inline">\(r\)</span> indicates the direction of the relationship, consider <a href="#fig-corpat">Figure&nbsp;24</a>.</p>
<ol type="1">
<li><p>Regardless of which quadrant the point is in, the contribution to <span class="math inline">\(S_{xx}\)</span> and <span class="math inline">\(S_{yy}\)</span> is positive, as these are sums of squares.</p></li>
<li><p>In the first quadrant the contribution of each point to the cross product <span class="math inline">\(S_{xy}\)</span> is <span class="math inline">\((+) \times (+)\)</span>, that is a positive amount. In the third quadrant, each contribution is <span class="math inline">\((-)\times (-)\)</span>, that is a positive amount. This is the reason that the correlation coefficient is positive if most points are in the first and third quadrants.</p></li>
<li><p>Points in the second and fourth quadrant contribute negative amounts, <span class="math inline">\((-)\times (+)\)</span> or <span class="math inline">\((+)\times (-)\)</span>, to the cross product <span class="math inline">\(S_{xy}\)</span>. If there are a considerable number of points in quadrants 2 and 4, the correlation coefficient will tend to be negative.</p></li>
</ol>
</section>
<section id="correlation-matrices" class="level2">
<h2 class="anchored" data-anchor-id="correlation-matrices">Correlation matrices</h2>
<p>When there are more than two variables of interest, it is possible to draw scatterplots of each pair of variables but this becomes a bewildering exercise as the number of variables increases. One way to keep track of these plots is to set them out in a scatterplot matrix as in <a href="#fig-matplt2">Figure&nbsp;25</a> which is based on the <code>pinetree</code> data set, which contains the circumference measurements of pine trees at four positions (<code>Top</code>, <code>Third</code>, <code>Second</code> and <code>First</code>) and in three areas of a forest. This plot also shows the simple correlation coefficients on the upper diagonal and smoothed density plots on the main diagonal of the matrix. This plot clearly shows that the variables are strongly related to each other. In particular, the Top circumference can be predicted reasonably well based on the bottom circumference. Even though the correlations are high, a quadratic model may fit better. <a href="#fig-matplt2">Figure&nbsp;25</a> seems to show a non-random pattern in the way points appear on the plot. This may be due to the Area effect because the circumference data were collected from three different areas. <a href="#fig-matplt2">Figure&nbsp;25</a> confirms that this is indeed the case.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>( <span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"pinetree.RData"</span>) ) {</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">url =</span> <span class="st">"http://www.massey.ac.nz/~anhsmith/data/pinetree.RData"</span>, </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">destfile =</span> <span class="st">"pinetree.RData"</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"pinetree.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(pinetree, <span class="at">columns =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-matplt2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-matplt2-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;25: Four quadrants of a scatter plot</figcaption>
</figure>
</div>
</div>
</div>
<p>It is also possible to use the colour option as well as the subgroup-wise correlation coefficients. Try</p>
<pre><code>ggpairs(
  pinetree, 
  columns = 2:5,
  mapping = aes(colour = Area)
  )</code></pre>
</section>
<section id="bivariate-distributions" class="level2">
<h2 class="anchored" data-anchor-id="bivariate-distributions">Bivariate distributions</h2>
<p>The two-dimensional or the <strong>bivariate probability distribution</strong> of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> can be displayed as a 2-d smoothed density plot or as a probability contour plot. <a href="#fig-matplt3">Figure&nbsp;26</a> shows such plots. This figure rather suggests that there may be two separate joint probability distributions of Maths and English scores. This clue is not obtained in the scatter plot of English score against Maths score but only from the other three plots.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> testmarks<span class="sc">$</span>English</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> testmarks<span class="sc">$</span>Maths</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>def.par <span class="ot">=</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Maths Marks"</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"English Marks"</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Scatter plot of English Scores vs Maths Scores"</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="fu">kde2d</span>(x, y, <span class="at">n =</span> <span class="dv">50</span>, <span class="at">lims =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">100</span>))</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(f1,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">"Maths Marks"</span>,</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">"English Marks"</span>,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">col=</span><span class="fu">gray</span>((<span class="dv">0</span><span class="sc">:</span><span class="dv">32</span>)<span class="sc">/</span><span class="dv">32</span>), <span class="at">main =</span> <span class="st">"Image Plot"</span>)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(f1, </span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Maths Marks"</span>,</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"English Marks"</span>,</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Density contourPlot"</span>)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>op <span class="ot">=</span> <span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(f1, <span class="at">phi =</span> <span class="dv">45</span>, <span class="at">theta =</span> <span class="dv">30</span>,</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">"Maths Marks"</span>, <span class="at">ylab =</span> <span class="st">"English Marks"</span>, <span class="at">zlab =</span> <span class="st">"density"</span>,</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">shade =</span> .<span class="dv">5</span>, <span class="at">border =</span> <span class="cn">NA</span>,</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Perspective plot (density estimation)"</span>)</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op)</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(def.par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-matplt3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-matplt3-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;26: Exploring bivariate distributions</figcaption>
</figure>
</div>
</div>
</div>
<p>In summary, scatterplots may reveal many properties and peculiarities about the relationship of <span class="math inline">\(Y\)</span> to <span class="math inline">\(X\)</span>, namely</p>
<ol type="1">
<li><p><strong>Trends</strong>: the overall trend may be positive or negative. It may be appropriate to fit a straight line or a curve.</p></li>
<li><p><strong>Outliers</strong>: points which appear to be unusual, or outliers, may be evident. In a scatterplot, the outlier need not be in the extreme scale of both <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, and anything appearing peculiar or as a rogue point must be investigated.</p></li>
<li><p><strong>Gaps</strong> may be seen in the data which may indicate that different groups are present. On the other hand, if it is known that points belong to different groups, the points can be tagged with different symbols. The basic idea is to see whether different groups follow the same pattern or different patterns.</p></li>
<li><p><strong>Variability</strong> of <span class="math inline">\(Y\)</span> change with <span class="math inline">\(X\)</span>, or may be fairly constant. <strong>Clustering</strong> of points with smaller variability when compared to rest of the points may also be revealed in some scatterplots.</p></li>
</ol>
<p>Both joint and marginal distributions of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are important. We also consider the distribution of each variable separately, and explore whether they have symmetric distributions or not.</p>
</section>
<section id="higher-dimensional-data" class="level2">
<h2 class="anchored" data-anchor-id="higher-dimensional-data">Higher dimensional data</h2>
<p>A short-cut to explore three numerical variables is to obtain a contour plot. In <a href="#fig-matplt3">Figure&nbsp;26</a>, the contours were the joint density of Maths and English marks. Instead, we can just use three numerical variables and show the third variable (Z) as a contour on a scatter plot of Y vs.&nbsp;X. What this means is that several combinations of X and Y can lead to the same Z. So we have to use some smoothing method or a model to obtain the contours and form a grid. The <code>R</code> package <em>plotly</em> is rather simple and powerful to obtain dynamic or interactive plots. The plots produced with this package are colour optimised for viewing and hence they may not be the best for printing but good for EDA purposes. We can also hover over the graph and view the graphed data. After loading the pine tree data, try-</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">type =</span> <span class="st">'contour'</span>, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span>pinetree<span class="sc">$</span>First, </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span>pinetree<span class="sc">$</span>Second, </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">z=</span>pinetree<span class="sc">$</span>Top)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-cc2b35d4981c935c0ccc" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-cc2b35d4981c935c0ccc">{"x":{"visdat":{"a6f45afd7860":["function () ","plotlyVisDat"]},"cur_data":"a6f45afd7860","attrs":{"a6f45afd7860":{"x":[23.899999999999999,25.699999999999999,27.199999999999999,30,31.699999999999999,31.699999999999999,32.600000000000001,32.799999999999997,33.100000000000001,33.399999999999999,34.5,34.600000000000001,35.799999999999997,36.299999999999997,37.600000000000001,38,41.200000000000003,43.5,44.899999999999999,47.600000000000001,17.600000000000001,23.300000000000001,24.699999999999999,25.199999999999999,26.5,26.800000000000001,27.100000000000001,28,28.899999999999999,29.399999999999999,30.800000000000001,31.600000000000001,33.200000000000003,34.700000000000003,36.100000000000001,37.5,38.799999999999997,41.5,43.200000000000003,46.700000000000003,17.899999999999999,18.800000000000001,20.899999999999999,21.600000000000001,22.699999999999999,23.5,24.100000000000001,25.300000000000001,26.199999999999999,26.899999999999999,27.399999999999999,27.800000000000001,28.5,29.100000000000001,29.899999999999999,30.800000000000001,31.600000000000001,33.700000000000003,35.600000000000001,36.200000000000003],"y":[16.300000000000001,22.800000000000001,24.5,25.199999999999999,26.399999999999999,27.300000000000001,27.300000000000001,27.899999999999999,28.100000000000001,28.699999999999999,29,29.5,30.5,31.399999999999999,32.799999999999997,33.200000000000003,34.700000000000003,35.600000000000001,37.200000000000003,38,16.800000000000001,17.899999999999999,18.699999999999999,20.399999999999999,22.699999999999999,24.100000000000001,25.5,26.699999999999999,27.800000000000001,28.899999999999999,30.100000000000001,31.199999999999999,31.699999999999999,32.5,32.799999999999997,33.899999999999999,34.700000000000003,35.899999999999999,37.5,40.899999999999999,15.1,17.300000000000001,18.399999999999999,19.800000000000001,20.5,21.199999999999999,21.899999999999999,22.399999999999999,22.800000000000001,23.300000000000001,23.699999999999999,24.100000000000001,24.600000000000001,24.600000000000001,25.199999999999999,26.699999999999999,27.800000000000001,29.199999999999999,30.5,31.100000000000001],"z":[11.1,12.5,13.699999999999999,14.199999999999999,15,16.100000000000001,16.800000000000001,17.5,17.5,18.899999999999999,20.300000000000001,21.699999999999999,22.199999999999999,23.600000000000001,24.100000000000001,24.800000000000001,25.699999999999999,26.899999999999999,27.600000000000001,30.300000000000001,10.1,10.9,11.300000000000001,12.699999999999999,13.300000000000001,14.1,15,15.300000000000001,16.100000000000001,16.699999999999999,17.5,17.5,18.199999999999999,20.5,22.100000000000001,22.899999999999999,23.699999999999999,25.600000000000001,27.899999999999999,30,10.5,10.9,11.1,11.199999999999999,11.4,11.4,11.800000000000001,12.1,12.199999999999999,12.699999999999999,13.199999999999999,13.6,14.5,14.9,15.800000000000001,16.899999999999999,17.5,18.100000000000001,19.699999999999999,22.5],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"contour"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":[]},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"scene":{"zaxis":{"title":[]}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[23.899999999999999,25.699999999999999,27.199999999999999,30,31.699999999999999,31.699999999999999,32.600000000000001,32.799999999999997,33.100000000000001,33.399999999999999,34.5,34.600000000000001,35.799999999999997,36.299999999999997,37.600000000000001,38,41.200000000000003,43.5,44.899999999999999,47.600000000000001,17.600000000000001,23.300000000000001,24.699999999999999,25.199999999999999,26.5,26.800000000000001,27.100000000000001,28,28.899999999999999,29.399999999999999,30.800000000000001,31.600000000000001,33.200000000000003,34.700000000000003,36.100000000000001,37.5,38.799999999999997,41.5,43.200000000000003,46.700000000000003,17.899999999999999,18.800000000000001,20.899999999999999,21.600000000000001,22.699999999999999,23.5,24.100000000000001,25.300000000000001,26.199999999999999,26.899999999999999,27.399999999999999,27.800000000000001,28.5,29.100000000000001,29.899999999999999,30.800000000000001,31.600000000000001,33.700000000000003,35.600000000000001,36.200000000000003],"y":[16.300000000000001,22.800000000000001,24.5,25.199999999999999,26.399999999999999,27.300000000000001,27.300000000000001,27.899999999999999,28.100000000000001,28.699999999999999,29,29.5,30.5,31.399999999999999,32.799999999999997,33.200000000000003,34.700000000000003,35.600000000000001,37.200000000000003,38,16.800000000000001,17.899999999999999,18.699999999999999,20.399999999999999,22.699999999999999,24.100000000000001,25.5,26.699999999999999,27.800000000000001,28.899999999999999,30.100000000000001,31.199999999999999,31.699999999999999,32.5,32.799999999999997,33.899999999999999,34.700000000000003,35.899999999999999,37.5,40.899999999999999,15.1,17.300000000000001,18.399999999999999,19.800000000000001,20.5,21.199999999999999,21.899999999999999,22.399999999999999,22.800000000000001,23.300000000000001,23.699999999999999,24.100000000000001,24.600000000000001,24.600000000000001,25.199999999999999,26.699999999999999,27.800000000000001,29.199999999999999,30.5,31.100000000000001],"z":[11.1,12.5,13.699999999999999,14.199999999999999,15,16.100000000000001,16.800000000000001,17.5,17.5,18.899999999999999,20.300000000000001,21.699999999999999,22.199999999999999,23.600000000000001,24.100000000000001,24.800000000000001,25.699999999999999,26.899999999999999,27.600000000000001,30.300000000000001,10.1,10.9,11.300000000000001,12.699999999999999,13.300000000000001,14.1,15,15.300000000000001,16.100000000000001,16.699999999999999,17.5,17.5,18.199999999999999,20.5,22.100000000000001,22.899999999999999,23.699999999999999,25.600000000000001,27.899999999999999,30,10.5,10.9,11.1,11.199999999999999,11.4,11.4,11.800000000000001,12.1,12.199999999999999,12.699999999999999,13.199999999999999,13.6,14.5,14.9,15.800000000000001,16.899999999999999,17.5,18.100000000000001,19.699999999999999,22.5],"type":"contour","line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>A bubble plot is a way to plot three variables on a two-dimensional scatter plot, where a third variable gives the size of the points (or ‘bubbles’). This type of plot can be restrictive for some datasets depending on the variability involved in the third variable. <a href="#fig-bubble">Figure&nbsp;27</a> shows the location of the house pits and total Area. This plot not only gives the spatial view of the tribal area but indirectly reveals the clustering of house sizes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>East, <span class="at">y=</span>South, <span class="at">colour=</span>Area, <span class="at">size=</span>Area) <span class="sc">+</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-bubble" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-bubble-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;27: A bubble plot for the Snodgrass data</figcaption>
</figure>
</div>
</div>
</div>
<p>Using the appropriate software, it is possible to explore three variables using a 3-D scatter plot. We explore the pinetree data in <a href="#fig-3d">Figure&nbsp;28</a> which clearly shows the strong relationships and the Area effect. The other forms of exploring 3 variables include 3-D surface plots.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cloud</span>(Top <span class="sc">~</span> First<span class="sc">+</span>Second, <span class="at">group=</span>Area, <span class="at">data=</span>pinetree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-3d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-3d-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;28: A 3-D plot</figcaption>
</figure>
</div>
</div>
</div>
<p><code>plotly</code> is great for interactive 3d plots (though they only work with HTML, not PDF).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(Snodgrass, <span class="at">x =</span> <span class="sc">~</span>East, <span class="at">y =</span> <span class="sc">~</span>South, <span class="at">z =</span> <span class="sc">~</span>Area) <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a2b67304374cd65bab47" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a2b67304374cd65bab47">{"x":{"visdat":{"a6f4995203":["function () ","plotlyVisDat"]},"cur_data":"a6f4995203","attrs":{"a6f4995203":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"East"},"yaxis":{"title":"South"},"zaxis":{"title":"Area"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[901.38999999999999,973.00999999999999,889.71000000000004,924.15999999999997,911.89999999999998,939.73000000000002,948.28999999999996,962.5,979.24000000000001,991.69000000000005,982.35000000000002,989.15999999999997,998.30999999999995,994.02999999999997,765.34000000000003,786.94000000000005,796.28999999999996,809.33000000000004,835.79999999999995,844.54999999999995,867.90999999999997,877.25,825.87,813.02999999999997,800.57000000000005,935.45000000000005,953.35000000000002,959.38999999999999,967.55999999999995,1017.58,1026.1400000000001,1047.9400000000001,1057.0899999999999,1018.16,932.91999999999996,922.40999999999997,908.20000000000005,898.26999999999998,854.48000000000002,864.79999999999995,894.57000000000005,898.26999999999998,905.08000000000004,913.64999999999998,866.74000000000001,865.57000000000005,859.35000000000002,816.13999999999999,837.15999999999997,825.28999999999996,824.70000000000005,809.33000000000004,789.48000000000002,749.38,754.83000000000004,773.32000000000005,774.67999999999995,778.38,788.30999999999995,825.28999999999996,835.79999999999995,854.48000000000002,878.41999999999996,889.71000000000004,943.42999999999995,939.13999999999999,924.94000000000005,965.41999999999996,999.66999999999996,939.13999999999999,852.52999999999997,886.21000000000004,963.08000000000004,979.24000000000001,1013.88,1024.97,1028.6700000000001,1005.9,990.91999999999996,1001.42,1062.73,893.40999999999997,880.37,924.94000000000005,1011.9299999999999,1028.0899999999999,849.23000000000002,840.86000000000001,948.88,905.08000000000004,780.90999999999997],"y":[75.069999999999993,81.329999999999998,163.21000000000001,193.09999999999999,216.55000000000001,250.75,229.06,211.66999999999999,194.28,153.24000000000001,175.13,250.16999999999999,211.08000000000001,228.47,297.25999999999999,255.63999999999999,228.47,204.24000000000001,184.31,165.75,203.66,180.59999999999999,142.69,158.31999999999999,177.47,451.82999999999998,407.67000000000002,385.38999999999999,365.66000000000003,274.98000000000002,256.42000000000002,216.55000000000001,196.81999999999999,200.53,359.99000000000001,384.22000000000003,405.32999999999998,425.06,397.89999999999998,376.20999999999998,356.27999999999997,330.29000000000002,310.35000000000002,289.25,288.07999999999998,314.06999999999999,336.33999999999997,381.08999999999997,341.42000000000002,359.99000000000001,291.00999999999999,309.76999999999998,339.47000000000003,345.72000000000003,325.20999999999998,276.74000000000001,360.57999999999998,414.50999999999999,399.45999999999998,413.92000000000002,125.48999999999999,144.06,116.7,92.469999999999999,74.489999999999995,86.989999999999995,97.549999999999997,105.75,130.96000000000001,425.06,427.60000000000002,449.29000000000002,301.56,271.86000000000001,181.97,170.05000000000001,147.77000000000001,106.73,332.04000000000002,314.06999999999999,176.88999999999999,245.09,266.97000000000003,266.19,300.97000000000003,230.22999999999999,99.890000000000001,105.56,173.75999999999999,122.36,317.77999999999997],"z":[144,256,306,451.5,410,264,342,399,60,217,297.5,136.5,162,169,280.5,430.5,361,380,342,240,420,369,144,203,217.5,120,143.75,196,247.5,239.25,138,110,90,256,196,225,210,256,360.75,324,210.25,224,333,432,338.25,256,315,232,232.5,247.5,315,324,255.75,217.5,370.5,360,240,217.5,210.25,239.25,137.5,288,195,156,150,132,144,240.25,175.5,169,310,181.25,110,156,143,143.75,182.25,210.25,162.5,181.25,132,272,288.85000000000002,472.5,195.75,248,162,195.75,20,156,155.25],"type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>If we wish to examine the relationships between (three or more) variables we could do so with a conditioning plot, otherwise known as a <strong>coplot</strong>. A coplot is a scatterplot matrix where each panel in the matrix is a scatterplot of the same two variables, whose observations are restricted by the values of a third (and possibly a fourth) variable.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coplot</span>(Top<span class="sc">~</span> First <span class="sc">|</span> Second<span class="sc">*</span>Area, <span class="at">data =</span> pinetree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-coplt" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2-eda_files/figure-html/fig-coplt-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;29: A co-plot</figcaption>
</figure>
</div>
</div>
</div>
<p>The coplot in <a href="#fig-coplt">Figure&nbsp;29</a> shows that pine trees are not maturing well in Area 3, given that fewer points are on the right hand side of the graph when compared to Areas 1 and 2.</p>
</section>
</section>
<section id="summary" class="level1">
<h1>Summary</h1>
<p>The first step in EDA is to familiarise oneself with the data. The dataset should be checked for errors. This is particularly important if this is to be the first time the data will be analysed. It is essential to know story behind the data such as the objectives for the collection of the data, and in what way was it collected etc. The answers to these questions should provide the focus for our own analysis of the data; i.e.&nbsp;what questions do we want to be able answer by our analysis of the data. Note that data may not always contain an answer to the questions we may have.</p>
<p>Our exploratory analysis now proceeds by attempting to understand the structure and peculiarities of the dataset. In particular, we may be interested in: numerical summaries or tabular display that present an overall summary of the data; graphical displays that describe the distribution of variables; graphical comparisons of different groups in the data; scatterplots or scatterplot matrices that reveal trends or relationships and other patterns between variables; and any interesting or outlying points in the data. The main thing in choosing graphics is that they should be simple and informative -not saying too much or too little, and not misleading. You should be able to say something meaningful on the basis of each graph.</p>
<p>Based on the EDA evidence, one or more candidate statistical models are fitted. These models are further improved or validated. After the analysis is complete, we need to be able to communicate our findings, clearly, accurately, effectively, and honestly, to any interested audience.</p>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Chatfield" class="csl-entry" role="listitem">
Chatfield, C. 1995. <em>Problem Solving, a Statistician’s Guide</em>. Chapman &amp; Hall/CRC Press, London.
</div>
<div id="ref-ioannidis_why_2005" class="csl-entry" role="listitem">
Ioannidis, John P. A. 2005. <span>“Why <span>Most</span> <span>Published</span> <span>Research</span> <span>Findings</span> <span>Are</span> <span>False</span>.”</span> <em>PLOS Medicine</em> 2 (8): e124. <a href="https://doi.org/10.1371/journal.pmed.0020124">https://doi.org/10.1371/journal.pmed.0020124</a>.
</div>
<div id="ref-nosek_preregistration_2018" class="csl-entry" role="listitem">
Nosek, Brian A., Charles R. Ebersole, Alexander C. DeHaven, and David T. Mellor. 2018. <span>“The Preregistration Revolution.”</span> <em>Proceedings of the National Academy of Sciences</em> 115 (11): 2600–2606. <a href="https://doi.org/10.1073/pnas.1708274114">https://doi.org/10.1073/pnas.1708274114</a>.
</div>
<div id="ref-Sturges" class="csl-entry" role="listitem">
Sturges, H. A. 1926. <span>“The Choice of a Class Interval.”</span> <em>Journal of the American Statistical Association</em> 21 (153): 65–66.
</div>
<div id="ref-Tufte2001" class="csl-entry" role="listitem">
Tufte, E. R. 2001. <em>The Visual Display of Quantitative Information</em>. Cheshire, Connecticut : Graphics Press.
</div>
<div id="ref-tukey1977" class="csl-entry" role="listitem">
Tukey, John W. 1977. <em>Exploratory Data Analysis</em>. Vol. 2. Reading, Mass.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../studyguide/1-data-collection.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Chapter 1: Data Collection and Quality Issues</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../studyguide/3-probability.html" class="pagination-link">
        <span class="nav-page-text">Chapter 3: Probability Concepts and Distributions</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb55" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Chapter 2: Exploratory Data Analysis (EDA)"</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Data has no meaning apart from its context."*</span><span class="kw">&lt;br&gt;</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; — Walter A Shewhart</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *Sherlock Holmes: "How do all these unusuals strike you, Watson?"*</span><span class="kw">&lt;br&gt;</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *Dr. Watson: "Their cumulative effect is certainly considerable,and yet each of them is quite possible in itself"*</span><span class="kw">&lt;br&gt;</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; — Sir Arthur Conan Doyle, _The Adventure of the Abbey Grange_</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="fu"># The two modes of data analysis</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>Exploratory Data Analysis (EDA) is exactly as it sounds: the process of exploring a data set, usually by visual examination, calculating summary statistics, and making tables and graphical displays. Exploratory analysis was likened to detective work by John @tukey1977 in his seminal book. As in a detective story, the circumstances surrounding a crime can be accidental; it is important to keep in mind that not all patterns that you see in a sample data set will reflect true patterns in the population. </span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>When analysing data, it is important to keep front of mind the purpose of the analysis. One can distinguish between the following two broad modes of analysis:</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Exploratory** or **hypothesis-generating analyses** are about *discovering new patterns*. Such analyses are typically rather unstructured exploration by summarising data and making tables and graphs, without any preconceived ideas about what might be found. The purpose is often to produce better understanding of a system, and is a good way of generating new hypotheses that can be tested with subsequent data/experiments. </span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Confirmatory** or **inferential** or **hypothesis-testing analyses** are about *testing a priori ideas*. The ideas about what patterns would be present in the data were known to the analyst *prior to seeing the data*, often in accordance with some scientific theory about the mechanistic processes in the system under study. These analyses often take the form of fitting statistical models and performing formal hypothesis tests, and evaluating evidence for particular effects.</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>Here's the important part: one must no report an exploratory analysis as though it was a confirmatory analysis. In other words, if an exploratory data analysis leads you to a new scientific hypothesis, do not report this as though it were an *a priori* hypothesis that you then tested with those data. This is scientifically dishonest and is a major contributor to the replication crisis in science [@ioannidis_why_2005]. Taking a hypothesis that occurred to you after seeing patterns in the data, and *using that same data to test that hypothesis*, is a form of circular reasoning. The strength of any evidence obtained in this way is much weaker than if one tests a bona fide *a priori* hypothesis.</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>To address the issue of testing hypotheses with the same data that generated them, scientists are increasingly encouraged to publically *preregister* their scientific hypotheses before the data are even collected <span class="co">[</span><span class="ot">@nosek_preregistration_2018</span><span class="co">]</span>. This guarantees that there was no "data snooping" for patterns prior to hypothesis testing.</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>So, if you have any *a priori* ideas and hypotheses about what patterns you might see in the data (e.g., the mean of $y$ will be higher for group $A$ than group $B$), before you look at or even collect the data, it is wise to write them down or, better still, formally preregister them. This will help clarify the purpose of the analysis, and reduce the risk of misrepresenting your results.</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>From the <span class="co">[</span><span class="ot">Center for Open Science website</span><span class="co">](https://www.cos.io/initiatives/prereg)</span>:</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Preregistration separates *hypothesis-generating* (exploratory) from *hypothesis-testing* (confirmatory) research. Both are important. But the same data cannot be used to generate and test a hypothesis, which can happen unintentionally and reduce the credibility of your results. Addressing this problem through planning improves the quality and transparency of your research. This helps you clearly report your study and helps others who may wish to build on it. For instructions on how to submit a preregistration on OSF, please visit our help guides.</span></span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a><span class="al">![](../img/confexpl.png)</span></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>Of course, *hypothesis-generating* (exploratory) and *hypothesis-testing* (confirmatory) modes of analysis are by no means mutually exclusive. Calculating summary statistics and making tables and plots are an important part of inferential analyses, and one can use inferential statistics (e.g., confidence intervals) to summarise patterns seen in exploratory analyses.</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>See <span class="co">[</span><span class="ot">this blog post</span><span class="co">](https://statmodeling.stat.columbia.edu/2022/09/06/exploratory-and-confirmatory-data-analysis/)</span> by Andrew Gelman for more on how the two modes fit together.</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a><span class="fu"># The basics of Exploratory Data Analysis</span></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>Following @Chatfield, here are some guidelines for tackling statistical analyses.</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Make sure you understand the structure of the data, including what was measured, how, and why. </span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Write down the purpose of the analysis in the form of aims, research questions, and/or hypotheses, and make a plan for how to test any formal hypotheses, including evaluating the validity of assumptions.</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Critically examine the data to check for errors, inconsistencies, and mismatches with the structure of the data as you understand it.</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Explore the data with summary statistics, tables, and plots.</span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Conduct any inferential statistical analyses. Use statistics, tables, and plots to </span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a>    a) check the assumptions of the analysis and </span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>    b) summarise the results.</span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Be honest and use common sense.</span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a>As discussed in Chapter 1, one must be congnisant to how the data were collected and any sampling biases that may be present. What is the population of interest, and is the sample representative of that population? Were the methods of recording the data accurate? Finally, what exactly does each variable represent? Are the variables contained in the data direct measurements of the variable of interest, or merely convenient surrogates?</span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a><span class="fu">## Error checking</span></span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a>  The data are assumed to be in some sort of electronic form; e.g. text file, spreadsheet, database, etc. Before analysing the data, it is prudent to check for mistakes in the data. If one has access to the raw data (e.g. returned questionnaires), one can check observations by hand. If the raw data are not available, then the best one can do is to look for observations whose values are out of allowable ranges, or are very suspicious. A common problem occurs with the coding of missing information. Missing values are commonly recorded as a blank, <span class="in">`*`</span>, <span class="in">`-1`</span>, <span class="in">`-999`</span>, or <span class="in">`NA`</span>. Only one type of coding should be used. The use of <span class="in">`NA`</span> is preferred since this is easier to spot. The use of blanks is particularly dangerous when one is exporting data from a spreadsheet to a text file. When the data from the text file is read into a computer package, a missing value may be skipped and the value from the next observation read in its place. When the data set is large, looking at a data set one observation at a time may not be feasible. In this case, plotting the data may show any observations with illegal values.</span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a><span class="fu">## Understanding data</span></span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a>After any data errors have been found and corrected, the data understanding stage commences. This stage involves tabulating, summarising, and plotting the data in many ways to gain insight into the data set. We typically want to: </span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>examine the distributions, or shapes, of individual variables; </span>
<span id="cb55-68"><a href="#cb55-68" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>compare different groups of data, with special emphasis on location and scale; </span>
<span id="cb55-69"><a href="#cb55-69" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>and discover any trends and relationships exhibited between pairs of variables. </span>
<span id="cb55-70"><a href="#cb55-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-71"><a href="#cb55-71" aria-hidden="true" tabindex="-1"></a>Again, don't fall into the trap of **data snooping**, where you develop and test hypotheses with the same data. For instance, suppose that boxplots of the income of individuals in different age groups show that youngest and oldest age groups are the most different. If one elects to perform the hypothesis test for the difference between these two groups based on observations made during EDA, the resulting $p$-value is not valid.</span>
<span id="cb55-72"><a href="#cb55-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-73"><a href="#cb55-73" aria-hidden="true" tabindex="-1"></a>In the sections below, we briefly review many common tools used to visualise data during EDA.</span>
<span id="cb55-74"><a href="#cb55-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-75"><a href="#cb55-75" aria-hidden="true" tabindex="-1"></a><span class="fu"># Categorical Data</span></span>
<span id="cb55-76"><a href="#cb55-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-77"><a href="#cb55-77" aria-hidden="true" tabindex="-1"></a>There are many methods for examining categorical variables. We will explore several methods, including tables, bar charts, dot plots, and pie charts. These tools are covered in foundation courses and hence we will briefly review them.</span>
<span id="cb55-78"><a href="#cb55-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-79"><a href="#cb55-79" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bar chart</span></span>
<span id="cb55-80"><a href="#cb55-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-81"><a href="#cb55-81" aria-hidden="true" tabindex="-1"></a>The rules for constructing a bar chart are very simple and perhaps they can be reduced to a single rule and that is to make the *height of each bar proportional to the quantity displayed*. Consider the dataset **Snodgrass** available in the <span class="in">`R`</span> package <span class="in">`archdata`</span>. This dataset contains information on the size, location and contents of 91 house pits at the Snodgrass site which was occupied between about CE 1325-1420. The variable names and their description are given below:</span>
<span id="cb55-82"><a href="#cb55-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-83"><a href="#cb55-83" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`East`</span>: East grid location of house in feet (excavation grid system)</span>
<span id="cb55-84"><a href="#cb55-84" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`South`</span>: East grid location of house in feet (excavation grid system)</span>
<span id="cb55-85"><a href="#cb55-85" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Length`</span>: House length in feet </span>
<span id="cb55-86"><a href="#cb55-86" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Width`</span>: House width in feet  </span>
<span id="cb55-87"><a href="#cb55-87" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Segment`</span>: Three areas within the site 1, 2, 3  </span>
<span id="cb55-88"><a href="#cb55-88" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Inside`</span>: Location within or outside the "white wall" Inside, Outside  </span>
<span id="cb55-89"><a href="#cb55-89" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Area`</span>: Area in square feet  </span>
<span id="cb55-90"><a href="#cb55-90" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Points`</span>: Number of projectile points  </span>
<span id="cb55-91"><a href="#cb55-91" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Abraders`</span>: Number of abraders  </span>
<span id="cb55-92"><a href="#cb55-92" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Discs`</span>: Number of discs  </span>
<span id="cb55-93"><a href="#cb55-93" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Earplugs`</span>: Number of earplugs  </span>
<span id="cb55-94"><a href="#cb55-94" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Effigies`</span>: Number of effigies  </span>
<span id="cb55-95"><a href="#cb55-95" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Ceramics`</span>: Number of ceramics  </span>
<span id="cb55-96"><a href="#cb55-96" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Total`</span>: Total Number of artifacts listed above  </span>
<span id="cb55-97"><a href="#cb55-97" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Types`</span>: Number of kinds of artifacts listed above</span>
<span id="cb55-98"><a href="#cb55-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-99"><a href="#cb55-99" aria-hidden="true" tabindex="-1"></a>The data from 91 house pits at the Snodgrass site were reported by Price and Giffin in 1979. The layout of the houses follows a grid pattern with the long axis oriented north-east surrounded by a fortification trench. There is also evidence of an interior wall that may have separated the houses inside that wall from those outside the wall. Price and Griffin use differences in house size and artifacts composition to suggest that those distinctions may have reflected rank differences between the occupants of the two areas.</span>
<span id="cb55-100"><a href="#cb55-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-101"><a href="#cb55-101" aria-hidden="true" tabindex="-1"></a>The distribution of number of Ceramics found can be displayed in the form of a bar chart; see @fig-barchart.</span>
<span id="cb55-102"><a href="#cb55-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-105"><a href="#cb55-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-106"><a href="#cb55-106" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb55-107"><a href="#cb55-107" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb55-108"><a href="#cb55-108" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb55-109"><a href="#cb55-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-110"><a href="#cb55-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-113"><a href="#cb55-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-114"><a href="#cb55-114" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-115"><a href="#cb55-115" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-116"><a href="#cb55-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-barchart</span></span>
<span id="cb55-117"><a href="#cb55-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Bar Chart of Ceramics counts'</span></span>
<span id="cb55-118"><a href="#cb55-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-119"><a href="#cb55-119" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Snodgrass, <span class="at">package =</span> <span class="st">"archdata"</span>)</span>
<span id="cb55-120"><a href="#cb55-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-121"><a href="#cb55-121" aria-hidden="true" tabindex="-1"></a>Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb55-122"><a href="#cb55-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-123"><a href="#cb55-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Ceramics) <span class="sc">+</span> </span>
<span id="cb55-124"><a href="#cb55-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span>
<span id="cb55-125"><a href="#cb55-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-126"><a href="#cb55-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-127"><a href="#cb55-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-128"><a href="#cb55-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-129"><a href="#cb55-129" aria-hidden="true" tabindex="-1"></a>The bar graph illustrates clearly that no ceramics were found in many houses but a lot were found in a few houses. This may be due to status and wealth of the occupants.</span>
<span id="cb55-130"><a href="#cb55-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-131"><a href="#cb55-131" aria-hidden="true" tabindex="-1"></a>Note that we are treating number of Ceramics as ordinal in the above graph. For nominal data software tend to order the categories alphabetically.</span>
<span id="cb55-132"><a href="#cb55-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-133"><a href="#cb55-133" aria-hidden="true" tabindex="-1"></a>However, a graph is not always the best way to display a small set of numbers. Graphs do have some disadvantages: they take up a lot of space, and they do not usually allow the recovery of the exact observations. For these reasons, particularly for a small data sets, a table is sometimes more effective. There were only three segment categories; and their counts can be simply displayed as a table.</span>
<span id="cb55-134"><a href="#cb55-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-137"><a href="#cb55-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-138"><a href="#cb55-138" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Snodgrass<span class="sc">$</span>Segment)</span>
<span id="cb55-139"><a href="#cb55-139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-140"><a href="#cb55-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-141"><a href="#cb55-141" aria-hidden="true" tabindex="-1"></a>It would be interesting to see whether the discovery of ceramics is Segment dependent. In other words, we would like to explore two factors in display. This can be done in many ways (@fig-barcharts).</span>
<span id="cb55-142"><a href="#cb55-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-145"><a href="#cb55-145" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-146"><a href="#cb55-146" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-147"><a href="#cb55-147" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-barcharts</span></span>
<span id="cb55-148"><a href="#cb55-148" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Bar Chart of Ceramics counts by Segment'</span></span>
<span id="cb55-149"><a href="#cb55-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb55-150"><a href="#cb55-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb55-151"><a href="#cb55-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-152"><a href="#cb55-152" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Snodgrass, <span class="at">package =</span> <span class="st">"archdata"</span>)</span>
<span id="cb55-153"><a href="#cb55-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-154"><a href="#cb55-154" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span></span>
<span id="cb55-155"><a href="#cb55-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Ceramics, <span class="at">fill =</span> Segment) <span class="sc">+</span> </span>
<span id="cb55-156"><a href="#cb55-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb55-157"><a href="#cb55-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bar plot with colour grouping"</span>)</span>
<span id="cb55-158"><a href="#cb55-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-159"><a href="#cb55-159" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb55-160"><a href="#cb55-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Ceramics) <span class="sc">+</span> </span>
<span id="cb55-161"><a href="#cb55-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb55-162"><a href="#cb55-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">vars</span>(Segment)) <span class="sc">+</span> </span>
<span id="cb55-163"><a href="#cb55-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Segment-wise Bar plots"</span>)</span>
<span id="cb55-164"><a href="#cb55-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-165"><a href="#cb55-165" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span></span>
<span id="cb55-166"><a href="#cb55-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Ceramics, <span class="at">fill =</span> Segment) <span class="sc">+</span></span>
<span id="cb55-167"><a href="#cb55-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb55-168"><a href="#cb55-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Clustered Barplot"</span>)</span>
<span id="cb55-169"><a href="#cb55-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-170"><a href="#cb55-170" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span></span>
<span id="cb55-171"><a href="#cb55-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>Ceramics, <span class="at">fill =</span> Segment) <span class="sc">+</span> </span>
<span id="cb55-172"><a href="#cb55-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb55-173"><a href="#cb55-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Clustered Bar plot - flipped"</span>) <span class="sc">+</span></span>
<span id="cb55-174"><a href="#cb55-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb55-175"><a href="#cb55-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-176"><a href="#cb55-176" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb55-177"><a href="#cb55-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-178"><a href="#cb55-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-179"><a href="#cb55-179" aria-hidden="true" tabindex="-1"></a>It is easy to spot that the Ceramics findings were largely from the first segment. This EDA conclusion can be drawn from all of the above plots. However, these bar plots do not rate the same as a "presentation style graphic". </span>
<span id="cb55-180"><a href="#cb55-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-181"><a href="#cb55-181" aria-hidden="true" tabindex="-1"></a>Tufte (2001) argues in favour of certain principles of graphical integrity for presentation style graphics. These are:</span>
<span id="cb55-182"><a href="#cb55-182" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-183"><a href="#cb55-183" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>The representation of numbers in a graph should be directly proportional to the numbers themselves;</span>
<span id="cb55-184"><a href="#cb55-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-185"><a href="#cb55-185" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Clear and detailed labels should be used to prevent ambiguity;</span>
<span id="cb55-186"><a href="#cb55-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-187"><a href="#cb55-187" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Provide explanations and important events pertaining to data on the graphic itself;</span>
<span id="cb55-188"><a href="#cb55-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-189"><a href="#cb55-189" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>The graph should display data variation, not design variation—visual changes in the graph should be due to the data, not changes in way the data are drawn;</span>
<span id="cb55-190"><a href="#cb55-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-191"><a href="#cb55-191" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>The number of dimensions used in the graph should not exceed the number of dimensions in the data;</span>
<span id="cb55-192"><a href="#cb55-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-193"><a href="#cb55-193" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Graphs must not quote data out of context; for example, a monthly drop in the murder rate of a city should be plotted within the context of the murder rate over the last few years, or murder rates in comparable cities over the same period.</span>
<span id="cb55-194"><a href="#cb55-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-195"><a href="#cb55-195" aria-hidden="true" tabindex="-1"></a>A final point concerns the use of colour. In many sorts of graphs, data types are differentiated by the use of colour. This practice is perfectly legitimate, but one should be aware that a surprising proportion of people have impaired colour perception, such as being unable to distinguish between red and green (see <span class="co">[</span><span class="ot">here</span><span class="co">](https://cran.r-project.org/web/packages/colorBlindness/vignettes/colorBlindness.html)</span> for colourblind-friendly pallettes). A remedy to these problems is to use different plotting symbols, line types, or shading, in conjunction with different colours. One should always make sure that the colours selected are clearly visible in the medium in which they are presented. Colours on a computer monitor can appear quite different when projected onto a screen in a lecture theatre, or when printed onto paper. </span>
<span id="cb55-196"><a href="#cb55-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-197"><a href="#cb55-197" aria-hidden="true" tabindex="-1"></a>According to @Tufte2001, a good graphical display should:</span>
<span id="cb55-198"><a href="#cb55-198" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-199"><a href="#cb55-199" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Display the data;</span>
<span id="cb55-200"><a href="#cb55-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-201"><a href="#cb55-201" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Encourage the viewer to concentrate on the substance of the data, in the context of the problem, not on the artistic merits of the graph;</span>
<span id="cb55-202"><a href="#cb55-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-203"><a href="#cb55-203" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Avoid distorting, intentionally or unintentionally, what the data have to say;</span>
<span id="cb55-204"><a href="#cb55-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-205"><a href="#cb55-205" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Have a high data to ink ratio; that is, convey the greatest amount of information in the shortest time with the least ink in the smallest space;</span>
<span id="cb55-206"><a href="#cb55-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-207"><a href="#cb55-207" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Enable one to easily compare different pieces of data;</span>
<span id="cb55-208"><a href="#cb55-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-209"><a href="#cb55-209" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Reveal overall trends and patterns in the data that are not obvious from viewing the raw numbers;</span>
<span id="cb55-210"><a href="#cb55-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-211"><a href="#cb55-211" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Reveal detailed information secondary to the main trend; for example, the location of outliers, variability of the response.</span>
<span id="cb55-212"><a href="#cb55-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-213"><a href="#cb55-213" aria-hidden="true" tabindex="-1"></a>This Chapter is largely concerned with EDA for discovery of patterns and peculiarities in a dataset. So we will not be too worried if the graphs produced are not aesthetically pleasing or does not meet a particular standard for a presentation style graph.</span>
<span id="cb55-214"><a href="#cb55-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-215"><a href="#cb55-215" aria-hidden="true" tabindex="-1"></a>The end goal of most analyses is of course some form of written report or presentation. In either case, the findings of the study, should be supported by tables and graphs created during the EDA; these should clarify and support the final conclusions, not deceive or confuse the audience. One should refrain from showing all tables and plots that were created, but rather a careful selection that reinforces the main findings. The remaining figures can, if necessary, be placed in an appendix of the written report. The figures and tables that are shown should be well labelled and annotated. Abbreviations and cryptic variable names should be replaced by sensible labels and descriptions. The emphasis should be on conveying information rather than producing an eye catching plot. Special care should be taken to ensure that the table or graph cannot be easily misinterpreted.</span>
<span id="cb55-216"><a href="#cb55-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-217"><a href="#cb55-217" aria-hidden="true" tabindex="-1"></a>In addition, a poorly made graph can be deceptive. This is a problem both in the understanding the data phase, and the presenting the data phase. One common mistake (but by no means the only one) in creating a graph is to use more dimensions to represent the data than there are data dimensions. For example, it is not uncommon to see a bar chart where the bars are drawn as three dimensional rectangular prisms. The false perspective actually obscures the differences in the heights of the bars.</span>
<span id="cb55-218"><a href="#cb55-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-219"><a href="#cb55-219" aria-hidden="true" tabindex="-1"></a>Another pitfall is to use a clever graphic rather than one that clearly presents the data. The classic example of this is a pictogram, where pictures of varying size represent some quantities. Pictograms are often drawn dishonestly: to show a two-fold difference, each side of the picture is increased by a factor of two, so the area is in fact increased by a factor of four. Dishonesty in data presentation is clearly unacceptable. But even an honest pictogram is usually not the best way to present data. It is difficult to accurately judge differences between areas; which is what a pictogram asks the viewer to do.</span>
<span id="cb55-220"><a href="#cb55-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-221"><a href="#cb55-221" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pie charts</span></span>
<span id="cb55-222"><a href="#cb55-222" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-223"><a href="#cb55-223" aria-hidden="true" tabindex="-1"></a>Pie charts are a popular, though usually rather poor, way of presenting data. Like bar charts, they frequently use a large figure to represent just a few numbers. Pie charts also have a poor accuracy of decoding. That means people's impression of the difference in size between two pie slices is often quite different from the actual difference in size. Pie charts use angles to represent percentages; people tend to underestimate the size of acute angles and overestimate the size of obtuse angles. The exploded pie chart makes it more difficult to accurately compare pie slices: the exploded piece always appears bigger. The three dimensional pie chart is even worse. Bar charts, dot charts, or tables should be preferred to pie charts.</span>
<span id="cb55-224"><a href="#cb55-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-225"><a href="#cb55-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-226"><a href="#cb55-226" aria-hidden="true" tabindex="-1"></a><span class="fu"># Numerical Data</span></span>
<span id="cb55-227"><a href="#cb55-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-228"><a href="#cb55-228" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dotplot</span></span>
<span id="cb55-229"><a href="#cb55-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-230"><a href="#cb55-230" aria-hidden="true" tabindex="-1"></a>One of the simplest kinds of graph for a numerical variable is the single line (or one dimensional) graph. Each observation is represented by a point (or a star <span class="in">`*`</span> or a dot <span class="in">`.`</span>) on the line. These graphs can be useful to see the rough distribution and gaps, if any, in the data. @fig-dot1 shows a dotplot of Length of the house pits for the Inside and Outside groupings. Evidently privileged tribes lived inside in general, and the length of their dwellings is longer.</span>
<span id="cb55-231"><a href="#cb55-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-234"><a href="#cb55-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-235"><a href="#cb55-235" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-236"><a href="#cb55-236" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-237"><a href="#cb55-237" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-dot1</span></span>
<span id="cb55-238"><a href="#cb55-238" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'A typical dot plot for two groups'</span></span>
<span id="cb55-239"><a href="#cb55-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-240"><a href="#cb55-240" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span></span>
<span id="cb55-241"><a href="#cb55-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>Inside, <span class="at">y=</span>Length) <span class="sc">+</span> </span>
<span id="cb55-242"><a href="#cb55-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis=</span><span class="st">'y'</span>, <span class="at">dotsize=</span>.<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb55-243"><a href="#cb55-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb55-244"><a href="#cb55-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-245"><a href="#cb55-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-246"><a href="#cb55-246" aria-hidden="true" tabindex="-1"></a>On reflection, the one dimensional dotplot gives rise to a second dimension wherever observations are identical or nearly the same. In a dotplot such points are usually stacked. As our eyes tend to pick up trends very easily, they tend to be distracted by the vertical changes. The main problem here is that some of the values which coincide by chance may be taken to represent real increases in density. To overcome this we try 'jittering' the data, which is equivalent to plotting a random number on the vertical axis against the data values on the horizontal axis. It is suggested that the vertical jitter be restricted to a small range so that the overall effect is that of a one-dimensional spread with greater, or lesser, density of points along the graph. @fig-dot2 shows a jittered dotplot. You can decide for yourself which strategy is better.</span>
<span id="cb55-247"><a href="#cb55-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-248"><a href="#cb55-248" aria-hidden="true" tabindex="-1"></a>Clearly, the use of jittering is much more relevant for larger sets of data. Notice that with jittering we are interested in the relative density of the graph in different places rather than in trends.</span>
<span id="cb55-249"><a href="#cb55-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-250"><a href="#cb55-250" aria-hidden="true" tabindex="-1"></a>As the vertical reading is determined at random our eyes may be distracted by a seeming trend which is mainly due to this randomness. For this reason, it is helpful to try more than one plot with different levels of jitter This is in the spirit of EDA, in which data is viewed from as many angles as is feasible. The other side of this coin is that conclusions from one display of data should be treated with some scepticism. The availability of computers allows data to be plotted, tabulated and transformed quickly, so we should look at it several ways to better appreciate the peculiarities inherent in our data.</span>
<span id="cb55-251"><a href="#cb55-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-252"><a href="#cb55-252" aria-hidden="true" tabindex="-1"></a>In practice, one tends to avoid jittering except in (two-variable) scatter plots where there are many repeated $(x, y)$ points. Graphs with jitter are mainly needed when the data are heavily rounded, discrete, or grouped in some way, or there are a large number of points to be plotted.</span>
<span id="cb55-253"><a href="#cb55-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-256"><a href="#cb55-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-257"><a href="#cb55-257" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb55-258"><a href="#cb55-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-dot2</span></span>
<span id="cb55-259"><a href="#cb55-259" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'A jittered dot plot'</span></span>
<span id="cb55-260"><a href="#cb55-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-261"><a href="#cb55-261" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb55-262"><a href="#cb55-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>Inside, <span class="at">y=</span>Length) <span class="sc">+</span></span>
<span id="cb55-263"><a href="#cb55-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span>.<span class="dv">2</span>, <span class="at">height=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb55-264"><a href="#cb55-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb55-265"><a href="#cb55-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-266"><a href="#cb55-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-267"><a href="#cb55-267" aria-hidden="true" tabindex="-1"></a><span class="fu">## Histograms</span></span>
<span id="cb55-268"><a href="#cb55-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-269"><a href="#cb55-269" aria-hidden="true" tabindex="-1"></a>The histogram is a standard method of showing the distribution of a quantitative variable. A histogram is made by dividing the range of a variable into "bins" and counting the number of data points that fall within each bin. It is like a bar chart after forcing a quantitative variable into bins. It can be used for discrete ungrouped data, but a bar chart is generally more suitable for discrete data because histograms can mislead the reader into thinking that values exist other than at the centre of the intervals. </span>
<span id="cb55-270"><a href="#cb55-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-271"><a href="#cb55-271" aria-hidden="true" tabindex="-1"></a>@fig-hist1 shows the histogram of <span class="in">`Length`</span>. Clearly the distribution is far from symmetric and left skewed. The bimodal pattern also suggests subgrouping.</span>
<span id="cb55-272"><a href="#cb55-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-275"><a href="#cb55-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-276"><a href="#cb55-276" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-277"><a href="#cb55-277" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-hist1</span></span>
<span id="cb55-278"><a href="#cb55-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'A typical histogram'</span></span>
<span id="cb55-279"><a href="#cb55-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-280"><a href="#cb55-280" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb55-281"><a href="#cb55-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Length) <span class="sc">+</span> </span>
<span id="cb55-282"><a href="#cb55-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">12</span>, </span>
<span id="cb55-283"><a href="#cb55-283" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb55-284"><a href="#cb55-284" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"white"</span>)</span>
<span id="cb55-285"><a href="#cb55-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-286"><a href="#cb55-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-287"><a href="#cb55-287" aria-hidden="true" tabindex="-1"></a>Notice that a different shape of histogram may result depending on the class intervals (bins) used (that is by choosing different class widths or different midpoints of the classes). This suggests that it may be wise to draw more than one histogram for a given data set particularly if statements are to be made about modes or gaps in the data. The guideline for the maximum number of intervals, $L$, can follow the same formula as for stem-and-leaf displays. Some software use the @Sturges formula namely $$\texttt{bin width} = \frac {\texttt{range}(x)} {\log_2(n)+1}.$$ For fixing the width of the bins, the range of the data is divided by the sum of one and the base two logarithm of the sample size.</span>
<span id="cb55-288"><a href="#cb55-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-289"><a href="#cb55-289" aria-hidden="true" tabindex="-1"></a>There are a few ways to scale the y-axis of a histogram, as shown in @fig-threehist:</span>
<span id="cb55-290"><a href="#cb55-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-291"><a href="#cb55-291" aria-hidden="true" tabindex="-1"></a>(a) **Frequency histograms** show the counts in each bin; the heights of the bars sum to $n$. </span>
<span id="cb55-292"><a href="#cb55-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-293"><a href="#cb55-293" aria-hidden="true" tabindex="-1"></a>(b) **Relative frequency histograms** show the proportions or percent of data in each bin—the counts in each bin divided by the total; the heights sum to 1 or 100%.</span>
<span id="cb55-294"><a href="#cb55-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-295"><a href="#cb55-295" aria-hidden="true" tabindex="-1"></a>(c) **Density histograms** show the densities; the areas (heights $\times$ widths) of the bars sum to 1. </span>
<span id="cb55-296"><a href="#cb55-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-297"><a href="#cb55-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-298"><a href="#cb55-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,  warning=FALSE, message=FALSE}</span></span>
<span id="cb55-299"><a href="#cb55-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4 </span></span>
<span id="cb55-300"><a href="#cb55-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb55-301"><a href="#cb55-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Three types of histograms"</span></span>
<span id="cb55-302"><a href="#cb55-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-threehist</span></span>
<span id="cb55-303"><a href="#cb55-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-304"><a href="#cb55-304" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span>  Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb55-305"><a href="#cb55-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-306"><a href="#cb55-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Length) <span class="sc">+</span></span>
<span id="cb55-307"><a href="#cb55-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb55-308"><a href="#cb55-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb55-309"><a href="#cb55-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(a) Frequency histogram"</span>, </span>
<span id="cb55-310"><a href="#cb55-310" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Heights of the bars sum to n"</span>)</span>
<span id="cb55-311"><a href="#cb55-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-312"><a href="#cb55-312" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span>  Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb55-313"><a href="#cb55-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-314"><a href="#cb55-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Length) <span class="sc">+</span></span>
<span id="cb55-315"><a href="#cb55-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb55-316"><a href="#cb55-316" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="dv">20</span>, </span>
<span id="cb55-317"><a href="#cb55-317" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count)))</span>
<span id="cb55-318"><a href="#cb55-318" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb55-319"><a href="#cb55-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb55-320"><a href="#cb55-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(b) Relative frequency histogram"</span>,</span>
<span id="cb55-321"><a href="#cb55-321" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Heights sum to 100%"</span>) <span class="sc">+</span> </span>
<span id="cb55-322"><a href="#cb55-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent)</span>
<span id="cb55-323"><a href="#cb55-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-324"><a href="#cb55-324" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span>  Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb55-325"><a href="#cb55-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-326"><a href="#cb55-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Length) <span class="sc">+</span></span>
<span id="cb55-327"><a href="#cb55-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb55-328"><a href="#cb55-328" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="dv">20</span>, </span>
<span id="cb55-329"><a href="#cb55-329" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb55-330"><a href="#cb55-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb55-331"><a href="#cb55-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(c) Density histogram"</span>,</span>
<span id="cb55-332"><a href="#cb55-332" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Heights x widths sum to 1"</span>)</span>
<span id="cb55-333"><a href="#cb55-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-334"><a href="#cb55-334" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb55-335"><a href="#cb55-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-336"><a href="#cb55-336" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span>
<span id="cb55-337"><a href="#cb55-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-338"><a href="#cb55-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-339"><a href="#cb55-339" aria-hidden="true" tabindex="-1"></a>If, instead of drawing blocks over the class intervals as in a histogram, we join the mid points of the tops of the bars, we obtain a display known as a **frequency polygon** . If we use relative frequencies, it is a **relative frequency polygon**; see @fig-hist3.</span>
<span id="cb55-340"><a href="#cb55-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-343"><a href="#cb55-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-344"><a href="#cb55-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-345"><a href="#cb55-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-hist3</span></span>
<span id="cb55-346"><a href="#cb55-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'A typical frequency polygon'</span></span>
<span id="cb55-347"><a href="#cb55-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-348"><a href="#cb55-348" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb55-349"><a href="#cb55-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Length, <span class="at">y =</span> <span class="fu">after_stat</span>(density)) <span class="sc">+</span></span>
<span id="cb55-350"><a href="#cb55-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>( <span class="at">bins =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb55-351"><a href="#cb55-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-352"><a href="#cb55-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-353"><a href="#cb55-353" aria-hidden="true" tabindex="-1"></a>@fig-hist3a shows a kernel density plot, which is a method that produces a smoother density line. </span>
<span id="cb55-354"><a href="#cb55-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-355"><a href="#cb55-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-358"><a href="#cb55-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-359"><a href="#cb55-359" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-360"><a href="#cb55-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-hist3a</span></span>
<span id="cb55-361"><a href="#cb55-361" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'A typical smoothed density curve'</span></span>
<span id="cb55-362"><a href="#cb55-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-363"><a href="#cb55-363" aria-hidden="true" tabindex="-1"></a>Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb55-364"><a href="#cb55-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-365"><a href="#cb55-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(Length) <span class="sc">+</span> </span>
<span id="cb55-366"><a href="#cb55-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb55-367"><a href="#cb55-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">alpha =</span> .<span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"darkorange2"</span>)</span>
<span id="cb55-368"><a href="#cb55-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-369"><a href="#cb55-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-370"><a href="#cb55-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-371"><a href="#cb55-371" aria-hidden="true" tabindex="-1"></a>::: {.content-visible unless-format="pdf"}</span>
<span id="cb55-372"><a href="#cb55-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-373"><a href="#cb55-373" aria-hidden="true" tabindex="-1"></a>Kernel Density Estimation (KDE) is generated by dropping a little mini-distribution, usually a normal curve, on each individual point and summing them up (@fig-kdegif).</span>
<span id="cb55-374"><a href="#cb55-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-375"><a href="#cb55-375" aria-hidden="true" tabindex="-1"></a><span class="al">![A demonstration of kernel density estimation](../img/kde.gif)</span>{#fig-kdegif}</span>
<span id="cb55-376"><a href="#cb55-376" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb55-377"><a href="#cb55-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-378"><a href="#cb55-378" aria-hidden="true" tabindex="-1"></a>::: {.content-visible unless-format="html"}</span>
<span id="cb55-379"><a href="#cb55-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-380"><a href="#cb55-380" aria-hidden="true" tabindex="-1"></a>Kernel Density Estimation (KDE) is generated by dropping a little mini-distribution, usually a normal curve, on each individual point and summing them up (@fig-kdepng).</span>
<span id="cb55-381"><a href="#cb55-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-382"><a href="#cb55-382" aria-hidden="true" tabindex="-1"></a><span class="al">![A demonstration of kernel density estimation; there's a coloured normal kernel for each of the data points, and they sum to the grey density.](../img/kde.png)</span>{#fig-kdepng}</span>
<span id="cb55-383"><a href="#cb55-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-384"><a href="#cb55-384" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb55-385"><a href="#cb55-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-386"><a href="#cb55-386" aria-hidden="true" tabindex="-1"></a>These smooth plots are also useful to see the type of skewness involved, multimodality (several peaks) and unusual observations (or outliers). The disadvantage is that we may over-smooth and mask some of the subgrouping patterns; see @fig-hist4. Even though the two distributions appear to be similar, the length distribution for the Inside group has a larger mean/median etc (called the location parameters).</span>
<span id="cb55-387"><a href="#cb55-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-390"><a href="#cb55-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-391"><a href="#cb55-391" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-392"><a href="#cb55-392" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-hist4</span></span>
<span id="cb55-393"><a href="#cb55-393" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Identification of Subgrouping'</span></span>
<span id="cb55-394"><a href="#cb55-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-395"><a href="#cb55-395" aria-hidden="true" tabindex="-1"></a>Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb55-396"><a href="#cb55-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-397"><a href="#cb55-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Length, </span>
<span id="cb55-398"><a href="#cb55-398" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> Inside) <span class="sc">+</span> </span>
<span id="cb55-399"><a href="#cb55-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb55-400"><a href="#cb55-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-401"><a href="#cb55-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-402"><a href="#cb55-402" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretical Distributions</span></span>
<span id="cb55-403"><a href="#cb55-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-404"><a href="#cb55-404" aria-hidden="true" tabindex="-1"></a>A histogram gives a general picture of the frequencies or relative frequencies of the data. If an observation is taken at random from the population from which the sample was drawn, the chance of it falling in any one of the class intervals should be approximately proportional to the area of the block over that interval (not exactly proportional because the histogram was only based on a sample from the population, not the population itself).</span>
<span id="cb55-405"><a href="#cb55-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-406"><a href="#cb55-406" aria-hidden="true" tabindex="-1"></a>If we could draw a histogram for the whole population, then the probabilities would be exact. The relative frequencies form a probability distribution and if the class intervals are small enough the tops of the bars of the histogram would often approximate a smooth curve such as the density plot. In many cases this smooth curve is almost symmetrical with a rounded peak at the centre. One particular shape, fitting a certain mathematical formula, is a very good approximation to many sets of data. For instance, heights of people, weights of animals or yields of wheat all follow this distribution fairly well (although theoretically the distribution has an infinite range of possible values). One of the widely used *theoretical* distribution is called the *Normal* or *Gaussian* distribution but we will not bore you with its formula. However, most software can compute the tail areas (probabilities) under theoretical distributions. We shall study this distribution in greater detail in a Chapter 3. For the moment let us note that our EDA techniques should provide us with information about the parameters of the distribution, and we also want graphical techniques that display the continuous nature of the data.</span>
<span id="cb55-407"><a href="#cb55-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-408"><a href="#cb55-408" aria-hidden="true" tabindex="-1"></a>Discrete data also have probability distributions and the bar graph gives a general picture of its shape. One commonly occurring discrete theoretical distribution is known as the **Poisson distribution** and approximates reasonably well the numbers of road accidents over a fixed time period. The main feature of a Poisson distribution is that there is a peak at the nearest integer below or equal to the average, and then a steady falling off. The mean is a parameter of the model, so we want our exploratory techniques to tell us about the mean, and to help us decide whether or not the Poisson model is appropriate for a given set of data. Theoretically, possible values are any whole positive numbers, but large numbers of accidents are very unlikely. Again, any graphical method we use must properly display the discrete nature of Poisson data. The other commonly adopted discrete distribution is the binomial distribution. This distribution is valid when the individual outcomes are classified into two categories such as Success and Failure.</span>
<span id="cb55-409"><a href="#cb55-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-410"><a href="#cb55-410" aria-hidden="true" tabindex="-1"></a><span class="fu"># Summary Statistics and their display</span></span>
<span id="cb55-411"><a href="#cb55-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-412"><a href="#cb55-412" aria-hidden="true" tabindex="-1"></a>For a small to moderate size batch of numbers, the stem-and-leaf display may reveal at a glance all of the peculiarities in the data. However it is useful, particularly for large batches, to calculate some statistics which capture the main features of the data. These are called **summary statistics** and they help us to gain an overall picture without being distracted by some individual peculiarities. You must be familiar with the common summary statistics such as mean, median, standard deviation etc.</span>
<span id="cb55-413"><a href="#cb55-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-414"><a href="#cb55-414" aria-hidden="true" tabindex="-1"></a>The <span class="in">`R`</span> default function <span class="in">`summary()`</span> gives the mean, median, lower and upper quartiles, minimum, and maximum for a variable) as well as for a dataframe) For the length variable in our *Snodgrass* dataset, we obtain this default summary as</span>
<span id="cb55-415"><a href="#cb55-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-416"><a href="#cb55-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb55-417"><a href="#cb55-417" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Snodgrass<span class="sc">$</span>Length)</span>
<span id="cb55-418"><a href="#cb55-418" aria-hidden="true" tabindex="-1"></a><span class="co"># Try summary(Snodgrass)</span></span>
<span id="cb55-419"><a href="#cb55-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-420"><a href="#cb55-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-421"><a href="#cb55-421" aria-hidden="true" tabindex="-1"></a>We need used <span class="in">`R`</span> functions such as <span class="in">`sd()`</span> to obtain the standard deviation etc. Packages such as <span class="in">`psych`</span> contain functions to get enhanced summaries. Try</span>
<span id="cb55-422"><a href="#cb55-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-423"><a href="#cb55-423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE, results='hide'}</span></span>
<span id="cb55-424"><a href="#cb55-424" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-425"><a href="#cb55-425" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb55-426"><a href="#cb55-426" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(Snodgrass<span class="sc">$</span>Length)</span>
<span id="cb55-427"><a href="#cb55-427" aria-hidden="true" tabindex="-1"></a><span class="fu">describeBy</span>(Snodgrass<span class="sc">$</span>Length, <span class="at">group=</span>Snodgrass<span class="sc">$</span>Inside)</span>
<span id="cb55-428"><a href="#cb55-428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-429"><a href="#cb55-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-430"><a href="#cb55-430" aria-hidden="true" tabindex="-1"></a>For EDA purposes, @tukey1977 suggested to generate further positional summaries using the concept of median. The sorted (smallest to largest) Length data from the *Snodgrass* dataset was presented earlier for discussing the stem plot. In total $n = 91$ house pits were present, so that the **median** Length is the $46^{\text th}$ value and equals <span class="in">`r median(Snodgrass$Length)`</span>. Notice that the median is in the middle of the distribution having 45 points on either side.</span>
<span id="cb55-431"><a href="#cb55-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-432"><a href="#cb55-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb55-433"><a href="#cb55-433" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(Snodgrass<span class="sc">$</span>Length)</span>
<span id="cb55-434"><a href="#cb55-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-435"><a href="#cb55-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-436"><a href="#cb55-436" aria-hidden="true" tabindex="-1"></a><span class="fu">## Symmetry plots</span></span>
<span id="cb55-437"><a href="#cb55-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-438"><a href="#cb55-438" aria-hidden="true" tabindex="-1"></a>A symmetry plot is based on the distance of left and right side points. If the underlying distribution is symmetric, the points on the left and right side would be roughly equidistant from the median. For the length data, we obtain the symmetry plot after writing a little <span class="in">`R`</span> function as follows:</span>
<span id="cb55-439"><a href="#cb55-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-440"><a href="#cb55-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb55-441"><a href="#cb55-441" aria-hidden="true" tabindex="-1"></a>symmetryplot <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb55-442"><a href="#cb55-442" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb55-443"><a href="#cb55-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(ggplot2)</span>
<span id="cb55-444"><a href="#cb55-444" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-445"><a href="#cb55-445" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(x)</span>
<span id="cb55-446"><a href="#cb55-446" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(x) <span class="sc">%/%</span> <span class="dv">2</span></span>
<span id="cb55-447"><a href="#cb55-447" aria-hidden="true" tabindex="-1"></a>  sx <span class="ot">&lt;-</span> <span class="fu">sort</span>(x)</span>
<span id="cb55-448"><a href="#cb55-448" aria-hidden="true" tabindex="-1"></a>  dfm <span class="ot">&lt;-</span> <span class="fu">tibble</span>( </span>
<span id="cb55-449"><a href="#cb55-449" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> <span class="fu">median</span>(x) <span class="sc">-</span> sx[<span class="dv">1</span><span class="sc">:</span>m], </span>
<span id="cb55-450"><a href="#cb55-450" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">rev</span>(sx)[<span class="dv">1</span><span class="sc">:</span>m] <span class="sc">-</span> <span class="fu">median</span>(x)</span>
<span id="cb55-451"><a href="#cb55-451" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-452"><a href="#cb55-452" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-453"><a href="#cb55-453" aria-hidden="true" tabindex="-1"></a>  dfm <span class="sc">|&gt;</span> </span>
<span id="cb55-454"><a href="#cb55-454" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-455"><a href="#cb55-455" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y)) <span class="sc">+</span> </span>
<span id="cb55-456"><a href="#cb55-456" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>X)) <span class="sc">+</span> </span>
<span id="cb55-457"><a href="#cb55-457" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb55-458"><a href="#cb55-458" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Distance below median"</span>) <span class="sc">+</span> </span>
<span id="cb55-459"><a href="#cb55-459" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Distance above median"</span>)</span>
<span id="cb55-460"><a href="#cb55-460" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-461"><a href="#cb55-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-462"><a href="#cb55-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-463"><a href="#cb55-463" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb55-464"><a href="#cb55-464" aria-hidden="true" tabindex="-1"></a><span class="fu">symmetryplot</span>(Snodgrass<span class="sc">$</span>Length)</span>
<span id="cb55-465"><a href="#cb55-465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-466"><a href="#cb55-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-467"><a href="#cb55-467" aria-hidden="true" tabindex="-1"></a>The points do not follow the $45^\circ$ line where $Y=X$; divergence from this line indicates a lack of symmetry.</span>
<span id="cb55-468"><a href="#cb55-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-469"><a href="#cb55-469" aria-hidden="true" tabindex="-1"></a>If each half of the distribution is further divided in halves, we obtain the **fourths** or( **hinges**), as the medians for the lower and upper halves. The end points, the minimum and the maximum are called the lower and upper **extreme** values, respectively.</span>
<span id="cb55-470"><a href="#cb55-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-471"><a href="#cb55-471" aria-hidden="true" tabindex="-1"></a>The <span class="in">`R`</span> function obtains the set (minimum, lower hinge, median, upper hinge, maximum) in its function <span class="in">`fivenum`</span>.</span>
<span id="cb55-472"><a href="#cb55-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-473"><a href="#cb55-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb55-474"><a href="#cb55-474" aria-hidden="true" tabindex="-1"></a><span class="co"># Five number summary</span></span>
<span id="cb55-475"><a href="#cb55-475" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(Snodgrass<span class="sc">$</span>Length)</span>
<span id="cb55-476"><a href="#cb55-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-477"><a href="#cb55-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-478"><a href="#cb55-478" aria-hidden="true" tabindex="-1"></a><span class="fu">## Box plots</span></span>
<span id="cb55-479"><a href="#cb55-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-480"><a href="#cb55-480" aria-hidden="true" tabindex="-1"></a>A **boxplot** (or sometimes a *box-and-whisker plot*) is a visual display of the five-number summary, which can be used to assess the skew in the data. The components of a boxplot are explained in @fig-boxplt.</span>
<span id="cb55-481"><a href="#cb55-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-482"><a href="#cb55-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-485"><a href="#cb55-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-486"><a href="#cb55-486" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb55-487"><a href="#cb55-487" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb55-488"><a href="#cb55-488" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb55-489"><a href="#cb55-489" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplt</span></span>
<span id="cb55-490"><a href="#cb55-490" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Annotated boxplot"</span></span>
<span id="cb55-491"><a href="#cb55-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-492"><a href="#cb55-492" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">fivenum</span>(Snodgrass<span class="sc">$</span>Length)</span>
<span id="cb55-493"><a href="#cb55-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-494"><a href="#cb55-494" aria-hidden="true" tabindex="-1"></a>Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb55-495"><a href="#cb55-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-496"><a href="#cb55-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>Length) <span class="sc">+</span></span>
<span id="cb55-497"><a href="#cb55-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span>.<span class="dv">15</span>, <span class="at">col=</span><span class="st">"darkorange2"</span>) <span class="sc">+</span> </span>
<span id="cb55-498"><a href="#cb55-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span>.<span class="dv">18</span>,.<span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb55-499"><a href="#cb55-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fl">3.5</span>,<span class="fl">21.5</span>) <span class="sc">+</span></span>
<span id="cb55-500"><a href="#cb55-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb55-501"><a href="#cb55-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb55-502"><a href="#cb55-502" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>, </span>
<span id="cb55-503"><a href="#cb55-503" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.02</span>,.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>, <span class="fl">0.03</span>),</span>
<span id="cb55-504"><a href="#cb55-504" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">7.5</span>, fn), </span>
<span id="cb55-505"><a href="#cb55-505" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">c</span>(</span>
<span id="cb55-506"><a href="#cb55-506" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Min or</span><span class="sc">\n</span><span class="st">1.5*IQR"</span>, </span>
<span id="cb55-507"><a href="#cb55-507" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Outlier"</span>,</span>
<span id="cb55-508"><a href="#cb55-508" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Lower</span><span class="sc">\n</span><span class="st">hinge</span><span class="sc">\n</span><span class="st">Q1"</span>, </span>
<span id="cb55-509"><a href="#cb55-509" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Median</span><span class="sc">\n</span><span class="st">Q2"</span>, </span>
<span id="cb55-510"><a href="#cb55-510" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Upper</span><span class="sc">\n</span><span class="st">hinge</span><span class="sc">\n</span><span class="st">Q3"</span>,</span>
<span id="cb55-511"><a href="#cb55-511" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Max or</span><span class="sc">\n</span><span class="st">1.5*IQR"</span></span>
<span id="cb55-512"><a href="#cb55-512" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb55-513"><a href="#cb55-513" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb55-514"><a href="#cb55-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb55-515"><a href="#cb55-515" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> fn[<span class="dv">2</span>], <span class="at">xend =</span> fn[<span class="dv">4</span>],</span>
<span id="cb55-516"><a href="#cb55-516" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="sc">-</span>.<span class="dv">1</span>, <span class="at">yend =</span> <span class="sc">-</span>.<span class="dv">1</span>),</span>
<span id="cb55-517"><a href="#cb55-517" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>), <span class="at">ends =</span> <span class="st">"both"</span>)</span>
<span id="cb55-518"><a href="#cb55-518" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb55-519"><a href="#cb55-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb55-520"><a href="#cb55-520" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb55-521"><a href="#cb55-521" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">-</span>.<span class="dv">125</span>, </span>
<span id="cb55-522"><a href="#cb55-522" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">mean</span>(fn[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]<span class="sc">+</span>.<span class="dv">3</span>),</span>
<span id="cb55-523"><a href="#cb55-523" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Inter-Quatile Range</span><span class="sc">\n</span><span class="st">(IQR)"</span></span>
<span id="cb55-524"><a href="#cb55-524" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb55-525"><a href="#cb55-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb55-526"><a href="#cb55-526" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> fn[<span class="dv">2</span>], <span class="at">xend =</span> fn[<span class="dv">2</span>] <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> (fn[<span class="dv">4</span>] <span class="sc">-</span> fn[<span class="dv">2</span>]),</span>
<span id="cb55-527"><a href="#cb55-527" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="sc">-</span>.<span class="dv">05</span>, <span class="at">yend =</span> <span class="sc">-</span>.<span class="dv">05</span>),</span>
<span id="cb55-528"><a href="#cb55-528" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>))</span>
<span id="cb55-529"><a href="#cb55-529" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb55-530"><a href="#cb55-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb55-531"><a href="#cb55-531" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb55-532"><a href="#cb55-532" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">-</span>.<span class="dv">06</span>,</span>
<span id="cb55-533"><a href="#cb55-533" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">mean</span>(<span class="fu">c</span>(fn[<span class="dv">2</span>], fn[<span class="dv">2</span>] <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> (fn[<span class="dv">4</span>] <span class="sc">-</span> fn[<span class="dv">2</span>])) ),</span>
<span id="cb55-534"><a href="#cb55-534" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"1.5 x IQR"</span></span>
<span id="cb55-535"><a href="#cb55-535" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-536"><a href="#cb55-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-537"><a href="#cb55-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-540"><a href="#cb55-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-541"><a href="#cb55-541" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb55-542"><a href="#cb55-542" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb55-543"><a href="#cb55-543" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Components of a boxplot'</span></span>
<span id="cb55-544"><a href="#cb55-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-545"><a href="#cb55-545" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">'images/boxplt.png'</span>)</span>
<span id="cb55-546"><a href="#cb55-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-547"><a href="#cb55-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-548"><a href="#cb55-548" aria-hidden="true" tabindex="-1"></a>The box shows the positions of the first and third quartiles, or "hinges", and the thick middle line shows the median. As 50% of the observations fall between the first and third quartiles, the position of the box is important and is the first thing that catches our eyes. If the median is in the centre of the box, this suggests that the distribution may be symmetric; if the median is near one end, the distribution is skewed. In particular, if the median is in the *right* side of the box, it implies that the middle 50% of the data are skewed to the *left*. For right skewed data, the median will be placed at the left end of the box (as against in the centre of the box).</span>
<span id="cb55-549"><a href="#cb55-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-550"><a href="#cb55-550" aria-hidden="true" tabindex="-1"></a>After having considered the 'centre' of a distribution, which we have measured by the median, and looked at where the bulk of the data lies, measured by the quartiles; then we are particularly interested in the strange, unusual values. They could be obvious mistakes (incorrectly coded, or decimal places in the wrong place, transposition of digits such as 91 instead of 19) or incorrect measurements or recording. These last two possibilities often occur before the data gets to the statistician so that it may be difficult to check whether these mistakes have occurred. Apart from obvious errors, we can only point to 'far out' values as being strange and we term them **'outliers'**. To help decide this matter, we define a few more terms, of which the most common one is the **interquartile range** or **IQR**, which is the distance between the first and third quartiles ( $Q3-Q1$ ). Any observation which is more than $1.5 \times IQR$ (sometimes called the "step") less than the first or more than the third quartile can be considered a *possible* outlier (@fig-boxplt. </span>
<span id="cb55-551"><a href="#cb55-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-552"><a href="#cb55-552" aria-hidden="true" tabindex="-1"></a>Boxplots are ideal for comparing a few groups of data because they give a visual summary of certain main features of the distributions but they are not as cluttered as other displays. Common sense must prevail, for there is a limit to the amount of information that the eye can take in. Up to 10 or 12 boxplots can be plotted, preferably on the same scale; more than 12 could be confusing.</span>
<span id="cb55-553"><a href="#cb55-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-554"><a href="#cb55-554" aria-hidden="true" tabindex="-1"></a>Shown in @fig-boxplt1 are the boxplots of <span class="in">`Length`</span> for the Inside-Outside groupings. Note that the boxplots have been constructed on the same scale; that is, they have common (<span class="in">`Length`</span>) axis.</span>
<span id="cb55-555"><a href="#cb55-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-558"><a href="#cb55-558" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-559"><a href="#cb55-559" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-560"><a href="#cb55-560" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplt1</span></span>
<span id="cb55-561"><a href="#cb55-561" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Boxplots'</span></span>
<span id="cb55-562"><a href="#cb55-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-563"><a href="#cb55-563" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb55-564"><a href="#cb55-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span> Length, </span>
<span id="cb55-565"><a href="#cb55-565" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> Inside, </span>
<span id="cb55-566"><a href="#cb55-566" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> Inside) <span class="sc">+</span> </span>
<span id="cb55-567"><a href="#cb55-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb55-568"><a href="#cb55-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb55-569"><a href="#cb55-569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-570"><a href="#cb55-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-571"><a href="#cb55-571" aria-hidden="true" tabindex="-1"></a>The boxplots in @fig-boxplt1 show that the general shapes of the distributions of <span class="in">`Length`</span> are broadly similar. In each case, the median is near the centre of the box. The box of the <span class="in">`Outside`</span> group is entirely to the right of the box of the <span class="in">`Inside`</span> group, indicating that the distribution of <span class="in">`Length`</span> is higher for the <span class="in">`Outside`</span> group. We can also see that the <span class="in">`Inside`</span> group may have greater spread than the <span class="in">`Outside`</span> group.</span>
<span id="cb55-572"><a href="#cb55-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-573"><a href="#cb55-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-574"><a href="#cb55-574" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cumulative Frequencies and Quantiles</span></span>
<span id="cb55-575"><a href="#cb55-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-576"><a href="#cb55-576" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cumulative frequencies</span></span>
<span id="cb55-577"><a href="#cb55-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-578"><a href="#cb55-578" aria-hidden="true" tabindex="-1"></a>When the data consists of individual points rather than grouped data, we first order the data from smallest to largest and we can plot the row numbers against these.</span>
<span id="cb55-579"><a href="#cb55-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-580"><a href="#cb55-580" aria-hidden="true" tabindex="-1"></a>For the Length data from the *Snodgrass* dataset, we have shown the ordered values earlier. If we assume that these are evenly spread throughout the distribution, these 91 values divide the distribution into 91 even parts each containing a relative frequency of 1/91 = `r 1/91`. In the absence of information about Length of other house pits, the above assumption seems reasonable. It would have even stronger justification if this sample of 91 were chosen at random from the population of the of all house pits, but this stretches the imagination somewhat as these 91 observations are just a chance archaeological find of what was preserved. Nevertheless, we have no real reason to consider that they are not representative of the whole population *Snodgrass* house pits.</span>
<span id="cb55-581"><a href="#cb55-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-582"><a href="#cb55-582" aria-hidden="true" tabindex="-1"></a>To find the cumulative relative frequency, we divide the column of row numbers by 91. There is a slight problem in that we do not know the smallest, and the largest Length. Hence we make an arbitrary decision that the smallest is likely to be <span class="in">`r min(Snodgrass$Length)`</span> feet with cumulative relative frequency of zero and the largest <span class="in">`r max(Snodgrass$Length)`</span> feet with a cumulative frequency of 1.</span>
<span id="cb55-583"><a href="#cb55-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-584"><a href="#cb55-584" aria-hidden="true" tabindex="-1"></a>With the Length data, there is a slight hitch in that there is duplication of the values. This is not really a problem, so long as we ignore the cumulative frequency in the table which corresponds to each first repeated value. The frequency jumps by one at the value of each observation except when there is a repetition in which case it jumps by the number of repetitions. Having obtained the cumulative relative frequencies, we can plot these against the ordered Length values. </span>
<span id="cb55-585"><a href="#cb55-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-588"><a href="#cb55-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-589"><a href="#cb55-589" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-590"><a href="#cb55-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-cumfrq</span></span>
<span id="cb55-591"><a href="#cb55-591" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Cumulative Relative Frequency Curve'</span></span>
<span id="cb55-592"><a href="#cb55-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-593"><a href="#cb55-593" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb55-594"><a href="#cb55-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(Length) <span class="sc">+</span> </span>
<span id="cb55-595"><a href="#cb55-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()</span>
<span id="cb55-596"><a href="#cb55-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-597"><a href="#cb55-597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-598"><a href="#cb55-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-599"><a href="#cb55-599" aria-hidden="true" tabindex="-1"></a>@fig-cumfrq shows the Cumulative Relative Frequency Curve. The procedure we described is a very basic one, and <span class="in">`R`</span> software will get a better one where we make more assumptions on how to relate the observed data to the cumulative relative frequencies.</span>
<span id="cb55-600"><a href="#cb55-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-601"><a href="#cb55-601" aria-hidden="true" tabindex="-1"></a><span class="fu">## Quantiles</span></span>
<span id="cb55-602"><a href="#cb55-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-603"><a href="#cb55-603" aria-hidden="true" tabindex="-1"></a>An important use of cumulative relative frequency graph is to find the **quantiles** of the distribution which is a general term for percentiles, deciles etc. For example, the $50^{\text th}$ percentile or the 5$^{\text th}$ decile (tenth) is the median which has 50% of the distribution up to, and including it. Any desired percentile can be found from the graph by drawing a horizontal line at the desired cumulative relative frequency and noting the value at which it cuts the curve.  @fig-cumfrq1 illustrates how the 30$^{\text th}$ percentile can be interpolated for the Length variable. It is desirable to use software to draw the cumulative relative frequency curves or estimate the quantiles.</span>
<span id="cb55-604"><a href="#cb55-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-605"><a href="#cb55-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-608"><a href="#cb55-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-609"><a href="#cb55-609" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-610"><a href="#cb55-610" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-cumfrq1</span></span>
<span id="cb55-611"><a href="#cb55-611" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'ECDF Curve for Length data'</span></span>
<span id="cb55-612"><a href="#cb55-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-613"><a href="#cb55-613" aria-hidden="true" tabindex="-1"></a>q30 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Snodgrass<span class="sc">$</span>Length, <span class="fl">0.3</span>)</span>
<span id="cb55-614"><a href="#cb55-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-615"><a href="#cb55-615" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb55-616"><a href="#cb55-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(Length) <span class="sc">+</span> </span>
<span id="cb55-617"><a href="#cb55-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>() <span class="sc">+</span> </span>
<span id="cb55-618"><a href="#cb55-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb55-619"><a href="#cb55-619" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> q30, </span>
<span id="cb55-620"><a href="#cb55-620" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="dv">0</span>, </span>
<span id="cb55-621"><a href="#cb55-621" aria-hidden="true" tabindex="-1"></a>        <span class="at">xend =</span> q30, </span>
<span id="cb55-622"><a href="#cb55-622" aria-hidden="true" tabindex="-1"></a>        <span class="at">yend =</span> .<span class="dv">3</span>),  </span>
<span id="cb55-623"><a href="#cb55-623" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour=</span><span class="dv">2</span>, </span>
<span id="cb55-624"><a href="#cb55-624" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length=</span><span class="fu">unit</span>(<span class="fl">0.30</span>,<span class="st">"cm"</span>), </span>
<span id="cb55-625"><a href="#cb55-625" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ends=</span><span class="st">"first"</span>)</span>
<span id="cb55-626"><a href="#cb55-626" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb55-627"><a href="#cb55-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb55-628"><a href="#cb55-628" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, </span>
<span id="cb55-629"><a href="#cb55-629" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> .<span class="dv">3</span>, </span>
<span id="cb55-630"><a href="#cb55-630" aria-hidden="true" tabindex="-1"></a>        <span class="at">xend =</span> q30, </span>
<span id="cb55-631"><a href="#cb55-631" aria-hidden="true" tabindex="-1"></a>        <span class="at">yend =</span> .<span class="dv">3</span>), </span>
<span id="cb55-632"><a href="#cb55-632" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour=</span><span class="dv">2</span>, </span>
<span id="cb55-633"><a href="#cb55-633" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length=</span><span class="fu">unit</span>(<span class="fl">0.30</span>,<span class="st">"cm"</span>))</span>
<span id="cb55-634"><a href="#cb55-634" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb55-635"><a href="#cb55-635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb55-636"><a href="#cb55-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb55-637"><a href="#cb55-637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"ECDF(Length)"</span>)</span>
<span id="cb55-638"><a href="#cb55-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-639"><a href="#cb55-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-640"><a href="#cb55-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-641"><a href="#cb55-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-642"><a href="#cb55-642" aria-hidden="true" tabindex="-1"></a>The 25$^{\text th}$ percentile is known as the **lower quartile** and the 75$^{\text th}$ percentile is known as the **upper quartile**. The inter-quartile range (IQR) is defined as the difference between the upper and lower quartiles. The lower and upper quartiles will slightly differ from the lower and upper hinges for small data sets due to the differences in estimating the cumulative relative frequency function known as the empirical cumulative distribution function (**ECDF**).</span>
<span id="cb55-643"><a href="#cb55-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-644"><a href="#cb55-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-645"><a href="#cb55-645" aria-hidden="true" tabindex="-1"></a>The <span class="in">`R`</span> function <span class="in">`quantile()`</span> will get the quantiles easily. The following output shows the percentiles for Length data.</span>
<span id="cb55-646"><a href="#cb55-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-649"><a href="#cb55-649" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-650"><a href="#cb55-650" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(Snodgrass<span class="sc">$</span>Length, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))</span>
<span id="cb55-651"><a href="#cb55-651" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-652"><a href="#cb55-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-653"><a href="#cb55-653" aria-hidden="true" tabindex="-1"></a><span class="fu">## Quantile-Quantile Plots</span></span>
<span id="cb55-654"><a href="#cb55-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-655"><a href="#cb55-655" aria-hidden="true" tabindex="-1"></a>At times, two groups may have different numbers of observations but they may be similar in some ways and it may be appropriate to compare them. This comparison can be done in several ways but Q-Q plot is once such graph useful for such a comparison. The quantiles of the first batch is plotted against the quantiles of the second batch. A 45 degree $(Y=X)$ line is also drawn. If the points on a quantile-quantile plot fall along, or close to, the 45 degree line, then the two variables follow the same distribution; if they fall on a line parallel to the 45 degree line, the two variables follow similar distributions but one has a larger location parameter (say mean, or median) than the other; if the slope differs from the 45 degree line the variables have a similar distribution but may have a different standard deviation; if the plot is linear then the distributions of $Y$ and $X$ are different.</span>
<span id="cb55-656"><a href="#cb55-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-657"><a href="#cb55-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-660"><a href="#cb55-660" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-661"><a href="#cb55-661" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-662"><a href="#cb55-662" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-qq1</span></span>
<span id="cb55-663"><a href="#cb55-663" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Quantile-Quantile plot patterns'</span></span>
<span id="cb55-664"><a href="#cb55-664" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb55-665"><a href="#cb55-665" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb55-666"><a href="#cb55-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-667"><a href="#cb55-667" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12344</span>)</span>
<span id="cb55-668"><a href="#cb55-668" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb55-669"><a href="#cb55-669" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb55-670"><a href="#cb55-670" aria-hidden="true" tabindex="-1"></a>nq <span class="ot">&lt;-</span> <span class="dv">201</span></span>
<span id="cb55-671"><a href="#cb55-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-672"><a href="#cb55-672" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span> , nq, <span class="at">length.out =</span> <span class="dv">50</span>) <span class="sc">/</span> nq <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">/</span> nq</span>
<span id="cb55-673"><a href="#cb55-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-674"><a href="#cb55-674" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-675"><a href="#cb55-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">quantile</span>(X, p), <span class="at">y =</span> <span class="fu">quantile</span>(Y, p)) <span class="sc">+</span> </span>
<span id="cb55-676"><a href="#cb55-676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb55-677"><a href="#cb55-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb55-678"><a href="#cb55-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"X &amp; Y roughly follow</span><span class="sc">\n</span><span class="st">the same distributions"</span>) <span class="sc">+</span> </span>
<span id="cb55-679"><a href="#cb55-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X quantiles"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y quantiles"</span>)</span>
<span id="cb55-680"><a href="#cb55-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-681"><a href="#cb55-681" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb55-682"><a href="#cb55-682" aria-hidden="true" tabindex="-1"></a>Y2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb55-683"><a href="#cb55-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-684"><a href="#cb55-684" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-685"><a href="#cb55-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">quantile</span>(X2, p), </span>
<span id="cb55-686"><a href="#cb55-686" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">quantile</span>(Y2, p)</span>
<span id="cb55-687"><a href="#cb55-687" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span> </span>
<span id="cb55-688"><a href="#cb55-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb55-689"><a href="#cb55-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb55-690"><a href="#cb55-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"The distribution of Y has</span><span class="sc">\n</span><span class="st">a larger location (mean/median)"</span>) <span class="sc">+</span> </span>
<span id="cb55-691"><a href="#cb55-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X quantiles"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y quantiles"</span>)</span>
<span id="cb55-692"><a href="#cb55-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-693"><a href="#cb55-693" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb55-694"><a href="#cb55-694" aria-hidden="true" tabindex="-1"></a>Y3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb55-695"><a href="#cb55-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-696"><a href="#cb55-696" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-697"><a href="#cb55-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">quantile</span>(X3, p), </span>
<span id="cb55-698"><a href="#cb55-698" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">quantile</span>(Y3, p)</span>
<span id="cb55-699"><a href="#cb55-699" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span> </span>
<span id="cb55-700"><a href="#cb55-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb55-701"><a href="#cb55-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb55-702"><a href="#cb55-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"The distribution of Y has</span><span class="sc">\n</span><span class="st">a larger scale (SD, F-spread etc)"</span>) <span class="sc">+</span> </span>
<span id="cb55-703"><a href="#cb55-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X quantiles"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y quantiles"</span>)</span>
<span id="cb55-704"><a href="#cb55-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-705"><a href="#cb55-705" aria-hidden="true" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb55-706"><a href="#cb55-706" aria-hidden="true" tabindex="-1"></a>Y4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb55-707"><a href="#cb55-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-708"><a href="#cb55-708" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-709"><a href="#cb55-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">quantile</span>(X4, p), <span class="at">y =</span> <span class="fu">quantile</span>(Y4, p)) <span class="sc">+</span> </span>
<span id="cb55-710"><a href="#cb55-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb55-711"><a href="#cb55-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb55-712"><a href="#cb55-712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"The distributions of  X and Y </span><span class="sc">\n</span><span class="st">are different"</span>) <span class="sc">+</span> </span>
<span id="cb55-713"><a href="#cb55-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X quantiles"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y quantiles"</span>)</span>
<span id="cb55-714"><a href="#cb55-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-715"><a href="#cb55-715" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb55-716"><a href="#cb55-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-717"><a href="#cb55-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-718"><a href="#cb55-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-719"><a href="#cb55-719" aria-hidden="true" tabindex="-1"></a>In @fig-qq1, different kinds of quantile-quantile plots are shown; note the following three cases in particular.</span>
<span id="cb55-720"><a href="#cb55-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-721"><a href="#cb55-721" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>$Y$ and $X$ follow similar distributions but the quantiles of $Y$ are a constant amount greater than the quantiles of $X$.</span>
<span id="cb55-722"><a href="#cb55-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-723"><a href="#cb55-723" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>$Y$ and $X$ follow similar distributions but the standard deviation of $Y$ is greater than that of $X$.</span>
<span id="cb55-724"><a href="#cb55-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-725"><a href="#cb55-725" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>$Y$ and $X$ follow different distributions.</span>
<span id="cb55-726"><a href="#cb55-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-727"><a href="#cb55-727" aria-hidden="true" tabindex="-1"></a>@fig-lenqq gives Q-Q plot comparing the Length of house pits for Inside and Outside groups. This Q-Q plot suggests that the two distributions are similar but the average Length is greater for the Inside dwellings.</span>
<span id="cb55-728"><a href="#cb55-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-731"><a href="#cb55-731" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-732"><a href="#cb55-732" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-733"><a href="#cb55-733" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-lenqq</span></span>
<span id="cb55-734"><a href="#cb55-734" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Quantile-Quantile plot of Length for Inside-Outside groups'</span></span>
<span id="cb55-735"><a href="#cb55-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-736"><a href="#cb55-736" aria-hidden="true" tabindex="-1"></a>nq <span class="ot">&lt;-</span> <span class="fu">length</span>(Snodgrass<span class="sc">$</span>Length)</span>
<span id="cb55-737"><a href="#cb55-737" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span> , nq, <span class="at">length.out =</span> <span class="dv">20</span>) <span class="sc">/</span> nq <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">/</span> nq</span>
<span id="cb55-738"><a href="#cb55-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-739"><a href="#cb55-739" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb55-740"><a href="#cb55-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Inside <span class="sc">==</span> <span class="st">"Inside"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb55-741"><a href="#cb55-741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Length)</span>
<span id="cb55-742"><a href="#cb55-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-743"><a href="#cb55-743" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> Snodgrass <span class="sc">|&gt;</span> </span>
<span id="cb55-744"><a href="#cb55-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Inside <span class="sc">==</span> <span class="st">"Outside"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb55-745"><a href="#cb55-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Length)</span>
<span id="cb55-746"><a href="#cb55-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-747"><a href="#cb55-747" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-748"><a href="#cb55-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">quantile</span>(X, p), </span>
<span id="cb55-749"><a href="#cb55-749" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">quantile</span>(Y, p)</span>
<span id="cb55-750"><a href="#cb55-750" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span> </span>
<span id="cb55-751"><a href="#cb55-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb55-752"><a href="#cb55-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb55-753"><a href="#cb55-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Length quantiles for Inside Group"</span>) <span class="sc">+</span> </span>
<span id="cb55-754"><a href="#cb55-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Length quantiles for Outside Group"</span>)</span>
<span id="cb55-755"><a href="#cb55-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-756"><a href="#cb55-756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-757"><a href="#cb55-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-758"><a href="#cb55-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-759"><a href="#cb55-759" aria-hidden="true" tabindex="-1"></a>Note that the distribution of two variables $X$ and $Y$ can be compared in a number of ways using boxplots, overlaid ECDF plots etc.</span>
<span id="cb55-760"><a href="#cb55-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-761"><a href="#cb55-761" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exploring Relationships</span></span>
<span id="cb55-762"><a href="#cb55-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-763"><a href="#cb55-763" aria-hidden="true" tabindex="-1"></a><span class="fu">## Scatterplots</span></span>
<span id="cb55-764"><a href="#cb55-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-765"><a href="#cb55-765" aria-hidden="true" tabindex="-1"></a>Consider data which can be written as pairs ($X$, $Y$). The two groups of data ($X$ and $Y$) need not be in the same units but they are assumed to be related in some way. Scatterplots are useful in exploring the type of relationship between $X$ and $Y$.</span>
<span id="cb55-766"><a href="#cb55-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-769"><a href="#cb55-769" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-770"><a href="#cb55-770" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>( <span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"testmarks.RData"</span>) ) {</span>
<span id="cb55-771"><a href="#cb55-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-772"><a href="#cb55-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(</span>
<span id="cb55-773"><a href="#cb55-773" aria-hidden="true" tabindex="-1"></a>    <span class="at">url =</span> <span class="st">"http://www.massey.ac.nz/~anhsmith/data/testmarks.RData"</span>, </span>
<span id="cb55-774"><a href="#cb55-774" aria-hidden="true" tabindex="-1"></a>    <span class="at">destfile =</span> <span class="st">"testmarks.RData"</span>)</span>
<span id="cb55-775"><a href="#cb55-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-776"><a href="#cb55-776" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-777"><a href="#cb55-777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-778"><a href="#cb55-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-781"><a href="#cb55-781" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-782"><a href="#cb55-782" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"testmarks.RData"</span>)</span>
<span id="cb55-783"><a href="#cb55-783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-784"><a href="#cb55-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-785"><a href="#cb55-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-788"><a href="#cb55-788" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-789"><a href="#cb55-789" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-790"><a href="#cb55-790" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-sca1</span></span>
<span id="cb55-791"><a href="#cb55-791" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Scatter plot of English vs Maths scores'</span></span>
<span id="cb55-792"><a href="#cb55-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-793"><a href="#cb55-793" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(testmarks) <span class="sc">+</span></span>
<span id="cb55-794"><a href="#cb55-794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>English, <span class="at">x=</span>Maths) <span class="sc">+</span> </span>
<span id="cb55-795"><a href="#cb55-795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb55-796"><a href="#cb55-796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span>
<span id="cb55-797"><a href="#cb55-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-798"><a href="#cb55-798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-799"><a href="#cb55-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-800"><a href="#cb55-800" aria-hidden="true" tabindex="-1"></a>The data in **testmarks.txt** consists of the records of 40 students, at a school, on standard tests of comprehension of English and Mathematics. The test marks data can be graphed plotting English test scores against Mathematics test scores. The resulting graph, known as the scatterplot, is shown as @fig-sca1. This plot enables us to see if there is a relationship between $X$ and $Y$.</span>
<span id="cb55-801"><a href="#cb55-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-802"><a href="#cb55-802" aria-hidden="true" tabindex="-1"></a>Here, the scatterplot shows a clear upward trend -- as the Mathematics mark increases so does the English mark, in general.</span>
<span id="cb55-803"><a href="#cb55-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-804"><a href="#cb55-804" aria-hidden="true" tabindex="-1"></a>There are a number of useful features that can be added to a scatterplot. The individual distributions of $X$ and $Y$ can be shown by adding appropriate graphical displays (e.g. boxplots) along the axes. If a number of the students have the same marks then it may be advisable to add a jitter as we discussed earlier.</span>
<span id="cb55-805"><a href="#cb55-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-808"><a href="#cb55-808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-809"><a href="#cb55-809" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-810"><a href="#cb55-810" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-marginbp</span></span>
<span id="cb55-811"><a href="#cb55-811" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'English vs Maths scores'</span></span>
<span id="cb55-812"><a href="#cb55-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-813"><a href="#cb55-813" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb55-814"><a href="#cb55-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-815"><a href="#cb55-815" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(testmarks) <span class="sc">+</span> </span>
<span id="cb55-816"><a href="#cb55-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>English, <span class="at">x=</span>Maths) <span class="sc">+</span></span>
<span id="cb55-817"><a href="#cb55-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb55-818"><a href="#cb55-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span>
<span id="cb55-819"><a href="#cb55-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-820"><a href="#cb55-820" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(p1, <span class="at">type=</span><span class="st">"boxplot"</span>)</span>
<span id="cb55-821"><a href="#cb55-821" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-822"><a href="#cb55-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-823"><a href="#cb55-823" aria-hidden="true" tabindex="-1"></a>In @fig-marginbp, it can be seen (with some effort) that each set of scores seems to be *uniformly* distributed along its axis, although the Maths marks exhibit gaps which may indicate different groups within the class.</span>
<span id="cb55-824"><a href="#cb55-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-825"><a href="#cb55-825" aria-hidden="true" tabindex="-1"></a>Finally, does the variability in English marks change as the Maths mark changes, or is it fairly constant, i.e. does the vertical height of the scatter change from left to right? In this case the variability appears to be fairly constant (we will see why this is important later).</span>
<span id="cb55-826"><a href="#cb55-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-827"><a href="#cb55-827" aria-hidden="true" tabindex="-1"></a>The **Rangitikei** data gives the number of people making recreational use of the Rangitikei River and the number of vehicles seen at a particular location and time. The data were collected at two locations (location being a categorical variable).</span>
<span id="cb55-828"><a href="#cb55-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-831"><a href="#cb55-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-832"><a href="#cb55-832" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>( <span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"rangitikei.RData"</span>) ) {</span>
<span id="cb55-833"><a href="#cb55-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-834"><a href="#cb55-834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(</span>
<span id="cb55-835"><a href="#cb55-835" aria-hidden="true" tabindex="-1"></a>    <span class="at">url =</span> <span class="st">"http://www.massey.ac.nz/~anhsmith/data/rangitikei.RData"</span>,</span>
<span id="cb55-836"><a href="#cb55-836" aria-hidden="true" tabindex="-1"></a>    <span class="at">destfile =</span> <span class="st">"rangitikei.RData"</span>)</span>
<span id="cb55-837"><a href="#cb55-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-838"><a href="#cb55-838" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-839"><a href="#cb55-839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-840"><a href="#cb55-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-843"><a href="#cb55-843" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-844"><a href="#cb55-844" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"rangitikei.RData"</span>)</span>
<span id="cb55-845"><a href="#cb55-845" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-846"><a href="#cb55-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-847"><a href="#cb55-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-848"><a href="#cb55-848" aria-hidden="true" tabindex="-1"></a>If the data are grouped, this information can be added to a scatterplot by using different symbols and/or colours for each group. For example, we can show a scatterplot of people vs vehicles with different points for locations (@fig-sca2). </span>
<span id="cb55-849"><a href="#cb55-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-850"><a href="#cb55-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-853"><a href="#cb55-853" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-854"><a href="#cb55-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-855"><a href="#cb55-855" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-sca2</span></span>
<span id="cb55-856"><a href="#cb55-856" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Scatterplot with a grouping variable'</span></span>
<span id="cb55-857"><a href="#cb55-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-858"><a href="#cb55-858" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rangitikei) <span class="sc">+</span></span>
<span id="cb55-859"><a href="#cb55-859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span> people, <span class="at">x =</span> vehicle, <span class="at">col =</span> loc, <span class="at">shape =</span> loc) <span class="sc">+</span> </span>
<span id="cb55-860"><a href="#cb55-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb55-861"><a href="#cb55-861" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-862"><a href="#cb55-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-863"><a href="#cb55-863" aria-hidden="true" tabindex="-1"></a>There appears to be little difference in the number of people and vehicles seen among the locations.</span>
<span id="cb55-864"><a href="#cb55-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-865"><a href="#cb55-865" aria-hidden="true" tabindex="-1"></a>@fig-marginbp1 shows the number of people against the number of vehicles seen as well as the distribution of each variable along the axes using boxplots (these are often referred to as *marginal distributions*). The first plot in @fig-marginbp1 (A) shows the scatter of all points, whereas the second one (B) shows the scatter with the very large value (Observation <span class="sc">\#</span>26) removed. In the first plot, the outlier shows up quite clearly in both boxplots. In the second plot, the boxplot associated with the variable 'people' still shows one point as an outlier, though this doesn't appear to be as extreme as the outlier in the first plot. </span>
<span id="cb55-866"><a href="#cb55-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-869"><a href="#cb55-869" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-870"><a href="#cb55-870" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-871"><a href="#cb55-871" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-marginbp1</span></span>
<span id="cb55-872"><a href="#cb55-872" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'People vs vehicle plots'</span></span>
<span id="cb55-873"><a href="#cb55-873" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb55-874"><a href="#cb55-874" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb55-875"><a href="#cb55-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-876"><a href="#cb55-876" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb55-877"><a href="#cb55-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-878"><a href="#cb55-878" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> rangitikei <span class="sc">|&gt;</span> </span>
<span id="cb55-879"><a href="#cb55-879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-880"><a href="#cb55-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>people, <span class="at">x=</span>vehicle) <span class="sc">+</span> </span>
<span id="cb55-881"><a href="#cb55-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-882"><a href="#cb55-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(A): All of the data"</span>)</span>
<span id="cb55-883"><a href="#cb55-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-884"><a href="#cb55-884" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> rangitikei <span class="sc">|&gt;</span> </span>
<span id="cb55-885"><a href="#cb55-885" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove the rows with highest value of 'people'</span></span>
<span id="cb55-886"><a href="#cb55-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(people <span class="sc">&lt;</span> <span class="fu">max</span>(people)) <span class="sc">|&gt;</span> </span>
<span id="cb55-887"><a href="#cb55-887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-888"><a href="#cb55-888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>people, <span class="at">x=</span>vehicle) <span class="sc">+</span> </span>
<span id="cb55-889"><a href="#cb55-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb55-890"><a href="#cb55-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(B): Without observation #26"</span>)</span>
<span id="cb55-891"><a href="#cb55-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-892"><a href="#cb55-892" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(</span>
<span id="cb55-893"><a href="#cb55-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggMarginal</span>(p1, <span class="at">type=</span><span class="st">"boxplot"</span>), </span>
<span id="cb55-894"><a href="#cb55-894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggMarginal</span>(p2, <span class="at">type=</span><span class="st">"boxplot"</span>), </span>
<span id="cb55-895"><a href="#cb55-895" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb55-896"><a href="#cb55-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-897"><a href="#cb55-897" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-898"><a href="#cb55-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-899"><a href="#cb55-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-900"><a href="#cb55-900" aria-hidden="true" tabindex="-1"></a>Note that the outlier point in @fig-marginbp1 (A) showed clearly in the marginal distributions of both variables. However, it was consistent with the *relationship* between vehicle and people. While this might not surprise us (the relationship between people and vehicles might be expected to stay the same even for a location with large numbers of each), it follows that an outlier with respect to the underlying relationship between two variables will be different from an outlier in the marginal distribution sense. And such a value may not be an outlier in either marginal distribution. </span>
<span id="cb55-901"><a href="#cb55-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-902"><a href="#cb55-902" aria-hidden="true" tabindex="-1"></a>Look again at @fig-marginbp - there is one student with a high Maths mark but a low English mark. While neither mark is unusual in itself, the point stands out from the rest of the scatterplot because it is unusually high or low (i.e. up or down) on the plot. In general an outlier with respect to the relationship between $X$ and $Y$ is one whose $Y$ value is unusually large or small compared to other cases with similar $X$ values.</span>
<span id="cb55-903"><a href="#cb55-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-904"><a href="#cb55-904" aria-hidden="true" tabindex="-1"></a>Now let's load the <span class="in">`horsehearts`</span> dataset, which contains the weights of horses' hearts along with some other heart measurements. </span>
<span id="cb55-905"><a href="#cb55-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-908"><a href="#cb55-908" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-909"><a href="#cb55-909" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>( <span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"horsehearts.RData"</span>) ) {</span>
<span id="cb55-910"><a href="#cb55-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-911"><a href="#cb55-911" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(</span>
<span id="cb55-912"><a href="#cb55-912" aria-hidden="true" tabindex="-1"></a>    <span class="at">url =</span> <span class="st">"http://www.massey.ac.nz/~anhsmith/data/horsehearts.RData"</span>,</span>
<span id="cb55-913"><a href="#cb55-913" aria-hidden="true" tabindex="-1"></a>    <span class="at">destfile =</span> <span class="st">"horsehearts.RData"</span>)</span>
<span id="cb55-914"><a href="#cb55-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-915"><a href="#cb55-915" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-916"><a href="#cb55-916" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-917"><a href="#cb55-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-918"><a href="#cb55-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-921"><a href="#cb55-921" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-922"><a href="#cb55-922" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"horsehearts.RData"</span>)</span>
<span id="cb55-923"><a href="#cb55-923" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-924"><a href="#cb55-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-925"><a href="#cb55-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-928"><a href="#cb55-928" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-929"><a href="#cb55-929" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-930"><a href="#cb55-930" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-marginbp2</span></span>
<span id="cb55-931"><a href="#cb55-931" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Weight vs Exterior Widths'</span></span>
<span id="cb55-932"><a href="#cb55-932" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb55-933"><a href="#cb55-933" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb55-934"><a href="#cb55-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-935"><a href="#cb55-935" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb55-936"><a href="#cb55-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-937"><a href="#cb55-937" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(horsehearts) <span class="sc">+</span> </span>
<span id="cb55-938"><a href="#cb55-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>WEIGHT, <span class="at">x=</span>EXTDIA) <span class="sc">+</span> </span>
<span id="cb55-939"><a href="#cb55-939" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb55-940"><a href="#cb55-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-941"><a href="#cb55-941" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb55-942"><a href="#cb55-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-943"><a href="#cb55-943" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(</span>
<span id="cb55-944"><a href="#cb55-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggMarginal</span>(p1, <span class="at">type=</span><span class="st">"density"</span>), </span>
<span id="cb55-945"><a href="#cb55-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggMarginal</span>(p2, <span class="at">type=</span><span class="st">"density"</span>), </span>
<span id="cb55-946"><a href="#cb55-946" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb55-947"><a href="#cb55-947" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-948"><a href="#cb55-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-949"><a href="#cb55-949" aria-hidden="true" tabindex="-1"></a>@fig-marginbp2 shows scatterplots of weights of horses' hearts against their exterior widths in the systolic phase (that is the contracted phase). The scatterplot indicates that a straight line would not fit the data well. On the other hand, there is some evidence the weights fall into one of two subgroups (with a value around 2.5kg being the cut off point). Scatterplots are particularly useful in pinpointing possible groupings of points so that the structure of the data is revealed which might otherwise go undetected in descriptive statistics calculated for the full data set.</span>
<span id="cb55-950"><a href="#cb55-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-951"><a href="#cb55-951" aria-hidden="true" tabindex="-1"></a>One way of quickly assessing whether a straight line fit is reasonable is to smooth the points in the plot using a LOWESS (LOcally WEighted Scatterplot Smoother) smoothed line. The lowess (also called loess) procedure is based on local sets of points (instead of the whole data set) at a given $x$ range, and fits a smoothed line to the data. The second scatterplot in @fig-marginbp2 shows the lowess smoother which confirms that there is curvature in the underlying relationship- possibly a cubic curve would fit this.</span>
<span id="cb55-952"><a href="#cb55-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-953"><a href="#cb55-953" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlation coefficients</span></span>
<span id="cb55-954"><a href="#cb55-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-955"><a href="#cb55-955" aria-hidden="true" tabindex="-1"></a>As we have seen before, scatterplots provide a good starting point for exploring the relationship between two variables. In @fig-scaqud, the weight, $Y$, is plotted against the exterior width $X$ (diastolic phase in column 7 of **horsehearts.txt**). It is helpful to divide the scatterplot into four quarters, called quadrants, by drawing a line horizontally at the average $Y$ value or weight (2.235 kg) and vertically at the average $X$ value (or diastolic exterior width 14.13 mm). The first quadrant is the top right hand side quarter. We move anti-clockwise for numbering the quadrants, and the bottom left hand side quadrant is called the third quadrant.</span>
<span id="cb55-956"><a href="#cb55-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-957"><a href="#cb55-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-960"><a href="#cb55-960" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-961"><a href="#cb55-961" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb55-962"><a href="#cb55-962" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scaqud</span></span>
<span id="cb55-963"><a href="#cb55-963" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Four quadrants of a scatter plot'</span></span>
<span id="cb55-964"><a href="#cb55-964" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb55-965"><a href="#cb55-965" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb55-966"><a href="#cb55-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-967"><a href="#cb55-967" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(horsehearts) <span class="sc">+</span> </span>
<span id="cb55-968"><a href="#cb55-968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y=</span>WEIGHT, <span class="at">x=</span>EXTDIA) <span class="sc">+</span></span>
<span id="cb55-969"><a href="#cb55-969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb55-970"><a href="#cb55-970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">mean</span>(horsehearts<span class="sc">$</span>EXTDIA), <span class="at">linetype=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb55-971"><a href="#cb55-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">mean</span>(horsehearts<span class="sc">$</span>WEIGHT), <span class="at">linetype=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb55-972"><a href="#cb55-972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span>
<span id="cb55-973"><a href="#cb55-973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-974"><a href="#cb55-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-975"><a href="#cb55-975" aria-hidden="true" tabindex="-1"></a>In @fig-scaqud, most of the points fall in the third and first quadrants which indicates that there is an increasing relationship between the two variables (as the length increases, the weight tends to increase which is not too surprising!).</span>
<span id="cb55-976"><a href="#cb55-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-977"><a href="#cb55-977" aria-hidden="true" tabindex="-1"></a>Although this scatterplot indicates a nonlinear relationship would fit better than a linear relationship, we will continue to use it for illustration. It is useful to have an objective measure of how strong a linear relationship is (as we have seen, stretching or compressing one or both axes can give different impressions). This measure is called the Pearsonian ***correlation coefficient*** between $X$ and $Y$ and is denoted by $r_{xy}$ or $r$ for short:</span>
<span id="cb55-978"><a href="#cb55-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-979"><a href="#cb55-979" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb55-980"><a href="#cb55-980" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb55-981"><a href="#cb55-981" aria-hidden="true" tabindex="-1"></a>r_{xy} &amp;= \frac{{\text {sum}(x - \bar x)(y - \bar y)}}{{\text{squareroot}<span class="co">[</span><span class="ot">\text {sum}(x - \bar x)^2  {\text{sum}}(y - \bar y)^2 </span><span class="co">]</span>}} <span class="sc">\\</span></span>
<span id="cb55-982"><a href="#cb55-982" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb55-983"><a href="#cb55-983" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{\sum (x-\bar{x})(y-\bar{y}) }{\sqrt{\sum (x-\bar{x})^{2}  \sum (y-\bar{y})^{2}  } } <span class="sc">\\</span></span>
<span id="cb55-984"><a href="#cb55-984" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb55-985"><a href="#cb55-985" aria-hidden="true" tabindex="-1"></a>&amp;=\frac{S_{xy} }{\sqrt{S_{xx} S_{yy} } }</span>
<span id="cb55-986"><a href="#cb55-986" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb55-987"><a href="#cb55-987" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb55-988"><a href="#cb55-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-989"><a href="#cb55-989" aria-hidden="true" tabindex="-1"></a>Here $S_{xx}=S_x^2$ is the variance of $X$, $S_{yy}=S_y^2$ is the variance of $Y$, and $S_{xy}$ is the covariance between $X$ and $Y$.</span>
<span id="cb55-990"><a href="#cb55-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-991"><a href="#cb55-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-992"><a href="#cb55-992" aria-hidden="true" tabindex="-1"></a>The Pearson correlation (coefficient) between WEIGHT and EXTDIA equals 0.759. Perfect correlation (+1) would occur if all points fell on a straight line in the first and third quadrants. Assuming a bivariate normal distribution, the null hypothesis that the true correlation coefficient $\rho _{xy} =0$ can be tested using the test statistic $$t = \frac{{r_{xy} }}{{\sqrt {\frac{{1 - r_{xy}^2 }}{{n - 2}}} }}$$ Statistical software programs directly give the $p$-value for this test. The estimated correlation coefficient of 0.759 for $(n-2)=44$ df is significant ($p$-value is close to zero). Testing of hypothesis related topics are covered in the next Chapter.</span>
<span id="cb55-993"><a href="#cb55-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-994"><a href="#cb55-994" aria-hidden="true" tabindex="-1"></a>The scatterplot indicates that there may be two groups of horses; whose hearts weigh about 2.3 kg or more and whose heart weights are less than 2.3 kg. If possible, one should try to establish whether there are two groups for some reason (perhaps age, sex or breed). If the points tended to concentrate in quadrants 2 and 4, this would indicate that the correlation between $Y$ and $X$ is negative (as $X$ increases, $Y$ tends to decrease). If the points were evenly scattered among the four quadrants, the correlation coefficient would be close to zero.</span>
<span id="cb55-995"><a href="#cb55-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-998"><a href="#cb55-998" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-999"><a href="#cb55-999" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1000"><a href="#cb55-1000" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb55-1001"><a href="#cb55-1001" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-corp</span></span>
<span id="cb55-1002"><a href="#cb55-1002" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Limitations of the correlation coefficient'</span></span>
<span id="cb55-1003"><a href="#cb55-1003" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb55-1004"><a href="#cb55-1004" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb55-1005"><a href="#cb55-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1006"><a href="#cb55-1006" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb55-1007"><a href="#cb55-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1008"><a href="#cb55-1008" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb55-1009"><a href="#cb55-1009" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.9</span>), <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="dv">1</span>))</span>
<span id="cb55-1010"><a href="#cb55-1010" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">300</span>, <span class="at">mu=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">Sigma=</span>Sigma)</span>
<span id="cb55-1011"><a href="#cb55-1011" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(dfm)</span>
<span id="cb55-1012"><a href="#cb55-1012" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dfm)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>)</span>
<span id="cb55-1013"><a href="#cb55-1013" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Positive correlation"</span>)<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb55-1014"><a href="#cb55-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1015"><a href="#cb55-1015" aria-hidden="true" tabindex="-1"></a>Sigma<span class="ot">=</span><span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.9</span>), <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.9</span>, <span class="dv">1</span>))</span>
<span id="cb55-1016"><a href="#cb55-1016" aria-hidden="true" tabindex="-1"></a>dfm<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(<span class="dv">300</span>, <span class="at">mu=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">Sigma=</span>Sigma)</span>
<span id="cb55-1017"><a href="#cb55-1017" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(dfm)</span>
<span id="cb55-1018"><a href="#cb55-1018" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dfm)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>)</span>
<span id="cb55-1019"><a href="#cb55-1019" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Negative correlation"</span>)<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb55-1020"><a href="#cb55-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1021"><a href="#cb55-1021" aria-hidden="true" tabindex="-1"></a>Sigma<span class="ot">=</span><span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb55-1022"><a href="#cb55-1022" aria-hidden="true" tabindex="-1"></a>dfm<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(<span class="dv">300</span>, <span class="at">mu=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">Sigma=</span>Sigma)</span>
<span id="cb55-1023"><a href="#cb55-1023" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(dfm)</span>
<span id="cb55-1024"><a href="#cb55-1024" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dfm)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>)</span>
<span id="cb55-1025"><a href="#cb55-1025" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Near zero correlation"</span>)<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb55-1026"><a href="#cb55-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1027"><a href="#cb55-1027" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="at">length.out=</span><span class="dv">300</span>)</span>
<span id="cb55-1028"><a href="#cb55-1028" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>X <span class="sc">+</span> <span class="dv">5</span><span class="sc">*</span>X<span class="sc">^</span><span class="fl">2.2</span><span class="sc">+</span><span class="fu">rlnorm</span>(<span class="dv">300</span>, <span class="fl">1.1</span>,<span class="fl">1.3</span>)</span>
<span id="cb55-1029"><a href="#cb55-1029" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(X, Y))</span>
<span id="cb55-1030"><a href="#cb55-1030" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dfm)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>)</span>
<span id="cb55-1031"><a href="#cb55-1031" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Correlation coefficient </span><span class="sc">\n</span><span class="st">does not capture </span><span class="sc">\n</span><span class="st">nonlinear relationships"</span>)<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb55-1032"><a href="#cb55-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1033"><a href="#cb55-1033" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">120</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb55-1034"><a href="#cb55-1034" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">120</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb55-1035"><a href="#cb55-1035" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">61</span><span class="sc">:</span><span class="dv">120</span>] <span class="ot">&lt;-</span> X[<span class="dv">61</span><span class="sc">:</span><span class="dv">120</span>]<span class="sc">+</span><span class="dv">150</span></span>
<span id="cb55-1036"><a href="#cb55-1036" aria-hidden="true" tabindex="-1"></a>Y[<span class="dv">61</span><span class="sc">:</span><span class="dv">120</span>] <span class="ot">&lt;-</span> Y[<span class="dv">61</span><span class="sc">:</span><span class="dv">120</span>]<span class="sc">+</span><span class="dv">30</span></span>
<span id="cb55-1037"><a href="#cb55-1037" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X<span class="sc">/</span><span class="dv">30</span></span>
<span id="cb55-1038"><a href="#cb55-1038" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> Y<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb55-1039"><a href="#cb55-1039" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X, <span class="at">Y =</span> Y)</span>
<span id="cb55-1040"><a href="#cb55-1040" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span> <span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb55-1041"><a href="#cb55-1041" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> p5 <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Correlation is </span><span class="sc">\n</span><span class="st">near zero within subgroups</span><span class="sc">\n</span><span class="st">Spurious correlation"</span>)</span>
<span id="cb55-1042"><a href="#cb55-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1043"><a href="#cb55-1043" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb55-1044"><a href="#cb55-1044" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">0.6</span>), <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="dv">3</span>))</span>
<span id="cb55-1045"><a href="#cb55-1045" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">300</span>, <span class="at">mu=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">Sigma=</span>Sigma)</span>
<span id="cb55-1046"><a href="#cb55-1046" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(dfm)</span>
<span id="cb55-1047"><a href="#cb55-1047" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dfm)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>)</span>
<span id="cb55-1048"><a href="#cb55-1048" aria-hidden="true" tabindex="-1"></a>dfm<span class="sc">$</span>Y[<span class="dv">151</span><span class="sc">:</span><span class="dv">300</span>] <span class="ot">&lt;-</span> dfm<span class="sc">$</span>Y[<span class="dv">151</span><span class="sc">:</span><span class="dv">300</span>]<span class="sc">+</span><span class="dv">30</span></span>
<span id="cb55-1049"><a href="#cb55-1049" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfm, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span> <span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb55-1050"><a href="#cb55-1050" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> p6 <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Correlation is </span><span class="sc">\n</span><span class="st">high within subgroups</span><span class="sc">\n</span><span class="st">Simpson paradox"</span>)</span>
<span id="cb55-1051"><a href="#cb55-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1052"><a href="#cb55-1052" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1,p2, p3, p4, p5, p6, <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb55-1053"><a href="#cb55-1053" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1054"><a href="#cb55-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1055"><a href="#cb55-1055" aria-hidden="true" tabindex="-1"></a>@fig-corp shows a number of possible plots of $Y$ against $X$ and their associated correlation coefficients. Notice that the correlation coefficient may be close to zero even though there is a strong pattern present. This is because the correlation coefficient only measures the strength of the *linear* relationship between two variables. In the presence of subgroups the correlation coefficient can become spurious or even be close to zero when there is indeed the correlation is high within the subgroup. Simpson (1951) demonstrated that relationships noted within a population may not hold and could be the opposite within all subgroups. This amalgamation paradox can happen to most summary statistical measures including the correlation coefficient.</span>
<span id="cb55-1056"><a href="#cb55-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1057"><a href="#cb55-1057" aria-hidden="true" tabindex="-1"></a>The other situation that is not shown in @fig-corp is that the correlation coefficient can be positive and a line would be a reasonable fit although the scatter diagram indicates that both $Y$ and $X$ have skewed distributions suggesting that transformations should be applied.</span>
<span id="cb55-1058"><a href="#cb55-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1059"><a href="#cb55-1059" aria-hidden="true" tabindex="-1"></a><span class="al">![Sign of the correlation coefficient](images/corpat.png)</span>{#fig-corpat}</span>
<span id="cb55-1060"><a href="#cb55-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1061"><a href="#cb55-1061" aria-hidden="true" tabindex="-1"></a>To see why the sign of $r$ indicates the direction of the relationship, consider @fig-corpat.</span>
<span id="cb55-1062"><a href="#cb55-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1063"><a href="#cb55-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Regardless of which quadrant the point is in, the contribution to $S_{xx}$ and $S_{yy}$ is positive, as these are sums of squares.</span>
<span id="cb55-1064"><a href="#cb55-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1065"><a href="#cb55-1065" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>In the first quadrant the contribution of each point to the cross product $S_{xy}$ is $(+) \times (+)$, that is a positive amount. In the third quadrant, each contribution is $(-)\times (-)$, that is a positive amount. This is the reason that the correlation coefficient is positive if most points are in the first and third quadrants.</span>
<span id="cb55-1066"><a href="#cb55-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1067"><a href="#cb55-1067" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Points in the second and fourth quadrant contribute negative amounts, $(-)\times (+)$ or $(+)\times (-)$, to the cross product $S_{xy}$. If there are a considerable number of points in quadrants 2 and 4, the correlation coefficient will tend to be negative.</span>
<span id="cb55-1068"><a href="#cb55-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1069"><a href="#cb55-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlation matrices</span></span>
<span id="cb55-1070"><a href="#cb55-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1071"><a href="#cb55-1071" aria-hidden="true" tabindex="-1"></a>When there are more than two variables of interest, it is possible to draw scatterplots of each pair of variables but this becomes a bewildering exercise as the number of variables increases. One way to keep track of these plots is to set them out in a scatterplot matrix as in @fig-matplt2 which is based on the <span class="in">`pinetree`</span> data set, which  contains the circumference measurements of pine trees at four positions (<span class="in">`Top`</span>, <span class="in">`Third`</span>, <span class="in">`Second`</span> and <span class="in">`First`</span>) and in three areas of a forest. This plot also shows the simple correlation coefficients on the upper diagonal and smoothed density plots on the main diagonal of the matrix. This plot clearly shows that the variables are strongly related to each other. In particular, the Top circumference can be predicted reasonably well based on the bottom circumference. Even though the correlations are high, a quadratic model may fit better. @fig-matplt2 seems to show a non-random pattern in the way points appear on the plot. This may be due to the Area effect because the circumference data were collected from three different areas. @fig-matplt2 confirms that this is indeed the case.</span>
<span id="cb55-1072"><a href="#cb55-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1075"><a href="#cb55-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1076"><a href="#cb55-1076" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>( <span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"pinetree.RData"</span>) ) {</span>
<span id="cb55-1077"><a href="#cb55-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1078"><a href="#cb55-1078" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(</span>
<span id="cb55-1079"><a href="#cb55-1079" aria-hidden="true" tabindex="-1"></a>    <span class="at">url =</span> <span class="st">"http://www.massey.ac.nz/~anhsmith/data/pinetree.RData"</span>, </span>
<span id="cb55-1080"><a href="#cb55-1080" aria-hidden="true" tabindex="-1"></a>    <span class="at">destfile =</span> <span class="st">"pinetree.RData"</span>)</span>
<span id="cb55-1081"><a href="#cb55-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1082"><a href="#cb55-1082" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-1083"><a href="#cb55-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1084"><a href="#cb55-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1085"><a href="#cb55-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1088"><a href="#cb55-1088" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1089"><a href="#cb55-1089" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"pinetree.RData"</span>)</span>
<span id="cb55-1090"><a href="#cb55-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1091"><a href="#cb55-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1092"><a href="#cb55-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1095"><a href="#cb55-1095" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1096"><a href="#cb55-1096" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1097"><a href="#cb55-1097" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1098"><a href="#cb55-1098" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-matplt2</span></span>
<span id="cb55-1099"><a href="#cb55-1099" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Four quadrants of a scatter plot'</span></span>
<span id="cb55-1100"><a href="#cb55-1100" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb55-1101"><a href="#cb55-1101" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb55-1102"><a href="#cb55-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1103"><a href="#cb55-1103" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb55-1104"><a href="#cb55-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1105"><a href="#cb55-1105" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(pinetree, <span class="at">columns =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb55-1106"><a href="#cb55-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1107"><a href="#cb55-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1108"><a href="#cb55-1108" aria-hidden="true" tabindex="-1"></a>It is also possible to use the colour option as well as the subgroup-wise correlation coefficients. Try</span>
<span id="cb55-1109"><a href="#cb55-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1110"><a href="#cb55-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1111"><a href="#cb55-1111" aria-hidden="true" tabindex="-1"></a><span class="in">ggpairs(</span></span>
<span id="cb55-1112"><a href="#cb55-1112" aria-hidden="true" tabindex="-1"></a><span class="in">  pinetree, </span></span>
<span id="cb55-1113"><a href="#cb55-1113" aria-hidden="true" tabindex="-1"></a><span class="in">  columns = 2:5,</span></span>
<span id="cb55-1114"><a href="#cb55-1114" aria-hidden="true" tabindex="-1"></a><span class="in">  mapping = aes(colour = Area)</span></span>
<span id="cb55-1115"><a href="#cb55-1115" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb55-1116"><a href="#cb55-1116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1117"><a href="#cb55-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1118"><a href="#cb55-1118" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bivariate distributions</span></span>
<span id="cb55-1119"><a href="#cb55-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1120"><a href="#cb55-1120" aria-hidden="true" tabindex="-1"></a>The two-dimensional or the **bivariate probability distribution** of $X$ and $Y$ can be displayed as a 2-d smoothed density plot or as a probability contour plot. @fig-matplt3 shows such plots. This figure rather suggests that there may be two separate joint probability distributions of Maths and English scores. This clue is not obtained in the scatter plot of English score against Maths score but only from the other three plots.</span>
<span id="cb55-1121"><a href="#cb55-1121" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-1122"><a href="#cb55-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1125"><a href="#cb55-1125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1126"><a href="#cb55-1126" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1127"><a href="#cb55-1127" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-matplt3</span></span>
<span id="cb55-1128"><a href="#cb55-1128" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'Exploring bivariate distributions'</span></span>
<span id="cb55-1129"><a href="#cb55-1129" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb55-1130"><a href="#cb55-1130" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb55-1131"><a href="#cb55-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1132"><a href="#cb55-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1133"><a href="#cb55-1133" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> testmarks<span class="sc">$</span>English</span>
<span id="cb55-1134"><a href="#cb55-1134" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> testmarks<span class="sc">$</span>Maths</span>
<span id="cb55-1135"><a href="#cb55-1135" aria-hidden="true" tabindex="-1"></a>def.par <span class="ot">=</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb55-1136"><a href="#cb55-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1137"><a href="#cb55-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),</span>
<span id="cb55-1138"><a href="#cb55-1138" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Maths Marks"</span>,</span>
<span id="cb55-1139"><a href="#cb55-1139" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"English Marks"</span>,</span>
<span id="cb55-1140"><a href="#cb55-1140" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Scatter plot of English Scores vs Maths Scores"</span>)</span>
<span id="cb55-1141"><a href="#cb55-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1142"><a href="#cb55-1142" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="fu">kde2d</span>(x, y, <span class="at">n =</span> <span class="dv">50</span>, <span class="at">lims =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">100</span>))</span>
<span id="cb55-1143"><a href="#cb55-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1144"><a href="#cb55-1144" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(f1,</span>
<span id="cb55-1145"><a href="#cb55-1145" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">"Maths Marks"</span>,</span>
<span id="cb55-1146"><a href="#cb55-1146" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">"English Marks"</span>,</span>
<span id="cb55-1147"><a href="#cb55-1147" aria-hidden="true" tabindex="-1"></a>      <span class="at">col=</span><span class="fu">gray</span>((<span class="dv">0</span><span class="sc">:</span><span class="dv">32</span>)<span class="sc">/</span><span class="dv">32</span>), <span class="at">main =</span> <span class="st">"Image Plot"</span>)</span>
<span id="cb55-1148"><a href="#cb55-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1149"><a href="#cb55-1149" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(f1, </span>
<span id="cb55-1150"><a href="#cb55-1150" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Maths Marks"</span>,</span>
<span id="cb55-1151"><a href="#cb55-1151" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"English Marks"</span>,</span>
<span id="cb55-1152"><a href="#cb55-1152" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Density contourPlot"</span>)</span>
<span id="cb55-1153"><a href="#cb55-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1154"><a href="#cb55-1154" aria-hidden="true" tabindex="-1"></a>op <span class="ot">=</span> <span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>)<span class="sc">+</span>.<span class="dv">1</span>)</span>
<span id="cb55-1155"><a href="#cb55-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1156"><a href="#cb55-1156" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(f1, <span class="at">phi =</span> <span class="dv">45</span>, <span class="at">theta =</span> <span class="dv">30</span>,</span>
<span id="cb55-1157"><a href="#cb55-1157" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">"Maths Marks"</span>, <span class="at">ylab =</span> <span class="st">"English Marks"</span>, <span class="at">zlab =</span> <span class="st">"density"</span>,</span>
<span id="cb55-1158"><a href="#cb55-1158" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">shade =</span> .<span class="dv">5</span>, <span class="at">border =</span> <span class="cn">NA</span>,</span>
<span id="cb55-1159"><a href="#cb55-1159" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Perspective plot (density estimation)"</span>)</span>
<span id="cb55-1160"><a href="#cb55-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1161"><a href="#cb55-1161" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op)</span>
<span id="cb55-1162"><a href="#cb55-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1163"><a href="#cb55-1163" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(def.par)</span>
<span id="cb55-1164"><a href="#cb55-1164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1165"><a href="#cb55-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1166"><a href="#cb55-1166" aria-hidden="true" tabindex="-1"></a>In summary, scatterplots may reveal many properties and peculiarities about the relationship of $Y$ to $X$, namely</span>
<span id="cb55-1167"><a href="#cb55-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1168"><a href="#cb55-1168" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Trends**: the overall trend may be positive or negative. It may be appropriate to fit a straight line or a curve.</span>
<span id="cb55-1169"><a href="#cb55-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1170"><a href="#cb55-1170" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Outliers**: points which appear to be unusual, or outliers, may be evident. In a scatterplot, the outlier need not be in the extreme scale of both $X$ and $Y$, and anything appearing peculiar or as a rogue point must be investigated.</span>
<span id="cb55-1171"><a href="#cb55-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1172"><a href="#cb55-1172" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Gaps** may be seen in the data which may indicate that different groups are present. On the other hand, if it is known that points belong to different groups, the points can be tagged with different symbols. The basic idea is to see whether different groups follow the same pattern or different patterns.</span>
<span id="cb55-1173"><a href="#cb55-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1174"><a href="#cb55-1174" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Variability** of $Y$ change with $X$, or may be fairly constant. **Clustering** of points with smaller variability when compared to rest of the points may also be revealed in some scatterplots.</span>
<span id="cb55-1175"><a href="#cb55-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1176"><a href="#cb55-1176" aria-hidden="true" tabindex="-1"></a>Both joint and marginal distributions of $X$ and $Y$ are important. We also consider the distribution of each variable separately, and explore whether they have symmetric distributions or not.</span>
<span id="cb55-1177"><a href="#cb55-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1178"><a href="#cb55-1178" aria-hidden="true" tabindex="-1"></a><span class="fu">## Higher dimensional data</span></span>
<span id="cb55-1179"><a href="#cb55-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1180"><a href="#cb55-1180" aria-hidden="true" tabindex="-1"></a>A short-cut to explore three numerical variables is to obtain a contour plot. In @fig-matplt3, the contours were the joint density of Maths and English marks. Instead, we can just use three numerical variables and show the third variable (Z) as a contour on a scatter plot of Y vs. X. What this means is that several combinations of X and Y can lead to the same Z. So we have to use some smoothing method or a model to obtain the contours and form a grid. The <span class="in">`R`</span> package *plotly* is rather simple and powerful to obtain dynamic or interactive plots. The plots produced with this package are colour optimised for viewing and hence they may not be the best for printing but good for EDA purposes. We can also hover over the graph and view the graphed data. After loading the pine tree data, try-</span>
<span id="cb55-1181"><a href="#cb55-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1184"><a href="#cb55-1184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1185"><a href="#cb55-1185" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1186"><a href="#cb55-1186" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb55-1187"><a href="#cb55-1187" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">type =</span> <span class="st">'contour'</span>, </span>
<span id="cb55-1188"><a href="#cb55-1188" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span>pinetree<span class="sc">$</span>First, </span>
<span id="cb55-1189"><a href="#cb55-1189" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span>pinetree<span class="sc">$</span>Second, </span>
<span id="cb55-1190"><a href="#cb55-1190" aria-hidden="true" tabindex="-1"></a>        <span class="at">z=</span>pinetree<span class="sc">$</span>Top)</span>
<span id="cb55-1191"><a href="#cb55-1191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1192"><a href="#cb55-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1193"><a href="#cb55-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1194"><a href="#cb55-1194" aria-hidden="true" tabindex="-1"></a>A bubble plot is a way to plot three variables on a two-dimensional scatter plot, where a third variable gives the size of the points (or 'bubbles'). This type of plot can be restrictive for some datasets depending on the variability involved in the third variable. @fig-bubble shows the location of the house pits and total Area. This plot not only gives the spatial view of the tribal area but indirectly reveals the clustering of house sizes.</span>
<span id="cb55-1195"><a href="#cb55-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1198"><a href="#cb55-1198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1199"><a href="#cb55-1199" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-bubble</span></span>
<span id="cb55-1200"><a href="#cb55-1200" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'A bubble plot for the Snodgrass data'</span></span>
<span id="cb55-1201"><a href="#cb55-1201" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Snodgrass) <span class="sc">+</span> </span>
<span id="cb55-1202"><a href="#cb55-1202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>East, <span class="at">y=</span>South, <span class="at">colour=</span>Area, <span class="at">size=</span>Area) <span class="sc">+</span> </span>
<span id="cb55-1203"><a href="#cb55-1203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb55-1204"><a href="#cb55-1204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1205"><a href="#cb55-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1206"><a href="#cb55-1206" aria-hidden="true" tabindex="-1"></a>Using the appropriate software, it is possible to explore three variables using a 3-D scatter plot. We explore the pinetree data in @fig-3d which clearly shows the strong relationships and the Area effect. The other forms of exploring 3 variables include 3-D surface plots.</span>
<span id="cb55-1207"><a href="#cb55-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1210"><a href="#cb55-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1211"><a href="#cb55-1211" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-3d</span></span>
<span id="cb55-1212"><a href="#cb55-1212" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'A 3-D plot'</span></span>
<span id="cb55-1213"><a href="#cb55-1213" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb55-1214"><a href="#cb55-1214" aria-hidden="true" tabindex="-1"></a><span class="fu">cloud</span>(Top <span class="sc">~</span> First<span class="sc">+</span>Second, <span class="at">group=</span>Area, <span class="at">data=</span>pinetree)</span>
<span id="cb55-1215"><a href="#cb55-1215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1216"><a href="#cb55-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1217"><a href="#cb55-1217" aria-hidden="true" tabindex="-1"></a><span class="in">`plotly`</span> is great for interactive 3d plots (though they only work with HTML, not PDF).</span>
<span id="cb55-1218"><a href="#cb55-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1221"><a href="#cb55-1221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1222"><a href="#cb55-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(Snodgrass, <span class="at">x =</span> <span class="sc">~</span>East, <span class="at">y =</span> <span class="sc">~</span>South, <span class="at">z =</span> <span class="sc">~</span>Area) <span class="sc">|&gt;</span> </span>
<span id="cb55-1223"><a href="#cb55-1223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>()</span>
<span id="cb55-1224"><a href="#cb55-1224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1225"><a href="#cb55-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1226"><a href="#cb55-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1227"><a href="#cb55-1227" aria-hidden="true" tabindex="-1"></a>If we wish to examine the relationships between (three or more) variables we could do so with a conditioning plot, otherwise known as a **coplot**. A coplot is a scatterplot matrix where each panel in the matrix is a scatterplot of the same two variables, whose observations are restricted by the values of a third (and possibly a fourth) variable.</span>
<span id="cb55-1228"><a href="#cb55-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1229"><a href="#cb55-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1232"><a href="#cb55-1232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1233"><a href="#cb55-1233" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-coplt</span></span>
<span id="cb55-1234"><a href="#cb55-1234" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: 'A co-plot'</span></span>
<span id="cb55-1235"><a href="#cb55-1235" aria-hidden="true" tabindex="-1"></a><span class="fu">coplot</span>(Top<span class="sc">~</span> First <span class="sc">|</span> Second<span class="sc">*</span>Area, <span class="at">data =</span> pinetree)</span>
<span id="cb55-1236"><a href="#cb55-1236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1237"><a href="#cb55-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1238"><a href="#cb55-1238" aria-hidden="true" tabindex="-1"></a>The coplot in @fig-coplt shows that pine trees are not maturing well in Area 3, given that fewer points are on the right hand side of the graph when compared to Areas 1 and 2.</span>
<span id="cb55-1239"><a href="#cb55-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1240"><a href="#cb55-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1241"><a href="#cb55-1241" aria-hidden="true" tabindex="-1"></a><span class="fu"># Summary</span></span>
<span id="cb55-1242"><a href="#cb55-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1243"><a href="#cb55-1243" aria-hidden="true" tabindex="-1"></a>The first step in EDA is to familiarise oneself with the data. The dataset should be checked for errors. This is particularly important if this is to be the first time the data will be analysed. It is essential to know story behind the data such as the objectives for the collection of the data, and in what way was it collected etc. The answers to these questions should provide the focus for our own analysis of the data; i.e. what questions do we want to be able answer by our analysis of the data. Note that data may not always contain an answer to the questions we may have.</span>
<span id="cb55-1244"><a href="#cb55-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1245"><a href="#cb55-1245" aria-hidden="true" tabindex="-1"></a>Our exploratory analysis now proceeds by attempting to understand the structure and peculiarities of the dataset. In particular, we may be interested in: numerical summaries or tabular display that present an overall summary of the data; graphical displays that describe the distribution of variables; graphical comparisons of different groups in the data; scatterplots or scatterplot matrices that reveal trends or relationships and other patterns between variables; and any interesting or outlying points in the data. The main thing in choosing graphics is that they should be simple and informative -not saying too much or too little, and not misleading. You should be able to say something meaningful on the basis of each graph.</span>
<span id="cb55-1246"><a href="#cb55-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1247"><a href="#cb55-1247" aria-hidden="true" tabindex="-1"></a>Based on the EDA evidence, one or more candidate statistical models are fitted. These models are further improved or validated. After the analysis is complete, we need to be able to communicate our findings, clearly, accurately, effectively, and honestly, to any interested audience.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>